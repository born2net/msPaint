function touchHandler(a){var f=a.changedTouches,e=f[0],b="";switch(a.type){case "touchstart":b="mousedown";break;case "touchmove":b="mousemove";break;case "touchend":b="mouseup";break;default:return}var g=document.createEvent("MouseEvent");g.initMouseEvent(b,true,true,window,1,e.screenX,e.screenY,e.clientX,e.clientY,false,false,false,false,0,null);if(f.length<2){e.target.dispatchEvent(g);a.preventDefault()}};(function(a){function f(e){if(typeof e.data==="string"){var b=e.handler,g=e.data.toLowerCase().split(" ");e.handler=function(d){if(!(this!==d.target&&(/textarea|select/i.test(d.target.nodeName)||d.target.type==="text"))){var c=d.type!=="keypress"&&a.hotkeys.specialKeys[d.which],h=String.fromCharCode(d.which).toLowerCase(),k="",l={};if(d.altKey&&c!=="alt")k+="alt+";if(d.ctrlKey&&c!=="ctrl")k+="ctrl+";if(d.metaKey&&!d.ctrlKey&&c!=="meta")k+="meta+";if(d.shiftKey&&c!=="shift")k+="shift+";if(c)l[k+c]=
true;else{l[k+h]=true;l[k+a.hotkeys.shiftNums[h]]=true;if(k==="shift+")l[a.hotkeys.shiftNums[h]]=true}c=0;for(h=g.length;c<h;c++)if(l[g[c]])return b.apply(this,arguments)}}}}a.hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",
106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",191:"/",224:"meta",219:"[",221:"]"},shiftNums:{"`":"~","1":"!","2":"@","3":"#","4":"$","5":"%","6":"^","7":"&","8":"*","9":"(","0":")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"}};a.each(["keydown","keyup","keypress"],function(){a.event.special[this]={add:f}})})(jQuery);(function(a,f){function e(ea){return typeof ea==="string"}function b(ea){var U=k.call(arguments,1);return function(){return ea.apply(this,U.concat(k.call(arguments)))}}function g(ea,U,Y,oa,pa){var na;if(oa!==h){U=Y.match(ea?/^([^#]*)\#?(.*)$/:/^([^#?]*)\??([^#]*)(#?.*)/);Y=U[3]||"";if(pa===2&&e(oa))oa=oa.replace(ea?aa:T,"");else{na=m(U[2]);oa=e(oa)?m[ea?ba:N](oa):oa;oa=pa===2?oa:pa===1?a.extend({},oa,na):a.extend({},na,oa);oa=o(oa);if(ea)oa=oa.replace(sa,l)}ea=U[1]+(ea?"#":oa||!U[1]?"?":"")+oa+Y}else ea=
U(Y!==h?Y:f[ja][V]);return ea}function d(ea,U,Y){if(U===h||typeof U==="boolean"){Y=U;U=o[ea?ba:N]()}else U=e(U)?U.replace(ea?aa:T,""):U;return m(U,Y)}function c(ea,U,Y,oa){if(!e(Y)&&typeof Y!=="object"){oa=Y;Y=U;U=h}return this.each(function(){var pa=a(this),na=U||P()[(this.nodeName||"").toLowerCase()]||"",ia=na&&pa.attr(na)||"";pa.attr(na,o[ea](ia,Y,oa))})}var h,k=Array.prototype.slice,l=decodeURIComponent,o=a.param,n,m,C,I=a.bbq=a.bbq||{},H,G,P,Q=a.event.special,N="querystring",ba="fragment",ja=
"location",V="href",T=/^.*\?|#.*$/g,aa=/^.*\#/,sa,ka={};o[N]=b(g,0,function(ea){return ea.replace(/(?:^[^?#]*\?([^#]*).*$)?.*/,"$1")});o[ba]=n=b(g,1,function(ea){return ea.replace(/^[^#]*#?(.*)$/,"$1")});n.noEscape=function(ea){ea=ea||"";ea=a.map(ea.split(""),encodeURIComponent);sa=RegExp(ea.join("|"),"g")};n.noEscape(",/");a.deparam=m=function(ea,U){var Y={},oa={"true":true,"false":false,"null":null};a.each(ea.replace(/\+/g," ").split("&"),function(pa,na){var ia=na.split("="),ta=l(ia[0]),wa=Y,ra=
0,Ha=ta.split("]["),Da=Ha.length-1;if(/\[/.test(Ha[0])&&/\]$/.test(Ha[Da])){Ha[Da]=Ha[Da].replace(/\]$/,"");Ha=Ha.shift().split("[").concat(Ha);Da=Ha.length-1}else Da=0;if(ia.length===2){ia=l(ia[1]);if(U)ia=ia&&!isNaN(ia)?+ia:ia==="undefined"?h:oa[ia]!==h?oa[ia]:ia;if(Da)for(;ra<=Da;ra++){ta=Ha[ra]===""?wa.length:Ha[ra];wa=wa[ta]=ra<Da?wa[ta]||(Ha[ra+1]&&isNaN(Ha[ra+1])?{}:[]):ia}else if(a.isArray(Y[ta]))Y[ta].push(ia);else Y[ta]=Y[ta]!==h?[Y[ta],ia]:ia}else if(ta)Y[ta]=U?h:""});return Y};m[N]=b(d,
0);m[ba]=C=b(d,1);a.elemUrlAttr||(a.elemUrlAttr=function(ea){return a.extend(ka,ea)})({a:V,base:V,iframe:"src",img:"src",input:"src",form:"action",link:V,script:"src"});P=a.elemUrlAttr;a.fn[N]=b(c,N);a.fn[ba]=b(c,ba);I.pushState=H=function(ea,U){if(e(ea)&&/^#/.test(ea)&&U===h)U=2;var Y=ea!==h;Y=n(f[ja][V],Y?ea:{},Y?U:2);f[ja][V]=Y+(/#/.test(Y)?"":"#")};I.getState=G=function(ea,U){return ea===h||typeof ea==="boolean"?C(ea):C(U)[ea]};I.removeState=function(ea){var U={};if(ea!==h){U=G();a.each(a.isArray(ea)?
ea:arguments,function(Y,oa){delete U[oa]})}H(U,2)};Q.hashchange=a.extend(Q.hashchange,{add:function(ea){function U(oa){var pa=oa[ba]=n();oa.getState=function(na,ia){return na===h||typeof na==="boolean"?m(pa,na):m(pa,ia)[na]};Y.apply(this,arguments)}var Y;if(a.isFunction(ea)){Y=ea;return U}else{Y=ea.handler;ea.handler=U}}})})(jQuery,this);
(function(a,f,e){function b(n){n=n||f[c][h];return n.replace(/^[^#]*#?(.*)$/,"$1")}var g,d=a.event.special,c="location",h="href",k=document.documentMode,l=a.browser.msie&&(k===e||k<8),o="onhashchange"in f&&!l;a.hashchangeDelay=100;d.hashchange=a.extend(d.hashchange,{setup:function(){if(o)return false;a(g.start)},teardown:function(){if(o)return false;a(g.stop)}});g=function(){function n(){H=G=function(P){return P};if(l){I=a('<iframe src="javascript:0"/>').hide().insertAfter("body")[0].contentWindow;
G=function(){return b(I.document[c][h])};H=function(P,Q){if(P!==Q){var N=I.document;N.open().close();N[c].hash="#"+P}};H(b())}}var m={},C,I,H,G;m.start=function(){if(!C){var P=b();H||n();(function Q(){var N=b(),ba=G(P);if(N!==P){H(P=N,ba);a(f).trigger("hashchange")}else if(ba!==P)f[c][h]=f[c][h].replace(/#.*/,"")+"#"+ba;C=setTimeout(Q,a.hashchangeDelay)})()}};m.stop=function(){if(!I){C&&clearTimeout(C);C=0}};return m}()})(jQuery,this);(function(a){var f={},e;a.svgIcons=function(b,g){function d(ea,U){if(ea!=="ajax"){if(P)return;var Y=(I=V[0].contentDocument)&&I.getElementById("svg_eof");if(!Y&&!(U&&Y)){Q++;if(Q<50)setTimeout(d,20);else{h();P=true}return}P=true}C=a(I.firstChild).children();if(g.no_img)setTimeout(function(){G||c()},500);else{Y=ja+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNzUiIGhlaWdodD0iMjc1Ij48L3N2Zz4%3D";H=a(new Image).attr({src:Y,width:0,height:0}).appendTo("body").load(function(){c(true)}).error(function(){c()})}}
function c(ea,U){if(!G){if(g.no_img)ea=false;if(ea){var Y=a(document.createElement("div"));Y.hide().appendTo("body")}if(U){var oa=g.fallback_path?g.fallback_path:"";a.each(U,function(Da,Ka){a("#"+Da);var Aa=a(new Image).attr({"class":"svg_icon",src:oa+Ka,width:n,height:m,alt:"icon"});ka(Aa,Da)})}else for(var pa=C.length,na=0;na<pa;na++){var ia=C[na],ta=ia.id;if(ta==="svg_eof")break;a("#"+ta);ia=ia.getElementsByTagNameNS(l,"svg")[0];var wa=document.createElementNS(l,"svg");wa.setAttributeNS(l,"viewBox",
[0,0,n,m].join(" "));var ra=ia.getAttribute("width"),Ha=ia.getAttribute("height");ia.removeAttribute("width");ia.removeAttribute("height");ia.getAttribute("viewBox")||ia.setAttribute("viewBox",[0,0,ra,Ha].join(" "));wa.setAttribute("xmlns",l);wa.setAttribute("width",n);wa.setAttribute("height",m);wa.setAttribute("xmlns:xlink",o);wa.setAttribute("class","svg_icon");ba||(ia=ia.cloneNode(true));wa.appendChild(ia);if(ea){ba||wa.cloneNode(true);Y.empty().append(wa);ia=ja+k(Y.html());ia=a(new Image).attr({"class":"svg_icon",
src:ia})}else ia=e(a(wa),na);ka(ia,ta)}g.placement&&a.each(g.placement,function(Da,Ka){f[Ka]&&a(Da).each(function(Aa){var xa=f[Ka].clone();if(Aa>0&&!ea)xa=e(xa,Aa,true);sa(a(this),xa,Ka)})});if(!U){ea&&Y.remove();V&&V.remove();H&&H.remove()}g.resize&&a.resizeSvgIcons(g.resize);G=true;g.callback&&g.callback(f)}}function h(){if(b.indexOf(".svgz")!=-1){var ea=b.replace(".svgz",".svg");window.console&&console.log(".svgz failed, trying with .svg");a.svgIcons(ea,g)}else g.fallback&&c(false,g.fallback)}
function k(ea){if(window.btoa)return window.btoa(ea);var U=Array(Math.floor((ea.length+2)/3)*4),Y,oa,pa,na,ia,ta,wa=0,ra=0;do{Y=ea.charCodeAt(wa++);oa=ea.charCodeAt(wa++);pa=ea.charCodeAt(wa++);na=Y>>2;Y=(Y&3)<<4|oa>>4;ia=(oa&15)<<2|pa>>6;ta=pa&63;if(isNaN(oa))ia=ta=64;else if(isNaN(pa))ta=64;U[ra++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(na);U[ra++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(Y);U[ra++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(ia);
U[ra++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(ta)}while(wa<ea.length);return U.join("")}var l="http://www.w3.org/2000/svg",o="http://www.w3.org/1999/xlink",n=g.w?g.w:24,m=g.h?g.h:24,C,I,H,G=false,P=false,Q=0,N=navigator.userAgent,ba=!!window.opera;N.indexOf("Safari/")>-1&&N.indexOf("Chrome/");var ja="data:image/svg+xml;charset=utf-8;base64,";if(g.svgz){var V=a('<object data="'+b+'" type=image/svg+xml>').appendTo("body").hide();try{I=V[0].contentDocument;V.load(d);
d(0,true)}catch(T){h()}}else{var aa=new DOMParser;a.ajax({url:b,dataType:"string",success:function(ea){if(ea){I=aa.parseFromString(ea,"text/xml");a(function(){d("ajax")})}else a(h)},error:function(ea){if(window.opera)a(function(){h()});else if(ea.responseText){I=aa.parseFromString(ea.responseText,"text/xml");I.childNodes.length||a(h);a(function(){d("ajax")})}else a(h)}})}var sa=function(ea,U,Y,oa){ba&&U.css("visibility","hidden");if(g.replace){oa&&U.attr("id",Y);(Y=ea.attr("class"))&&U.attr("class",
"svg_icon "+Y);ea.replaceWith(U)}else ea.append(U);ba&&setTimeout(function(){U.removeAttr("style")},1)},ka=function(ea,U){if(g.id_match===undefined||g.id_match!==false)sa(holder,ea,U,true);f[U]=ea};e=function(ea,U){var Y=ea.find("defs");if(!Y.length)return ea;Y=ba?Y.find("*").filter(function(){return!!this.id}):Y.find("[id]");var oa=ea[0].getElementsByTagName("*"),pa=oa.length;Y.each(function(na){var ia=this.id;a(I).find("#"+ia);this.id=na="x"+ia+U+na;ia="url(#"+ia+")";var ta="url(#"+na+")";for(na=
0;na<pa;na++){var wa=oa[na];wa.getAttribute("fill")===ia&&wa.setAttribute("fill",ta);wa.getAttribute("stroke")===ia&&wa.setAttribute("stroke",ta);wa.getAttribute("filter")===ia&&wa.setAttribute("filter",ta)}});return ea}};a.getSvgIcon=function(b,g){var d=f[b];if(g&&d)d=e(d,0,true).clone(true);return d};a.resizeSvgIcons=function(b){var g=!a(".svg_icon:first").length;a.each(b,function(d,c){var h=a.isArray(c),k=h?c[0]:c,l=h?c[1]:c;if(g)d=d.replace(/\.svg_icon/g,"svg");a(d).each(function(){this.setAttribute("width",
k);this.setAttribute("height",l);if(window.opera&&window.widget){this.parentNode.style.width=k+"px";this.parentNode.style.height=l+"px"}})})}})(jQuery);(function(){function a(b,g,d){b=document.createElementNS(f.svg,b);if(e)for(var c in g)b.setAttribute(c,g[c]);else for(c in g){var h=g[c],k=b[c];if(k&&k.constructor==="SVGLength")k.baseVal.value=h;else b.setAttribute(c,h)}d&&d.appendChild(b);return b}var f={svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink"};if(!window.console)window.console=new function(){this.log=function(){};this.dir=function(){}};$.jGraduate={Paint:function(b){b=b||{};this.alpha=isNaN(b.alpha)?100:b.alpha;if(b.copy){this.type=
b.copy.type;this.alpha=b.copy.alpha;this.radialGradient=this.linearGradient=this.solidColor=null;switch(this.type){case "solidColor":this.solidColor=b.copy.solidColor;break;case "linearGradient":this.linearGradient=b.copy.linearGradient.cloneNode(true);break;case "radialGradient":this.radialGradient=b.copy.radialGradient.cloneNode(true)}}else if(b.linearGradient){this.type="linearGradient";this.radialGradient=this.solidColor=null;this.linearGradient=b.linearGradient.cloneNode(true)}else if(b.radialGradient){this.type=
"radialGradient";this.linearGradient=this.solidColor=null;this.radialGradient=b.radialGradient.cloneNode(true)}else if(b.solidColor){this.type="solidColor";this.solidColor=b.solidColor}else{this.type="none";this.radialGradient=this.linearGradient=this.solidColor=null}}};jQuery.fn.jGraduateDefaults={paint:new $.jGraduate.Paint,window:{pickerTitle:"Drag markers to pick a paint"},images:{clientPath:"images/"},newstop:"inverse"};var e=navigator.userAgent.indexOf("Gecko/")>=0;jQuery.fn.jGraduate=function(b){var g=
arguments;return this.each(function(){function d(la,ca,ma,O,S){var fa=S||a("stop",{"stop-color":ca,"stop-opacity":ma,offset:la},aa);if(S){ca=S.getAttribute("stop-color");ma=S.getAttribute("stop-opacity");la=S.getAttribute("offset")}else aa.appendChild(fa);if(ma===null)ma=1;S=a("path",{d:"M-6.2,0.9c3.6-4,6.7-4.3,6.7-12.4c-0.2,7.9,3.1,8.8,6.5,12.4c3.5,3.8,2.9,9.6,0,12.3c-3.1,2.8-10.4,2.7-13.2,0C-9.6,9.9-9.4,4.4-6.2,0.9z",fill:"url(#jGraduate_trans)",transform:"translate("+(10+la*ba)+", 26)"},kb);var Ga=
a("path",{d:"M-6.2,0.9c3.6-4,6.7-4.3,6.7-12.4c-0.2,7.9,3.1,8.8,6.5,12.4c3.5,3.8,2.9,9.6,0,12.3c-3.1,2.8-10.4,2.7-13.2,0C-9.6,9.9-9.4,4.4-6.2,0.9z",fill:ca,"fill-opacity":ma,transform:"translate("+(10+la*ba)+", 26)",stroke:"#000","stroke-width":1.5},kb);$(Ga).mousedown(function(Oa){c(this);Va=cb;P.mousemove(l).mouseup(h);ya=vb.offset();Oa.preventDefault();return false}).data("stop",fa).data("bg",S).dblclick(function(){$("div.jGraduate_LightBox").show();for(var Oa=this,Wa=+fa.getAttribute("stop-opacity")||
1,Za=fa.getAttribute("stop-color")||1,nb=(parseFloat(Wa)*255).toString(16);nb.length<2;)nb="0"+nb;ca=Za.substr(1)+nb;$("#"+m+"_jGraduate_stopPicker").css({left:100,bottom:15}).jPicker({window:{title:"Pick the start color and opacity for the gradient"},images:{clientPath:n.images.clientPath},color:{active:ca,alphaSupport:true}},function(Ra){Za=Ra.val("hex")?"#"+Ra.val("hex"):"none";Wa=Ra.val("a")!==null?Ra.val("a")/256:1;Oa.setAttribute("fill",Za);Oa.setAttribute("fill-opacity",Wa);fa.setAttribute("stop-color",
Za);fa.setAttribute("stop-opacity",Wa);$("div.jGraduate_LightBox").hide();$("#"+m+"_jGraduate_stopPicker").hide()},null,function(){$("div.jGraduate_LightBox").hide();$("#"+m+"_jGraduate_stopPicker").hide()})});$(aa).find("stop").each(function(){var Oa=$(this);if(+this.getAttribute("offset")>la){if(!ca){var Wa=this.getAttribute("stop-color"),Za=this.getAttribute("stop-opacity");fa.setAttribute("stop-color",Wa);Ga.setAttribute("fill",Wa);fa.setAttribute("stop-opacity",Za===null?1:Za);Ga.setAttribute("fill-opacity",
Za===null?1:Za)}Oa.before(fa);return false}});O&&c(Ga);return fa}function c(la){cb&&cb.setAttribute("stroke","#000");la.setAttribute("stroke","blue");cb=la;cb.parentNode.appendChild(cb)}function h(){P.unbind("mousemove",l);if(Ia.getAttribute("display")!=="none"){Ia.setAttribute("display","none");var la=$(cb),ca=la.data("stop");la=la.data("bg");$([cb,ca,la]).remove()}Va=null}function k(){var la=Sa?"rotate("+Sa+","+Ja+","+db+") ":"";$a===1&&La===1?aa.removeAttribute("gradientTransform"):aa.setAttribute("gradientTransform",
la+"translate("+-Ja*($a-1)+","+-db*(La-1)+") scale("+$a+","+La+")")}function l(la){var ca=la.pageX-ya.left;la=la.pageY-ya.top;ca=ca<10?10:ca>ba+10?ba+10:ca;var ma="translate("+ca+", 26)";if(la<-60||la>130){Ia.setAttribute("display","block");Ia.setAttribute("transform",ma)}else Ia.setAttribute("display","none");Va.setAttribute("transform",ma);$.data(Va,"bg").setAttribute("transform",ma);$.data(Va,"stop").setAttribute("offset",(ca-10)/ba);var O=0;$(aa).find("stop").each(function(){var S=this.getAttribute("offset"),
fa=$(this);if(S<O){fa.prev().before(fa);Ba=$(aa).find("stop")}O=S})}var o=$(this),n=$.extend(true,{},jQuery.fn.jGraduateDefaults,b),m=o.attr("id"),C="#"+o.attr("id")+" ";if(C){var I=function(){switch(o.paint.type){case "radialGradient":o.paint.linearGradient=null;break;case "linearGradient":o.paint.radialGradient=null;break;case "solidColor":o.paint.radialGradient=o.paint.linearGradient=null}$.isFunction(o.okCallback)&&o.okCallback(o.paint);o.hide()},H=function(){$.isFunction(o.cancelCallback)&&o.cancelCallback();
o.hide()};$.extend(true,o,{paint:new $.jGraduate.Paint({copy:n.paint}),okCallback:$.isFunction(g[1])&&g[1]||null,cancelCallback:$.isFunction(g[2])&&g[2]||null});o.position();var G=null,P=$(window);if(o.paint.type=="none")o.paint=$.jGraduate.Paint({solidColor:"ffffff"});o.addClass("jGraduate_Picker");o.html('<ul class="jGraduate_tabs"><li class="jGraduate_tab_color jGraduate_tab_current" data-type="col">Solid Color</li><li class="jGraduate_tab_lingrad" data-type="lg">Linear Gradient</li><li class="jGraduate_tab_radgrad" data-type="rg">Radial Gradient</li></ul><div class="jGraduate_colPick"></div><div class="jGraduate_gradPick"></div><div class="jGraduate_LightBox"></div><div id="'+
m+'_jGraduate_stopPicker" class="jGraduate_stopPicker"></div>');var Q=$(C+"> .jGraduate_colPick"),N=$(C+"> .jGraduate_gradPick");N.html('<div id="'+m+'_jGraduate_Swatch" class="jGraduate_Swatch"><h2 class="jGraduate_Title">'+n.window.pickerTitle+'</h2><div id="'+m+'_jGraduate_GradContainer" class="jGraduate_GradContainer"></div><div id="'+m+'_jGraduate_StopSlider" class="jGraduate_StopSlider"></div></div><div class="jGraduate_Form jGraduate_Points jGraduate_lg_field"><div class="jGraduate_StopSection"><label class="jGraduate_Form_Heading">Begin Point</label><div class="jGraduate_Form_Section"><label>x:</label><input type="text" id="'+
m+'_jGraduate_x1" size="3" title="Enter starting x value between 0.0 and 1.0"/><label> y:</label><input type="text" id="'+m+'_jGraduate_y1" size="3" title="Enter starting y value between 0.0 and 1.0"/></div></div><div class="jGraduate_StopSection"><label class="jGraduate_Form_Heading">End Point</label><div class="jGraduate_Form_Section"><label>x:</label><input type="text" id="'+m+'_jGraduate_x2" size="3" title="Enter ending x value between 0.0 and 1.0"/><label> y:</label><input type="text" id="'+
m+'_jGraduate_y2" size="3" title="Enter ending y value between 0.0 and 1.0"/></div></div></div><div class="jGraduate_Form jGraduate_Points jGraduate_rg_field"><div class="jGraduate_StopSection"><label class="jGraduate_Form_Heading">Center Point</label><div class="jGraduate_Form_Section"><label>x:</label><input type="text" id="'+m+'_jGraduate_cx" size="3" title="Enter x value between 0.0 and 1.0"/><label> y:</label><input type="text" id="'+m+'_jGraduate_cy" size="3" title="Enter y value between 0.0 and 1.0"/></div></div><div class="jGraduate_StopSection"><label class="jGraduate_Form_Heading">Focal Point</label><div class="jGraduate_Form_Section"><label>Match center: <input type="checkbox" checked="checked" id="'+
m+'_jGraduate_match_ctr"/></label><br/><label>x:</label><input type="text" id="'+m+'_jGraduate_fx" size="3" title="Enter x value between 0.0 and 1.0"/><label> y:</label><input type="text" id="'+m+'_jGraduate_fy" size="3" title="Enter y value between 0.0 and 1.0"/></div></div></div><div class="jGraduate_StopSection jGraduate_SpreadMethod"><label class="jGraduate_Form_Heading">Spread method</label><div class="jGraduate_Form_Section"><select class="jGraduate_spreadMethod"><option value=pad selected>Pad</option><option value=reflect>Reflect</option><option value=repeat>Repeat</option></select></div></div><div class="jGraduate_Form"><div class="jGraduate_Slider jGraduate_RadiusField jGraduate_rg_field"><label class="prelabel">Radius:</label><div id="'+
m+'_jGraduate_Radius" class="jGraduate_SliderBar jGraduate_Radius" title="Click to set radius"><img id="'+m+'_jGraduate_RadiusArrows" class="jGraduate_RadiusArrows" src="'+n.images.clientPath+'rangearrows2.gif"></div><label><input type="text" id="'+m+'_jGraduate_RadiusInput" size="3" value="100"/>%</label></div><div class="jGraduate_Slider jGraduate_EllipField jGraduate_rg_field"><label class="prelabel">Ellip:</label><div id="'+m+'_jGraduate_Ellip" class="jGraduate_SliderBar jGraduate_Ellip" title="Click to set Ellip"><img id="'+
m+'_jGraduate_EllipArrows" class="jGraduate_EllipArrows" src="'+n.images.clientPath+'rangearrows2.gif"></div><label><input type="text" id="'+m+'_jGraduate_EllipInput" size="3" value="0"/>%</label></div><div class="jGraduate_Slider jGraduate_AngleField jGraduate_rg_field"><label class="prelabel">Angle:</label><div id="'+m+'_jGraduate_Angle" class="jGraduate_SliderBar jGraduate_Angle" title="Click to set Angle"><img id="'+m+'_jGraduate_AngleArrows" class="jGraduate_AngleArrows" src="'+n.images.clientPath+
'rangearrows2.gif"></div><label><input type="text" id="'+m+'_jGraduate_AngleInput" size="3" value="0"/>\u00ba&nbsp;</label></div><div class="jGraduate_Slider jGraduate_OpacField"><label class="prelabel">Opac:</label><div id="'+m+'_jGraduate_Opac" class="jGraduate_SliderBar jGraduate_Opac" title="Click to set Opac"><img id="'+m+'_jGraduate_OpacArrows" class="jGraduate_OpacArrows" src="'+n.images.clientPath+'rangearrows2.gif"></div><label><input type="text" id="'+m+'_jGraduate_OpacInput" size="3" value="100"/>%</label></div></div><div class="jGraduate_OkCancel"><input type="button" id="'+
m+'_jGraduate_Ok" class="jGraduate_Ok" value="OK"/><input type="button" id="'+m+'_jGraduate_Cancel" class="jGraduate_Cancel" value="Cancel"/></div>');var ba=256,ja=ba-0,V=ba-0,T,aa,sa,ka={};$(".jGraduate_SliderBar").width(145);var ea=$("#"+m+"_jGraduate_GradContainer")[0],U=a("svg",{id:m+"_jgraduate_svg",width:ba,height:ba,xmlns:f.svg},ea);T=T||o.paint.type;var Y=aa=o.paint[T],oa=o.paint.alpha,pa=T==="solidColor";switch(T){case "solidColor":case "linearGradient":if(!pa){aa.id=m+"_lg_jgraduate_grad";
Y=aa=U.appendChild(aa)}a("radialGradient",{id:m+"_rg_jgraduate_grad"},U);if(T==="linearGradient")break;case "radialGradient":if(!pa){aa.id=m+"_rg_jgraduate_grad";Y=aa=U.appendChild(aa)}a("linearGradient",{id:m+"_lg_jgraduate_grad"},U)}if(pa){Y=aa=$("#"+m+"_lg_jgraduate_grad")[0];G=o.paint[T];d(0,"#"+G,1);var na=typeof n.newstop;if(na==="string")switch(n.newstop){case "same":d(1,"#"+G,1);break;case "inverse":na="";for(var ia=0;ia<6;ia+=2){G.substr(ia,2);var ta=(255-parseInt(G.substr(ia,2),16)).toString(16);
if(ta.length<2)ta=0+ta;na+=ta}d(1,"#"+na,1);break;case "white":d(1,"#ffffff",1);break;case "black":d(1,"#000000",1)}else if(na==="object")d(1,n.newstop.color||"#"+G,"opac"in n.newstop?n.newstop.opac:1)}G=parseFloat(Y.getAttribute("x1")||0);na=parseFloat(Y.getAttribute("y1")||0);ia=parseFloat(Y.getAttribute("x2")||1);ta=parseFloat(Y.getAttribute("y2")||0);var wa=parseFloat(Y.getAttribute("cx")||0.5),ra=parseFloat(Y.getAttribute("cy")||0.5),Ha=parseFloat(Y.getAttribute("fx")||wa),Da=parseFloat(Y.getAttribute("fy")||
ra);sa=a("rect",{id:m+"_jgraduate_rect",x:0,y:0,width:ja,height:V,fill:"url(#"+m+"_jgraduate_grad)","fill-opacity":oa/100},U);var Ka=$("<div/>").attr({"class":"grad_coord jGraduate_lg_field",title:"Begin Stop"}).text(1).css({top:na*ba,left:G*ba}).data("coord","start").appendTo(ea),Aa=Ka.clone().text(2).css({top:ta*ba,left:ia*ba}).attr("title","End stop").data("coord","end").appendTo(ea),xa=$("<div/>").attr({"class":"grad_coord jGraduate_rg_field",title:"Center stop"}).text("C").css({top:ra*ba,left:wa*
ba}).data("coord","center").appendTo(ea),ua=xa.clone().text("F").css({top:Da*ba,left:Ha*ba,display:"none"}).attr("title","Focus point").data("coord","focus").appendTo(ea);ua[0].id=m+"_jGraduate_focusCoord";$(C+" .grad_coord");$.each(["x1","y1","x2","y2","cx","cy","fx","fy"],function(la,ca){var ma=aa.getAttribute(ca),O=isNaN(ca[1]);ma||(ma=O?"0.5":ca==="x2"?"1.0":"0.0");ka[ca]=$("#"+m+"_jGraduate_"+ca).val(ma).change(function(){if(isNaN(parseFloat(this.value))||this.value<0)this.value=0;else if(this.value>
1)this.value=1;if(!(ca[0]==="f"&&!eb))if(O&&T==="radialGradient"||!O&&T==="linearGradient")aa.setAttribute(ca,this.value);var S=O?ca[0]==="c"?xa:ua:ca[1]==="1"?Ka:Aa,fa=ca.indexOf("x")>=0?"left":"top";S.css(fa,this.value*ba)}).change()});var Ba,kb,vb=$("#"+m+"_jGraduate_StopSlider"),cb,Ta,Va,Ia=a("path",{d:"m9.75,-6l-19.5,19.5m0,-19.5l19.5,19.5",fill:"none",stroke:"#D00","stroke-width":5,display:"none"},Ta),ya,$a=1,La=1,Sa=0,Ja=wa,db=ra;Ta=a("svg",{width:"100%",height:45},vb[0]);ea=a("pattern",{width:16,
height:16,patternUnits:"userSpaceOnUse",id:"jGraduate_trans"},Ta);a("image",{width:16,height:16},ea).setAttributeNS(f.xlink,"xlink:href",n.images.clientPath+"map-opacity.png");$(Ta).on("click touchstart",function(la){ya=vb.offset();if(la.target.tagName!=="path"){var ca=la.pageX-ya.left-8;ca=ca<10?10:ca>ba+10?ba+10:ca;d(ca/ba,0,0,true);la.stopPropagation()}});$(Ta).mouseover(function(){Ta.appendChild(Ia)});kb=a("g",{},Ta);a("line",{x1:10,y1:15,x2:ba+10,y2:15,"stroke-width":2,stroke:"#000"},Ta);var lb=
N.find(".jGraduate_spreadMethod").change(function(){aa.setAttribute("spreadMethod",$(this).val())}),Ua=null,Xa=function(la){var ca=la.pageX-hb.left,ma=la.pageY-hb.top;ca=ca<0?0:ca>ba?ba:ca;ma=ma<0?0:ma>ba?ba:ma;Ua.css("left",ca).css("top",ma);ca=ca/ja;ma=ma/V;var O=Ua.data("coord"),S=aa;switch(O){case "start":ka.x1.val(ca);ka.y1.val(ma);S.setAttribute("x1",ca);S.setAttribute("y1",ma);break;case "end":ka.x2.val(ca);ka.y2.val(ma);S.setAttribute("x2",ca);S.setAttribute("y2",ma);break;case "center":ka.cx.val(ca);
ka.cy.val(ma);S.setAttribute("cx",ca);S.setAttribute("cy",ma);Ja=ca;db=ma;k();break;case "focus":ka.fx.val(ca);ka.fy.val(ma);S.setAttribute("fx",ca);S.setAttribute("fy",ma);k()}la.preventDefault()},wb=function(){Ua=null;P.unbind("mousemove",Xa).unbind("mouseup",wb)};Ba=aa.getElementsByTagNameNS(f.svg,"stop");if(va<2){for(;va<2;){aa.appendChild(document.createElementNS(f.svg,"stop"));++va}Ba=aa.getElementsByTagNameNS(f.svg,"stop")}var va=Ba.length;for(ia=0;ia<va;ia++)d(0,0,0,0,Ba[ia]);lb.val(aa.getAttribute("spreadMethod")||
"pad");var hb,eb=false;sa.setAttribute("fill-opacity",oa/100);$("#"+m+" div.grad_coord").mousedown(function(la){la.preventDefault();Ua=$(this);Ua.offset();hb=Ua.parent().offset();P.mousemove(Xa).mouseup(wb)});$("#"+m+"_jGraduate_Ok").bind("click touchstart",function(){o.paint.type=T;o.paint[T]=aa.cloneNode(true);o.paint.solidColor=null;I()});$("#"+m+"_jGraduate_Cancel").bind("click touchstart",function(){H()});if(T==="radialGradient")if(eb)ua.show();else{ua.hide();ka.fx.val("");ka.fy.val("")}$("#"+
m+"_jGraduate_match_ctr")[0].checked=!eb;var sb,ib;$("#"+m+"_jGraduate_match_ctr").change(function(){eb=!this.checked;ua.toggle(eb);ka.fx.val("");ka.fy.val("");var la=aa;if(eb){var ca=sb||0.5,ma=ib||0.5;la.setAttribute("fx",ca);la.setAttribute("fy",ma);ka.fx.val(ca);ka.fy.val(ma)}else{sb=la.getAttribute("fx");ib=la.getAttribute("fy");la.removeAttribute("fx");la.removeAttribute("fy")}});Ba=aa.getElementsByTagNameNS(f.svg,"stop");va=Ba.length;if(va<2){for(;va<2;){aa.appendChild(document.createElementNS(f.svg,
"stop"));++va}Ba=aa.getElementsByTagNameNS(f.svg,"stop")}var ab;oa=N=0;if(T==="radialGradient"){U=aa.gradientTransform.baseVal;if(U.numberOfItems===2){va=U.getItem(0);U=U.getItem(1);if(va.type===2&&U.type===3){va=U.matrix;if(va.a!==1)N=Math.round(-(1-va.a)*100);else if(va.d!==1)N=Math.round((1-va.d)*100)}}else if(U.numberOfItems===3){ea=U.getItem(0);va=U.getItem(1);U=U.getItem(2);if(ea.type===4&&va.type===2&&U.type===3){oa=Math.round(ea.angle);va=U.matrix;if(va.a!==1)N=Math.round(-(1-va.a)*100);else if(va.d!==
1)N=Math.round((1-va.d)*100)}}}N={radius:{handle:"#"+m+"_jGraduate_RadiusArrows",input:"#"+m+"_jGraduate_RadiusInput",val:(aa.getAttribute("r")||0.5)*100},opacity:{handle:"#"+m+"_jGraduate_OpacArrows",input:"#"+m+"_jGraduate_OpacInput",val:o.paint.alpha||100},ellip:{handle:"#"+m+"_jGraduate_EllipArrows",input:"#"+m+"_jGraduate_EllipInput",val:N},angle:{handle:"#"+m+"_jGraduate_AngleArrows",input:"#"+m+"_jGraduate_AngleInput",val:oa}};$.each(N,function(la,ca){var ma=$(ca.handle);ma.mousedown(function(O){var S=
ma.parent();ab={type:la,elem:ma,input:$(ca.input),parent:S,offset:S.offset()};P.mousemove(ob).mouseup(pb);O.preventDefault()});$(ca.input).val(ca.val).change(function(){var O=+this.value,S=0,fa=T==="radialGradient";switch(la){case "radius":fa&&aa.setAttribute("r",O/100);S=Math.pow(O/100,0.4)/2*145;break;case "opacity":o.paint.alpha=O;sa.setAttribute("fill-opacity",O/100);S=O*1.45;break;case "ellip":$a=La=1;if(O===0){S=72.5;break}if(O>99.5)O=99.5;if(O>0)La=1-O/100;else $a=-(O/100)-1;S=145*((O+100)/
2)/100;fa&&k();break;case "angle":Sa=O;S=Sa/180;S+=0.5;S*=145;fa&&k()}if(S>145)S=145;else if(S<0)S=0;ma.css({"margin-left":S-5})}).change()});var ob=function(la){var ca=la.pageX-ab.offset.left-parseInt(ab.parent.css("border-left-width"));if(ca>145)ca=145;if(ca<=0)ca=0;var ma=ca-5;ca/=145;switch(ab.type){case "radius":ca=Math.pow(ca*2,2.5);if(ca>0.98&&ca<1.02)ca=1;if(ca<=0.01)ca=0.01;aa.setAttribute("r",ca);break;case "opacity":o.paint.alpha=parseInt(ca*100);sa.setAttribute("fill-opacity",ca);break;
case "ellip":La=$a=1;if(ca<0.5){ca/=0.5;$a=ca<=0?0.01:ca}else if(ca>0.5){ca/=0.5;ca=2-ca;La=ca<=0?0.01:ca}k();ca-=1;if(La===ca+1)ca=Math.abs(ca);break;case "angle":ca-=0.5;Sa=ca*=180;k();ca/=100}ab.elem.css({"margin-left":ma});ca=Math.round(ca*100);ab.input.val(ca);la.preventDefault()},pb=function(){P.unbind("mousemove",ob).unbind("mouseup",pb);ab=null};for(N=(o.paint.alpha*255/100).toString(16);N.length<2;)N="0"+N;N=N.split(".")[0];G=o.paint.solidColor=="none"?"":o.paint.solidColor+N;pa||(G=Ba[0].getAttribute("stop-color"));
$.extend($.fn.jPicker.defaults.window,{alphaSupport:true,effects:{type:"show",speed:0}});Q.jPicker({window:{title:n.window.pickerTitle},images:{clientPath:n.images.clientPath},color:{active:G,alphaSupport:true}},function(la){o.paint.type="solidColor";o.paint.alpha=la.val("ahex")?Math.round(la.val("a")/255*100):100;o.paint.solidColor=la.val("hex")?la.val("hex"):"none";o.paint.radialGradient=null;I()},null,function(){H()});var fb=$(C+" .jGraduate_tabs li");fb.on("click touchstart",function(){fb.removeClass("jGraduate_tab_current");
$(this).addClass("jGraduate_tab_current");$(C+" > div").hide();var la=$(this).attr("data-type");$(C+" .jGraduate_gradPick").show();if(la==="rg"||la==="lg"){$(".jGraduate_"+la+"_field").show();$(".jGraduate_"+(la==="lg"?"rg":"lg")+"_field").hide();$("#"+m+"_jgraduate_rect")[0].setAttribute("fill","url(#"+m+"_"+la+"_jgraduate_grad)");T=la==="lg"?"linearGradient":"radialGradient";$("#"+m+"_jGraduate_OpacInput").val(o.paint.alpha).change();var ca=$("#"+m+"_"+la+"_jgraduate_grad")[0];if(aa!==ca){var ma=
$(aa).find("stop");$(ca).empty().append(ma);aa=ca;ca=lb.val();aa.setAttribute("spreadMethod",ca)}eb=la==="rg"&&aa.getAttribute("fx")!=null&&!(wa==Ha&&ra==Da);$("#"+m+"_jGraduate_focusCoord").toggle(eb);if(eb)$("#"+m+"_jGraduate_match_ctr")[0].checked=false}else{$(C+" .jGraduate_gradPick").hide();$(C+" .jGraduate_colPick").show()}});$(C+" > div").hide();fb.removeClass("jGraduate_tab_current");var tb;switch(o.paint.type){case "linearGradient":tb=$(C+" .jGraduate_tab_lingrad");break;case "radialGradient":tb=
$(C+" .jGraduate_tab_radgrad");break;default:tb=$(C+" .jGraduate_tab_color")}o.show();setTimeout(function(){tb.addClass("jGraduate_tab_current").click()},10)}else alert("Container element must have an id attribute to maintain unique id strings for sub-elements.")})}})();jQuery&&function(){var a=$(window),f=$(document);$.extend($.fn,{contextMenu:function(e,b){if(e.menu==undefined)return false;if(e.inSpeed==undefined)e.inSpeed=150;if(e.outSpeed==undefined)e.outSpeed=75;if(e.inSpeed==0)e.inSpeed=-1;if(e.outSpeed==0)e.outSpeed=-1;$(this).each(function(){var g=$(this),d=$(g).offset(),c=$("#"+e.menu);c.addClass("contextMenu");$(this).bind("mousedown",function(k){$(this).on("mouseup",function(l){var o=$(this);o.unbind("mouseup");$(".contextMenu").hide();if(k.button===2||
e.allowLeft||k.ctrlKey&&svgedit.browser.isMac())svgedit.browser.isTouch()||h(l,k,o)})});svgedit.browser.isTouch()&&$(this).bind("taphold",function(k){var l=$(this);l.unbind("mouseup");h(k,k,l)});var h=function(k,l,o){if(typeof l=="undefined")l=k;k.stopPropagation();if(g.hasClass("disabled")||l.altKey)return false;var n=k.pageX,m=k.pageY;if(svgedit.browser.isTouch()){n=k.originalEvent.touches[0].pageX;m=k.originalEvent.touches[0].pageY}k=a.width()-c.width();l=a.height()-c.height();if(n>k-15)n=k-15;
if(m>l-30)m=l-30;if(svgedit.browser.isTouch())m-=c.height()/2;f.unbind("click");c.css({top:m,left:n}).fadeIn(e.inSpeed);c.find("A").mouseover(function(){c.find("LI.hover").removeClass("hover");$(this).parent().addClass("hover")}).mouseout(function(){c.find("LI.hover").removeClass("hover")});f.keypress(function(C){switch(C.keyCode){case 38:if(c.find("LI.hover").length){c.find("LI.hover").removeClass("hover").prevAll("LI:not(.disabled)").eq(0).addClass("hover");c.find("LI.hover").length||c.find("LI:last").addClass("hover")}else c.find("LI:last").addClass("hover");
break;case 40:if(c.find("LI.hover").length==0)c.find("LI:first").addClass("hover");else{c.find("LI.hover").removeClass("hover").nextAll("LI:not(.disabled)").eq(0).addClass("hover");c.find("LI.hover").length||c.find("LI:first").addClass("hover")}break;case 13:c.find("LI.hover A").trigger("click");break;case 27:f.trigger("click")}});c.find("A").unbind("mouseup");c.find("LI:not(.disabled) A").mouseup(function(){f.unbind("click").unbind("keypress");$(".contextMenu").hide();b&&b($(this).attr("href").substr(1),
$(o),{x:n-d.left,y:m-d.top,docX:n,docY:m});return false});setTimeout(function(){f.click(function(){f.unbind("click").unbind("keypress");c.fadeOut(e.outSpeed);return false})},0)};if($.browser.mozilla)$("#"+e.menu).each(function(){$(this).css({MozUserSelect:"none"})});else $.browser.msie?$("#"+e.menu).each(function(){$(this).bind("selectstart.disableTextSelect",function(){return false})}):$("#"+e.menu).each(function(){$(this).bind("mousedown.disableTextSelect",function(){return false})});$(g).add($("UL.contextMenu")).bind("contextmenu",
function(){return false})});return $(this)},disableContextMenuItems:function(e){if(e==undefined){$(this).find("LI").addClass("disabled");return $(this)}$(this).each(function(){if(e!=undefined)for(var b=e.split(","),g=0;g<b.length;g++)$(this).find('A[href="'+b[g]+'"]').parent().addClass("disabled")});return $(this)},enableContextMenuItems:function(e){if(e==undefined){$(this).find("LI.disabled").removeClass("disabled");return $(this)}$(this).each(function(){if(e!=undefined)for(var b=e.split(","),g=
0;g<b.length;g++)$(this).find('A[href="'+b[g]+'"]').parent().removeClass("disabled")});return $(this)},disableContextMenu:function(){$(this).each(function(){$(this).addClass("disabled")});return $(this)},enableContextMenu:function(){$(this).each(function(){$(this).removeClass("disabled")});return $(this)},destroyContextMenu:function(){$(this).each(function(){$(this).unbind("mousedown").unbind("mouseup")});return $(this)}})}(jQuery);var svgedit=svgedit||{};
(function(){if(!svgedit.browser)svgedit.browser={};var a=!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect;svgedit.browser.supportsSvg=function(){return a};if(svgedit.browser.supportsSvg()){var f=navigator.userAgent,e=document.createElementNS("http://www.w3.org/2000/svg","svg"),b=!!window.opera,g=f.indexOf("AppleWebKit")>=0,d=f.indexOf("Gecko/")>=0,c=f.indexOf("MSIE")>=0,h=f.indexOf("Chrome/")>=0,k=f.indexOf("Windows")>=0,l=f.indexOf("Macintosh")>=
0,o="ontouchstart"in window,n=!!e.querySelector,m=!!document.evaluate,C=function(){var ja=document.createElementNS("http://www.w3.org/2000/svg","path");ja.setAttribute("d","M0,0 10,10");var V=ja.pathSegList;ja=ja.createSVGPathSegLinetoAbs(5,5);try{V.replaceItem(ja,0);return true}catch(T){}return false}(),I=function(){var ja=document.createElementNS("http://www.w3.org/2000/svg","path");ja.setAttribute("d","M0,0 10,10");var V=ja.pathSegList;ja=ja.createSVGPathSegLinetoAbs(5,5);try{V.insertItemBefore(ja,
0);return true}catch(T){}return false}(),H=function(){var ja=document.createElementNS("http://www.w3.org/2000/svg","svg"),V=document.createElementNS("http://www.w3.org/2000/svg","svg");document.documentElement.appendChild(ja);V.setAttribute("x",5);ja.appendChild(V);var T=document.createElementNS("http://www.w3.org/2000/svg","text");T.textContent="a";V.appendChild(T);V=T.getStartPositionOfChar(0);V=V.x;document.documentElement.removeChild(ja);return V===0}(),G=function(){var ja=document.createElementNS("http://www.w3.org/2000/svg",
"svg");document.documentElement.appendChild(ja);var V=document.createElementNS("http://www.w3.org/2000/svg","path");V.setAttribute("d","M0,0 C0,0 10,10 10,0");ja.appendChild(V);V=V.getBBox();document.documentElement.removeChild(ja);return V.height>4&&V.height<5}(),P=function(){var ja=document.createElementNS("http://www.w3.org/2000/svg","svg");document.documentElement.appendChild(ja);var V=document.createElementNS("http://www.w3.org/2000/svg","path");V.setAttribute("d","M0,0 10,0");var T=document.createElementNS("http://www.w3.org/2000/svg",
"path");T.setAttribute("d","M5,0 15,0");var aa=document.createElementNS("http://www.w3.org/2000/svg","g");aa.appendChild(V);aa.appendChild(T);ja.appendChild(aa);V=aa.getBBox();document.documentElement.removeChild(ja);return V.width==15}(),Q=function(){var ja=document.createElementNS("http://www.w3.org/2000/svg","rect");ja.setAttribute("x",0.1);(ja=ja.cloneNode(false).getAttribute("x").indexOf(",")==-1)||$.alert("NOTE: This version of Opera is known to contain bugs in SVG-edit.\n    Please upgrade to the <a href='http://opera.com'>latest version</a> in which the problems have been fixed.");
return ja}(),N=function(){var ja=document.createElementNS("http://www.w3.org/2000/svg","rect");ja.setAttribute("style","vector-effect:non-scaling-stroke");return ja.style.vectorEffect==="non-scaling-stroke"}(),ba=function(){var ja=document.createElementNS("http://www.w3.org/2000/svg","rect").transform.baseVal,V=e.createSVGTransform();ja.appendItem(V);return ja.getItem(0)==V}();svgedit.browser.isOpera=function(){return b};svgedit.browser.isWebkit=function(){return g};svgedit.browser.isGecko=function(){return d};
svgedit.browser.isIE=function(){return c};svgedit.browser.isChrome=function(){return h};svgedit.browser.isWindows=function(){return k};svgedit.browser.isMac=function(){return l};svgedit.browser.isTouch=function(){return o};svgedit.browser.supportsSelectors=function(){return n};svgedit.browser.supportsXpath=function(){return m};svgedit.browser.supportsPathReplaceItem=function(){return C};svgedit.browser.supportsPathInsertItemBefore=function(){return I};svgedit.browser.supportsPathBBox=function(){return G};
svgedit.browser.supportsHVLineContainerBBox=function(){return P};svgedit.browser.supportsGoodTextCharPos=function(){return H};svgedit.browser.supportsEditableText=function(){return b};svgedit.browser.supportsGoodDecimals=function(){return Q};svgedit.browser.supportsNonScalingStroke=function(){return N};svgedit.browser.supportsNativeTransformLists=function(){return ba}}else window.location="browser-not-supported.html"})();svgedit=svgedit||{};
(function(){if(!svgedit.transformlist)svgedit.transformlist={};var a=document.createElementNS("http://www.w3.org/2000/svg","svg"),f={};svgedit.transformlist.SVGTransformList=function(e){this._elem=e||null;this._xforms=[];this._update=function(){var b="";a.createSVGMatrix();for(var g=0;g<this.numberOfItems;++g){var d=this._list.getItem(g);b=b;d=d;var c=d.matrix,h="";switch(d.type){case 1:h="matrix("+[c.a,c.b,c.c,c.d,c.e,c.f].join(",")+")";break;case 2:h="translate("+c.e+","+c.f+")";break;case 3:h=
c.a==c.d?"scale("+c.a+")":"scale("+c.a+","+c.d+")";break;case 4:var k=0;h=0;if(d.angle!=0){k=1-c.a;h=(k*c.f+c.b*c.e)/(k*k+c.b*c.b);k=(c.e-c.b*h)/k}h="rotate("+d.angle+" "+k+","+h+")"}b=b+(h+" ")}this._elem.setAttribute("transform",b)};this._list=this;this._init=function(){var b=this._elem.getAttribute("transform");if(b)for(var g=/\s*((scale|matrix|rotate|translate)\s*\(.*?\))\s*,?\s*/,d=true;d;){d=b.match(g);b=b.replace(g,"");if(d&&d[1]){var c=d[1].split(/\s*\(/),h=c[0];c=c[1].match(/\s*(.*?)\s*\)/);
c[1]=c[1].replace(/(\d)-/g,"$1 -");var k=c[1].split(/[, ]+/),l="abcdef".split(""),o=a.createSVGMatrix();$.each(k,function(C,I){k[C]=parseFloat(I);if(h=="matrix")o[l[C]]=k[C]});c=a.createSVGTransform();var n="set"+h.charAt(0).toUpperCase()+h.slice(1),m=h=="matrix"?[o]:k;if(h=="scale"&&m.length==1)m.push(m[0]);else if(h=="translate"&&m.length==1)m.push(0);else if(h=="rotate"&&m.length==1){m.push(0);m.push(0)}c[n].apply(c,m);this._list.appendItem(c)}}};this._removeFromOtherLists=function(b){if(b){var g=
false,d;for(d in f){for(var c=f[d],h=0,k=c._xforms.length;h<k;++h)if(c._xforms[h]==b){g=true;c.removeItem(h);break}if(g)break}}};this.numberOfItems=0;this.clear=function(){this.numberOfItems=0;this._xforms=[]};this.initialize=function(b){this.numberOfItems=1;this._removeFromOtherLists(b);this._xforms=[b]};this.getItem=function(b){if(b<this.numberOfItems&&b>=0)return this._xforms[b];throw{code:1};};this.insertItemBefore=function(b,g){var d=null;if(g>=0)if(g<this.numberOfItems){this._removeFromOtherLists(b);
d=Array(this.numberOfItems+1);for(var c=0;c<g;++c)d[c]=this._xforms[c];d[c]=b;for(var h=c+1;c<this.numberOfItems;++h,++c)d[h]=this._xforms[c];this.numberOfItems++;this._xforms=d;d=b;this._list._update()}else d=this._list.appendItem(b);return d};this.replaceItem=function(b,g){var d=null;if(g<this.numberOfItems&&g>=0){this._removeFromOtherLists(b);d=this._xforms[g]=b;this._list._update()}return d};this.removeItem=function(b){if(b<this.numberOfItems&&b>=0){for(var g=this._xforms[b],d=Array(this.numberOfItems-
1),c=0;c<b;++c)d[c]=this._xforms[c];for(b=c;b<this.numberOfItems-1;++b,++c)d[b]=this._xforms[c+1];this.numberOfItems--;this._xforms=d;this._list._update();return g}else throw{code:1};};this.appendItem=function(b){this._removeFromOtherLists(b);this._xforms.push(b);this.numberOfItems++;this._list._update();return b}};svgedit.transformlist.resetListMap=function(){f={}};svgedit.transformlist.removeElementFromListMap=function(e){e.id&&f[e.id]&&delete f[e.id]};svgedit.transformlist.getTransformList=function(e){if(svgedit.browser.supportsNativeTransformLists())if(e.transform)return e.transform.baseVal;
else if(e.gradientTransform)return e.gradientTransform.baseVal;else{if(e.patternTransform)return e.patternTransform.baseVal}else{var b=e.id;b||(b="temp");var g=f[b];if(!g||b=="temp"){f[b]=new svgedit.transformlist.SVGTransformList(e);f[b]._init();g=f[b]}return g}return null}})();svgedit=svgedit||{};
(function(){if(!svgedit.math)svgedit.math={};var a=document.createElementNS("http://www.w3.org/2000/svg","svg");svgedit.math.transformPoint=function(f,e,b){return{x:b.a*f+b.c*e+b.e,y:b.b*f+b.d*e+b.f}};svgedit.math.isIdentity=function(f){return f.a===1&&f.b===0&&f.c===0&&f.d===1&&f.e===0&&f.f===0};svgedit.math.matrixMultiply=function(){for(var f=arguments,e=f.length,b=f[e-1];e-- >1;)b=f[e-1].multiply(b);if(Math.abs(b.a)<1.0E-14)b.a=0;if(Math.abs(b.b)<1.0E-14)b.b=0;if(Math.abs(b.c)<1.0E-14)b.c=0;if(Math.abs(b.d)<
1.0E-14)b.d=0;if(Math.abs(b.e)<1.0E-14)b.e=0;if(Math.abs(b.f)<1.0E-14)b.f=0;return b};svgedit.math.hasMatrixTransform=function(f){if(!f)return false;for(var e=f.numberOfItems;e--;){var b=f.getItem(e);if(b.type==1&&!svgedit.math.isIdentity(b.matrix))return true}return false};svgedit.math.transformBox=function(f,e,b,g,d){var c={x:f,y:e},h={x:f+b,y:e};b={x:f+b,y:e+g};f={x:f,y:e+g};e=svgedit.math.transformPoint;c=e(c.x,c.y,d);var k=g=c.x,l=c.y,o=c.y;h=e(h.x,h.y,d);g=Math.min(g,h.x);k=Math.max(k,h.x);
l=Math.min(l,h.y);o=Math.max(o,h.y);f=e(f.x,f.y,d);g=Math.min(g,f.x);k=Math.max(k,f.x);l=Math.min(l,f.y);o=Math.max(o,f.y);b=e(b.x,b.y,d);g=Math.min(g,b.x);k=Math.max(k,b.x);l=Math.min(l,b.y);o=Math.max(o,b.y);return{tl:c,tr:h,bl:f,br:b,aabox:{x:g,y:l,width:k-g,height:o-l}}};svgedit.math.transformListToTransform=function(f,e,b){if(f==null)return a.createSVGTransformFromMatrix(a.createSVGMatrix());e=e==undefined?0:e;b=b==undefined?f.numberOfItems-1:b;e=parseInt(e);b=parseInt(b);if(e>b){var g=b;b=e;
e=g}g=a.createSVGMatrix();for(e=e;e<=b;++e){var d=e>=0&&e<f.numberOfItems?f.getItem(e).matrix:a.createSVGMatrix();g=svgedit.math.matrixMultiply(g,d)}return a.createSVGTransformFromMatrix(g)};svgedit.math.getMatrix=function(f){f=svgedit.transformlist.getTransformList(f);return svgedit.math.transformListToTransform(f).matrix};svgedit.math.snapToAngle=function(f,e,b,g){var d=Math.PI/4;b=b-f;var c=g-e;g=Math.sqrt(b*b+c*c);d=Math.round(Math.atan2(c,b)/d)*d;return{x:f+g*Math.cos(d),y:e+g*Math.sin(d),a:d}};
svgedit.math.rectsIntersect=function(f,e){if(!f||!e)return false;return e.x<f.x+f.width&&e.x+e.width>f.x&&e.y<f.y+f.height&&e.y+e.height>f.y}})();svgedit=svgedit||{};
(function(){if(!svgedit.units)svgedit.units={};var a=["x","x1","cx","rx","width"],f=["y","y1","cy","ry","height"],e=$.merge(["r","radius"],a);$.merge(e,f);var b,g={px:1};svgedit.units.init=function(c){b=c;c=document.createElementNS("http://www.w3.org/2000/svg","svg");document.body.appendChild(c);var h=document.createElementNS("http://www.w3.org/2000/svg","rect");h.setAttribute("width","1em");h.setAttribute("height","1ex");h.setAttribute("x","1in");c.appendChild(h);h=h.getBBox();document.body.removeChild(c);
c=h.x;g.em=h.width;g.ex=h.height;g["in"]=c;g.cm=c/2.54;g.mm=c/25.4;g.pt=c/72;g.pc=c/6;g["%"]=0};svgedit.units.getTypeMap=function(){return g};svgedit.units.shortFloat=function(c){var h=b.getRoundDigits();if(isNaN(c)){if($.isArray(c))return svgedit.units.shortFloat(c[0])+","+svgedit.units.shortFloat(c[1])}else return+(+c).toFixed(h);return parseFloat(c).toFixed(h)-0};svgedit.units.convertUnit=function(c,h){h=h||b.getBaseUnit();return svgedit.unit.shortFloat(c/g[h])};svgedit.units.setUnitAttr=function(c,
h,k){isNaN(k)||c.getAttribute(h);c.setAttribute(h,k)};var d={line:["x1","x2","y1","y2"],circle:["cx","cy","r"],ellipse:["cx","cy","rx","ry"],foreignObject:["x","y","width","height"],rect:["x","y","width","height"],image:["x","y","width","height"],use:["x","y","width","height"],text:["x","y"]};svgedit.units.convertAttrs=function(c){var h=c.tagName,k=b.getBaseUnit();if(h=d[h])for(var l=h.length,o=0;o<l;o++){var n=h[o],m=c.getAttribute(n);if(m)isNaN(m)||c.setAttribute(n,m/g[k]+k)}};svgedit.units.convertToNum=
function(c,h){if(!isNaN(h))return h-0;if(h.substr(-1)==="%"){var k=h.substr(0,h.length-1)/100,l=b.getWidth(),o=b.getHeight();return a.indexOf(c)>=0?k*l:f.indexOf(c)>=0?k*o:k*Math.sqrt(l*l+o*o)/Math.sqrt(2)}else{l=h.substr(-2);k=h.substr(0,h.length-2);return k*g[l]}};svgedit.units.isValidUnit=function(c,h,k){var l=false;if(e.indexOf(c)>=0)if(isNaN(h)){h=h.toLowerCase();$.each(g,function(m){if(!l)if(RegExp("^-?[\\d\\.]+"+m+"$").test(h))l=true})}else l=true;else if(c=="id"){c=false;try{var o=b.getElement(h);
c=o==null||o===k}catch(n){}return c}else l=true;return l}})();svgedit=svgedit||{};
(function(){function a(c){if(svgedit.browser.supportsHVLineContainerBBox())try{return c.getBBox()}catch(h){}var k=$.data(c,"ref"),l=null;if(k){var o=$(k).children().clone().attr("visibility","hidden");$(d).append(o);l=o.filter("line, path")}else l=$(c).find("line, path");var n=false;if(l.length){l.each(function(){var m=this.getBBox();if(!m.width||!m.height)n=true});if(n){c=k?o:$(c).children();ret=getStrokedBBox(c)}else ret=c.getBBox()}else ret=c.getBBox();k&&o.remove();return ret}if(!svgedit.utilities)svgedit.utilities=
{};var f="a,circle,ellipse,foreignObject,g,image,line,path,polygon,polyline,rect,svg,text,tspan,use".split(","),e=null,b=null,g=null,d=null;svgedit.utilities.init=function(c){e=c;b=c.getDOMDocument();g=c.getDOMContainer();d=c.getSVGRoot()};svgedit.utilities.toXml=function(c){return $("<p/>").text(c).html()};svgedit.utilities.fromXml=function(c){return $("<p/>").html(c).text()};svgedit.utilities.encode64=function(c){c=svgedit.utilities.convertToXMLReferences(c);if(window.btoa)return window.btoa(c);
var h=Array(Math.floor((c.length+2)/3)*4),k,l,o,n,m,C,I=0,H=0;do{k=c.charCodeAt(I++);l=c.charCodeAt(I++);o=c.charCodeAt(I++);n=k>>2;k=(k&3)<<4|l>>4;m=(l&15)<<2|o>>6;C=o&63;if(isNaN(l))m=C=64;else if(isNaN(o))C=64;h[H++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(n);h[H++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(k);h[H++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(m);h[H++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(C)}while(I<
c.length);return h.join("")};svgedit.utilities.decode64=function(c){if(window.atob)return window.atob(c);var h="",k,l,o="",n,m="",C=0;c=c.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(C++));l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(C++));n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(C++));m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(C++));
k=k<<2|l>>4;l=(l&15)<<4|n>>2;o=(n&3)<<6|m;h+=String.fromCharCode(k);if(n!=64)h+=String.fromCharCode(l);if(m!=64)h+=String.fromCharCode(o)}while(C<c.length);return unescape(h)};svgedit.utilities.convertToXMLReferences=function(c){for(var h="",k=0;k<c.length;k++){var l=c.charCodeAt(k);if(l<128)h+=c[k];else if(l>127)h+="&#"+l+";"}return h};svgedit.utilities.text2xml=function(c){if(c.indexOf("<svg:svg")>=0)c=c.replace(/<(\/?)svg:/g,"<$1").replace("xmlns:svg","xmlns");var h;try{var k=window.DOMParser?
new DOMParser:new ActiveXObject("Microsoft.XMLDOM");k.async=false}catch(l){throw Error("XML Parser could not be instantiated");}try{h=k.loadXML?k.loadXML(c)?k:false:k.parseFromString(c,"text/xml")}catch(o){throw Error("Error parsing XML string");}return h};svgedit.utilities.bboxToObj=function(c){return{x:c.x,y:c.y,width:c.width,height:c.height}};svgedit.utilities.walkTree=function(c,h){if(c&&c.nodeType==1){h(c);for(var k=c.childNodes.length;k--;)svgedit.utilities.walkTree(c.childNodes.item(k),h)}};
svgedit.utilities.walkTreePost=function(c,h){if(c&&c.nodeType==1){for(var k=c.childNodes.length;k--;)svgedit.utilities.walkTree(c.childNodes.item(k),h);h(c)}};svgedit.utilities.getUrlFromAttr=function(c){if(c)if(c.indexOf('url("')===0)return c.substring(5,c.indexOf('"',6));else if(c.indexOf("url('")===0)return c.substring(5,c.indexOf("'",6));else if(c.indexOf("url(")===0)return c.substring(4,c.indexOf(")"));return null};svgedit.utilities.getHref=function(c){if(c)return c.getAttributeNS("http://www.w3.org/1999/xlink",
"href")};svgedit.utilities.setHref=function(c,h){c.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",h)};svgedit.utilities.findDefs=function(c){c=e.getSVGContent().documentElement;var h=c.getElementsByTagNameNS("http://www.w3.org/2000/svg","defs");return h=h.length>0?h[0]:c.insertBefore(c.ownerDocument.createElementNS("http://www.w3.org/2000/svg","defs"),c.firstChild.nextSibling)};svgedit.utilities.getPathBBox=function(c){var h=c.pathSegList,k=h.numberOfItems;c=[[],[]];var l=h.getItem(0),
o=[l.x,l.y];for(l=0;l<k;l++){var n=h.getItem(l);if(typeof n.x!="undefined"){c[0].push(o[0]);c[1].push(o[1]);if(n.x1){for(var m=[n.x1,n.y1],C=[n.x2,n.y2],I=[n.x,n.y],H=0;H<2;H++){n=function(ba){return Math.pow(1-ba,3)*o[H]+3*Math.pow(1-ba,2)*ba*m[H]+3*(1-ba)*Math.pow(ba,2)*C[H]+Math.pow(ba,3)*I[H]};var G=6*o[H]-12*m[H]+6*C[H],P=-3*o[H]+9*m[H]-9*C[H]+3*I[H],Q=3*m[H]-3*o[H];if(P==0){if(G!=0){G=-Q/G;0<G&&G<1&&c[H].push(n(G))}}else{Q=Math.pow(G,2)-4*Q*P;if(!(Q<0)){var N=(-G+Math.sqrt(Q))/(2*P);0<N&&N<
1&&c[H].push(n(N));G=(-G-Math.sqrt(Q))/(2*P);0<G&&G<1&&c[H].push(n(G))}}}o=I}else{c[0].push(n.x);c[1].push(n.y)}}}h=Math.min.apply(null,c[0]);k=Math.max.apply(null,c[0])-h;l=Math.min.apply(null,c[1]);c=Math.max.apply(null,c[1])-l;return{x:h,y:l,width:k,height:c}};svgedit.utilities.getBBox=function(c){var h=c||e.getSelectedElements()[0];if(c.nodeType!=1)return null;c=null;var k=h.nodeName;switch(k){case "text":if(h.textContent===""){h.textContent="a";c=h.getBBox();h.textContent=""}else try{c=h.getBBox()}catch(l){}break;
case "path":if(svgedit.browser.supportsPathBBox())try{c=h.getBBox()}catch(o){}else c=svgedit.utilities.getPathBBox(h);break;case "g":case "a":c=a(h);break;default:if(k==="use")c=a(h,true);if(k==="use")c||(c=h.getBBox());else if(~f.indexOf(k))try{c=h.getBBox()}catch(n){h=$(h).closest("foreignObject");if(h.length)try{c=h[0].getBBox()}catch(m){c=null}else c=null}}if(c)c=svgedit.utilities.bboxToObj(c);return c};svgedit.utilities.getRotationAngle=function(c,h){var k=c||e.getSelectedElements()[0];k=svgedit.transformlist.getTransformList(k);
if(!k)return 0;for(var l=k.numberOfItems,o=0;o<l;++o){var n=k.getItem(o);if(n.type==4)return h?n.angle*Math.PI/180:n.angle}return 0};svgedit.utilities.getElem=svgedit.browser.supportsSelectors()?function(c){return d.querySelector("#"+c)}:svgedit.browser.supportsXpath()?function(c){return b.evaluate('svg:svg[@id="svgroot"]//svg:*[@id="'+c+'"]',g,function(){return"http://www.w3.org/2000/svg"},9,null).singleNodeValue}:function(c){return $(d).find("[id="+c+"]")[0]};svgedit.utilities.assignAttributes=
function(c,h,k,l){k||(k=0);svgedit.browser.isOpera()||d.suspendRedraw(k);for(var o in h)if(k=o.substr(0,4)==="xml:"?"http://www.w3.org/XML/1998/namespace":o.substr(0,6)==="xlink:"?"http://www.w3.org/1999/xlink":null)c.setAttributeNS(k,o,h[o]);else l?svgedit.units.setUnitAttr(c,o,h[o]):c.setAttribute(o,h[o]);svgedit.browser.isOpera()||d.unsuspendRedraw(null)};svgedit.utilities.cleanupElement=function(c){var h=d.suspendRedraw(60),k={"fill-opacity":1,"stop-opacity":1,opacity:1,stroke:"none","stroke-dasharray":"none",
"stroke-linejoin":"miter","stroke-linecap":"butt","stroke-opacity":1,"stroke-width":1,rx:0,ry:0},l;for(l in k){var o=k[l];c.getAttribute(l)==o&&c.removeAttribute(l)}d.unsuspendRedraw(h)}})();svgedit=svgedit||{};
(function(){if(!svgedit.sanitize)svgedit.sanitize={};var a={};a["http://www.w3.org/1999/xlink"]="xlink";a["http://www.w3.org/XML/1998/namespace"]="xml";a["http://www.w3.org/2000/xmlns/"]="xmlns";a["http://svg-edit.googlecode.com"]="se";a["http://www.w3.org/1999/xhtml"]="xhtml";a["http://www.w3.org/1998/Math/MathML"]="mathml";var f={};$.each(a,function(g,d){f[d]=g});var e={a:["class","clip-path","clip-rule","fill","fill-opacity","fill-rule","filter","id","mask","opacity","stroke","stroke-dasharray",
"stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform","xlink:href","xlink:title"],circle:["class","clip-path","clip-rule","cx","cy","fill","fill-opacity","fill-rule","filter","id","mask","opacity","r","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform"],clipPath:["class",
"clipPathUnits","id"],defs:[],style:["type"],desc:[],ellipse:["class","clip-path","clip-rule","cx","cy","fill","fill-opacity","fill-rule","filter","id","mask","opacity","requiredFeatures","rx","ry","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform"],feGaussianBlur:["class","color-interpolation-filters","id","requiredFeatures","stdDeviation"],filter:["class","color-interpolation-filters",
"filterRes","filterUnits","height","id","primitiveUnits","requiredFeatures","width","x","xlink:href","y"],foreignObject:["class","font-size","height","id","opacity","requiredFeatures","style","transform","width","x","y"],g:["class","clip-path","clip-rule","id","display","fill","fill-opacity","fill-rule","filter","mask","opacity","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage",
"transform","font-family","font-size","font-style","font-weight","text-anchor","data-locked"],image:["class","clip-path","clip-rule","filter","height","id","mask","opacity","requiredFeatures","style","systemLanguage","transform","width","x","xlink:href","xlink:title","y"],line:["shape-rendering","class","clip-path","clip-rule","fill","fill-opacity","fill-rule","filter","id","marker-end","marker-mid","marker-start","mask","opacity","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset",
"stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform","x1","x2","y1","y2"],linearGradient:["class","id","gradientTransform","gradientUnits","requiredFeatures","spreadMethod","systemLanguage","x1","x2","xlink:href","y1","y2"],marker:["id","class","markerHeight","markerUnits","markerWidth","orient","preserveAspectRatio","refX","refY","systemLanguage","viewBox"],mask:["class","height","id","maskContentUnits","maskUnits","width","x",
"y"],metadata:["class","id"],path:["class","clip-path","clip-rule","d","fill","fill-opacity","fill-rule","filter","id","marker-end","marker-mid","marker-start","mask","opacity","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform"],pattern:["class","height","id","patternContentUnits","patternTransform","patternUnits","requiredFeatures","style","systemLanguage","viewBox",
"width","x","xlink:href","y"],polygon:["class","clip-path","clip-rule","id","fill","fill-opacity","fill-rule","filter","id","class","marker-end","marker-mid","marker-start","mask","opacity","points","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform"],polyline:["class","clip-path","clip-rule","id","fill","fill-opacity","fill-rule","filter","marker-end","marker-mid",
"marker-start","mask","opacity","points","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform"],radialGradient:["class","cx","cy","fx","fy","gradientTransform","gradientUnits","id","r","requiredFeatures","spreadMethod","systemLanguage","xlink:href"],rect:["shape-rendering","class","clip-path","clip-rule","fill","fill-opacity","fill-rule","filter","height","id","mask",
"opacity","requiredFeatures","rx","ry","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform","width","x","y"],stop:["class","id","offset","requiredFeatures","stop-color","stop-opacity","style","systemLanguage"],svg:["class","clip-path","clip-rule","filter","id","height","mask","preserveAspectRatio","requiredFeatures","style","systemLanguage","viewBox","width","x","xmlns","xmlns:se",
"xmlns:xlink","y"],"switch":["class","id","requiredFeatures","systemLanguage"],symbol:["class","fill","fill-opacity","fill-rule","filter","font-family","font-size","font-style","font-weight","id","opacity","preserveAspectRatio","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform","viewBox"],text:["class","clip-path","clip-rule","fill","fill-opacity","fill-rule",
"filter","font-family","font-size","font-style","font-weight","id","mask","opacity","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","text-anchor","transform","x","xml:space","y"],textPath:["class","id","method","requiredFeatures","spacing","startOffset","style","systemLanguage","transform","xlink:href"],title:[],tspan:["class","clip-path","clip-rule","dx","dy","fill",
"fill-opacity","fill-rule","filter","font-family","font-size","font-style","font-weight","id","mask","opacity","requiredFeatures","rotate","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","text-anchor","textLength","transform","x","xml:space","y"],use:["class","clip-path","clip-rule","fill","fill-opacity","fill-rule","filter","height","id","mask","stroke","stroke-dasharray","stroke-dashoffset",
"stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","transform","width","x","xlink:href","y"],annotation:["encoding"],"annotation-xml":["encoding"],maction:["actiontype","other","selection"],math:["class","id","display","xmlns"],menclose:["notation"],merror:[],mfrac:["linethickness"],mi:["mathvariant"],mmultiscripts:[],mn:[],mo:["fence","lspace","maxsize","minsize","rspace","stretchy"],mover:[],mpadded:["lspace","width","height","depth","voffset"],mphantom:[],
mprescripts:[],mroot:[],mrow:["xlink:href","xlink:type","xmlns:xlink"],mspace:["depth","height","width"],msqrt:[],mstyle:["displaystyle","mathbackground","mathcolor","mathvariant","scriptlevel"],msub:[],msubsup:[],msup:[],mtable:["align","columnalign","columnlines","columnspacing","displaystyle","equalcolumns","equalrows","frame","rowalign","rowlines","rowspacing","width"],mtd:["columnalign","columnspan","rowalign","rowspan"],mtext:[],mtr:["columnalign","rowalign"],munder:[],munderover:[],none:[],
semantics:[]},b={};$.each(e,function(g,d){var c={};$.each(d,function(h,k){if(k.indexOf(":")>=0){var l=k.split(":");c[l[1]]=f[l[0]]}else c[k]=k=="xmlns"?"http://www.w3.org/2000/xmlns/":null});b[g]=c});svgedit.sanitize.getNSMap=function(){return a};svgedit.sanitize.sanitizeSvg=function(g){if(g.nodeType==3){g.nodeValue=g.nodeValue.replace(/^\s+|\s+$/g,"");g.nodeValue.length||g.parentNode.removeChild(g)}if(g.nodeType==1){var d=g.parentNode;if(g.ownerDocument&&d){var c=e[g.nodeName],h=b[g.nodeName];if(c!=
undefined){for(var k=[],l=g.attributes.length;l--;){var o=g.attributes.item(l),n=o.nodeName,m=o.localName,C=o.namespaceURI;if(!(h.hasOwnProperty(m)&&C==h[m]&&C!="http://www.w3.org/2000/xmlns/")&&!(C=="http://www.w3.org/2000/xmlns/"&&a[o.nodeValue])){n.indexOf("se:")==0&&k.push([n,o.nodeValue]);g.removeAttributeNS(C,m)}if(svgedit.browser.isGecko())switch(n){case "transform":case "gradientTransform":case "patternTransform":m=o.nodeValue.replace(/(\d)-/g,"$1 -");g.setAttribute(n,m)}if(n=="style"){o=
o.nodeValue.split(";");for(n=o.length;n--;){m=o[n].split(":");c.indexOf(m[0])>=0&&g.setAttribute(m[0],m[1])}g.removeAttribute("style")}}$.each(k,function(I,H){g.setAttributeNS("http://svg-edit.googlecode.com",H[0],H[1])});if((l=svgedit.utilities.getHref(g))&&["filter","linearGradient","pattern","radialGradient","textPath","use"].indexOf(g.nodeName)>=0)if(l[0]!="#"){svgedit.utilities.setHref(g,"");g.removeAttributeNS("http://www.w3.org/1999/xlink","href")}if(g.nodeName=="use"&&!svgedit.utilities.getHref(g))d.removeChild(g);
else{$.each(["clip-path","fill","filter","marker-end","marker-mid","marker-start","mask","stroke"],function(I,H){var G=g.getAttribute(H);if(G)if((G=svgedit.utilities.getUrlFromAttr(G))&&G[0]!=="#"){g.setAttribute(H,"");g.removeAttribute(H)}});for(l=g.childNodes.length;l--;)svgedit.sanitize.sanitizeSvg(g.childNodes.item(l))}}else{for(c=[];g.hasChildNodes();)c.push(d.insertBefore(g.firstChild,g));d.removeChild(g);for(l=c.length;l--;)svgedit.sanitize.sanitizeSvg(c[l])}}}}})();svgedit=svgedit||{};
(function(){if(!svgedit.history)svgedit.history={};svgedit.history.HistoryEventTypes={BEFORE_APPLY:"before_apply",AFTER_APPLY:"after_apply",BEFORE_UNAPPLY:"before_unapply",AFTER_UNAPPLY:"after_unapply"};svgedit.history.MoveElementCommand=function(a,f,e,b){this.elem=a;this.text=b?"Move "+a.tagName+" to "+b:"Move "+a.tagName;this.oldNextSibling=f;this.oldParent=e;this.newNextSibling=a.nextSibling;this.newParent=a.parentNode};svgedit.history.MoveElementCommand.type=function(){return"svgedit.history.MoveElementCommand"};svgedit.history.MoveElementCommand.prototype.type=
svgedit.history.MoveElementCommand.type;svgedit.history.MoveElementCommand.prototype.getText=function(){return this.text};svgedit.history.MoveElementCommand.prototype.apply=function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_APPLY,this);this.elem=this.newParent.insertBefore(this.elem,this.newNextSibling);a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_APPLY,this)};svgedit.history.MoveElementCommand.prototype.unapply=function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_UNAPPLY,
this);this.elem=this.oldParent.insertBefore(this.elem,this.oldNextSibling);a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_UNAPPLY,this)};svgedit.history.MoveElementCommand.prototype.elements=function(){return[this.elem]};svgedit.history.InsertElementCommand=function(a,f){this.elem=a;this.text=f||"Create "+a.tagName;this.parent=a.parentNode;this.nextSibling=this.elem.nextSibling};svgedit.history.InsertElementCommand.type=function(){return"svgedit.history.InsertElementCommand"};svgedit.history.InsertElementCommand.prototype.type=
svgedit.history.InsertElementCommand.type;svgedit.history.InsertElementCommand.prototype.getText=function(){return this.text};svgedit.history.InsertElementCommand.prototype.apply=function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_APPLY,this);this.elem=this.parent.insertBefore(this.elem,this.nextSibling);a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_APPLY,this)};svgedit.history.InsertElementCommand.prototype.unapply=function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_UNAPPLY,
this);this.parent=this.elem.parentNode;this.elem=this.elem.parentNode.removeChild(this.elem);a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_UNAPPLY,this)};svgedit.history.InsertElementCommand.prototype.elements=function(){return[this.elem]};svgedit.history.RemoveElementCommand=function(a,f,e,b){this.elem=a;this.text=b||"Delete "+a.tagName;this.nextSibling=f;this.parent=e;svgedit.transformlist.removeElementFromListMap(a)};svgedit.history.RemoveElementCommand.type=function(){return"svgedit.history.RemoveElementCommand"};
svgedit.history.RemoveElementCommand.prototype.type=svgedit.history.RemoveElementCommand.type;svgedit.history.RemoveElementCommand.prototype.getText=function(){return this.text};svgedit.history.RemoveElementCommand.prototype.apply=function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_APPLY,this);svgedit.transformlist.removeElementFromListMap(this.elem);this.parent=this.elem.parentNode;this.elem=this.parent.removeChild(this.elem);a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_APPLY,
this)};svgedit.history.RemoveElementCommand.prototype.unapply=function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_UNAPPLY,this);svgedit.transformlist.removeElementFromListMap(this.elem);this.nextSibling==null&&window.console&&console.log("Error: reference element was lost");this.parent.insertBefore(this.elem,this.nextSibling);a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_UNAPPLY,this)};svgedit.history.RemoveElementCommand.prototype.elements=function(){return[this.elem]};
svgedit.history.ChangeElementCommand=function(a,f,e){this.elem=a;this.text=e?"Change "+a.tagName+" "+e:"Change "+a.tagName;this.newValues={};this.oldValues=f;for(var b in f)this.newValues[b]=b=="#text"?a.textContent:b=="#href"?svgedit.utilities.getHref(a):a.getAttribute(b)};svgedit.history.ChangeElementCommand.type=function(){return"svgedit.history.ChangeElementCommand"};svgedit.history.ChangeElementCommand.prototype.type=svgedit.history.ChangeElementCommand.type;svgedit.history.ChangeElementCommand.prototype.getText=
function(){return this.text};svgedit.history.ChangeElementCommand.prototype.apply=function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_APPLY,this);var f=false,e;for(e in this.newValues){if(this.newValues[e])if(e=="#text")this.elem.textContent=this.newValues[e];else e=="#href"?svgedit.utilities.setHref(this.elem,this.newValues[e]):this.elem.setAttribute(e,this.newValues[e]);else if(e=="#text")this.elem.textContent="";else{this.elem.setAttribute(e,"");this.elem.removeAttribute(e)}if(e==
"transform")f=true}if(!f)if(f=svgedit.utilities.getRotationAngle(this.elem)){e=elem.getBBox();f=["rotate(",f," ",e.x+e.width/2,",",e.y+e.height/2,")"].join("");f!=elem.getAttribute("transform")&&elem.setAttribute("transform",f)}a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_APPLY,this);return true};svgedit.history.ChangeElementCommand.prototype.unapply=function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_UNAPPLY,this);var f=false,e;for(e in this.oldValues){if(this.oldValues[e])if(e==
"#text")this.elem.textContent=this.oldValues[e];else e=="#href"?svgedit.utilities.setHref(this.elem,this.oldValues[e]):this.elem.setAttribute(e,this.oldValues[e]);else if(e=="#text")this.elem.textContent="";else this.elem.removeAttribute(e);if(e=="transform")f=true}if(!f)if(f=svgedit.utilities.getRotationAngle(this.elem)){e=this.elem.getBBox();f=["rotate(",f," ",e.x+e.width/2,",",e.y+e.height/2,")"].join("");f!=this.elem.getAttribute("transform")&&this.elem.setAttribute("transform",f)}svgedit.transformlist.removeElementFromListMap(this.elem);
a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_UNAPPLY,this);return true};svgedit.history.ChangeElementCommand.prototype.elements=function(){return[this.elem]};svgedit.history.BatchCommand=function(a){this.text=a||"Batch Command";this.stack=[]};svgedit.history.BatchCommand.type=function(){return"svgedit.history.BatchCommand"};svgedit.history.BatchCommand.prototype.type=svgedit.history.BatchCommand.type;svgedit.history.BatchCommand.prototype.getText=function(){return this.text};svgedit.history.BatchCommand.prototype.apply=
function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_APPLY,this);for(var f=this.stack.length,e=0;e<f;++e)this.stack[e].apply(a);a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_APPLY,this)};svgedit.history.BatchCommand.prototype.unapply=function(a){a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_UNAPPLY,this);for(var f=this.stack.length-1;f>=0;f--)this.stack[f].unapply(a);a&&a.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_UNAPPLY,
this)};svgedit.history.BatchCommand.prototype.elements=function(){for(var a=[],f=this.stack.length;f--;)for(var e=this.stack[f].elements(),b=e.length;b--;)a.indexOf(e[b])==-1&&a.push(e[b]);return a};svgedit.history.BatchCommand.prototype.addSubCommand=function(a){this.stack.push(a)};svgedit.history.BatchCommand.prototype.isEmpty=function(){return this.stack.length==0};svgedit.history.UndoManager=function(a){this.handler_=a||null;this.undoStackPointer=0;this.undoStack=[];this.undoChangeStackPointer=
-1;this.undoableChangeStack=[]};svgedit.history.UndoManager.prototype.resetUndoStack=function(){this.undoStack=[];this.undoStackPointer=0};svgedit.history.UndoManager.prototype.getUndoStackSize=function(){return this.undoStackPointer};svgedit.history.UndoManager.prototype.getRedoStackSize=function(){return this.undoStack.length-this.undoStackPointer};svgedit.history.UndoManager.prototype.getNextUndoCommandText=function(){return this.undoStackPointer>0?this.undoStack[this.undoStackPointer-1].getText():
""};svgedit.history.UndoManager.prototype.getNextRedoCommandText=function(){return this.undoStackPointer<this.undoStack.length?this.undoStack[this.undoStackPointer].getText():""};svgedit.history.UndoManager.prototype.undo=function(){this.undoStackPointer>0&&this.undoStack[--this.undoStackPointer].unapply(this.handler_)};svgedit.history.UndoManager.prototype.redo=function(){this.undoStackPointer<this.undoStack.length&&this.undoStack.length>0&&this.undoStack[this.undoStackPointer++].apply(this.handler_)};
svgedit.history.UndoManager.prototype.addCommandToHistory=function(a){if(this.undoStackPointer<this.undoStack.length&&this.undoStack.length>0)this.undoStack=this.undoStack.splice(0,this.undoStackPointer);this.undoStack.push(a);this.undoStackPointer=this.undoStack.length};svgedit.history.UndoManager.prototype.beginUndoableChange=function(a,f){for(var e=++this.undoChangeStackPointer,b=f.length,g=Array(b),d=Array(b);b--;){var c=f[b];if(c!=null){d[b]=c;g[b]=c.getAttribute(a)}}this.undoableChangeStack[e]=
{attrName:a,oldValues:g,elements:d}};svgedit.history.UndoManager.prototype.finishUndoableChange=function(){for(var a=this.undoChangeStackPointer--,f=this.undoableChangeStack[a],e=f.elements.length,b=f.attrName,g=new svgedit.history.BatchCommand("Change "+b);e--;){var d=f.elements[e];if(d!=null){var c={};c[b]=f.oldValues[e];c[b]!=d.getAttribute(b)&&g.addSubCommand(new svgedit.history.ChangeElementCommand(d,c,b))}}this.undoableChangeStack[a]=null;return g}})();svgedit=svgedit||{};
(function(){if(!svgedit.select)svgedit.select={};var a,f,e;svgedit.select.Selector=function(b,g){this.id=b;this.selectedElement=g;this.locked=true;this.selectorGroup=a.createSVGElement({element:"g",attr:{id:"selectorGroup"+this.id}});this.selectorRect=this.selectorGroup.appendChild(a.createSVGElement({element:"path",attr:{id:"selectedBox"+this.id,fill:"none",stroke:"#4F80FF","stroke-width":"1","shape-rendering":"crispEdges",style:"pointer-events:none"}}));svgedit.browser.isTouch()&&this.selectorRect.setAttribute("stroke-opacity",
0.3);this.gripCoords={nw:null,n:null,ne:null,e:null,se:null,s:null,sw:null,w:null};this.reset(this.selectedElement)};svgedit.select.Selector.prototype.reset=function(b){this.locked=true;this.selectedElement=b;this.resize();this.selectorGroup.setAttribute("display","inline")};svgedit.select.Selector.prototype.updateGripCursors=function(b){var g=[];b=Math.round(b/45);if(b<0)b+=8;for(var d in e.selectorGrips)g.push(d);for(;b>0;){g.push(g.shift());b--}b=0;for(d in e.selectorGrips){e.selectorGrips[d].setAttribute("style",
"cursor:"+g[b]+"-resize");b++}};svgedit.select.Selector.prototype.showGrips=function(b){e.selectorGripsGroup.setAttribute("display",b?"inline":"none");var g=this.selectedElement;this.hasGrips=b;if(g&&b){this.selectorGroup.appendChild(e.selectorGripsGroup);this.updateGripCursors(svgedit.utilities.getRotationAngle(g))}};svgedit.select.Selector.prototype.resize=function(){var b=this.selectorRect,g=e,d=g.selectorGrips,c=this.selectedElement,h=c.getAttribute("stroke-width"),k=a.currentZoom(),l=1/k;if(c.getAttribute("stroke")!==
"none"&&!isNaN(h))l+=h/2;var o=c.tagName;if(o==="text")l+=2/k;h=svgedit.transformlist.getTransformList(c);h=svgedit.math.transformListToTransform(h).matrix;h.e*=k;h.f*=k;var n=svgedit.utilities.getBBox(c);if(o==="g"&&!$.data(c,"gsvg"))if(o=a.getStrokedBBox(c.childNodes))n=o;o=n.x;var m=n.y,C=n.width;n=n.height;l*=k;k=svgedit.math.transformBox(o*k,m*k,C*k,n*k,h);h=k.aabox;o=h.x-l;m=h.y-l;C=h.width+l*2;var I=h.height+l*2;h=o+C/2;n=m+I/2;if(c=svgedit.utilities.getRotationAngle(c)){o=a.svgRoot().createSVGTransform();
o.setRotate(-c,h,n);o=o.matrix;k.tl=svgedit.math.transformPoint(k.tl.x,k.tl.y,o);k.tr=svgedit.math.transformPoint(k.tr.x,k.tr.y,o);k.bl=svgedit.math.transformPoint(k.bl.x,k.bl.y,o);k.br=svgedit.math.transformPoint(k.br.x,k.br.y,o);o=k.tl;C=o.x;I=o.y;var H=o.x,G=o.y;o=Math.min;m=Math.max;C=o(C,o(k.tr.x,o(k.bl.x,k.br.x)))-l;I=o(I,o(k.tr.y,o(k.bl.y,k.br.y)))-l;H=m(H,m(k.tr.x,m(k.bl.x,k.br.x)))+l;G=m(G,m(k.tr.y,m(k.bl.y,k.br.y)))+l;o=C;m=I;C=H-C;I=G-I}l=a.svgRoot().suspendRedraw(100);b.setAttribute("d",
"M"+o+","+m+" L"+(o+C)+","+m+" "+(o+C)+","+(m+I)+" "+o+","+(m+I)+"z");this.selectorGroup.setAttribute("transform",c?"rotate("+[c,h,n].join(",")+")":"");if(svgedit.browser.isTouch()){o-=15.75;m-=15.75}else{o-=4;m-=4}this.gripCoords={nw:[o,m].map(Math.round),ne:[o+C,m].map(Math.round),sw:[o,m+I].map(Math.round),se:[o+C,m+I].map(Math.round),n:[o+C/2,m].map(Math.round),w:[o,m+I/2].map(Math.round),e:[o+C,m+I/2].map(Math.round),s:[o+C/2,m+I].map(Math.round)};for(var P in this.gripCoords){b=this.gripCoords[P];
d[P].setAttribute("x",b[0]);d[P].setAttribute("y",b[1])}this.rotateCoords={nw:[o,m],ne:[o+C+8,m],sw:[o,m+I+8],se:[o+C+8,m+I+8]};for(P in this.rotateCoords){b=this.rotateCoords[P];g.rotateGrips[P].setAttribute("cx",b[0]);g.rotateGrips[P].setAttribute("cy",b[1])}a.svgRoot().unsuspendRedraw(l)};svgedit.select.SelectorManager=function(){this.rubberBandBox=this.selectorParentGroup=null;this.selectors=[];this.selectorMap={};this.selectorGrips={nw:null,n:null,ne:null,e:null,se:null,s:null,sw:null,w:null};
this.selectorGripsGroup=null;this.rotateGrips={nw:null,ne:null,se:null,sw:null};this.initGroup()};svgedit.select.SelectorManager.prototype.initGroup=function(){this.selectorParentGroup&&this.selectorParentGroup.parentNode&&this.selectorParentGroup.parentNode.removeChild(this.selectorParentGroup);this.selectorParentGroup=a.createSVGElement({element:"g",attr:{id:"selectorParentGroup"}});this.selectorGripsGroup=a.createSVGElement({element:"g",attr:{display:"none"}});this.selectorParentGroup.appendChild(this.selectorGripsGroup);
a.svgRoot().appendChild(this.selectorParentGroup);this.selectorMap={};this.selectors=[];this.rubberBandBox=null;for(var b in this.rotateGrips){var g=a.createSVGElement({element:"circle",attr:{id:"selectorGrip_rotate_"+b,fill:"#000",r:8,stroke:"#000","fill-opacity":0,"stroke-opacity":0,"stroke-width":0,style:"cursor:url("+f.imgPath+"rotate.png) 12 12, auto;"}});$.data(g,"dir",b);$.data(g,"type","rotate");this.rotateGrips[b]=this.selectorGripsGroup.appendChild(g)}for(b in this.selectorGrips){g=a.createSVGElement({element:"rect",
attr:{id:"selectorGrip_resize_"+b,width:8,height:8,fill:"#4F80FF",stroke:"rgba(0,0,0,0)","stroke-width":1,style:"cursor:"+b+"-resize","pointer-events":"all"}});if(svgedit.browser.isTouch()){g.setAttribute("width",30.5);g.setAttribute("height",30.5);g.setAttribute("fill-opacity",0.3)}$.data(g,"dir",b);$.data(g,"type","resize");this.selectorGrips[b]=this.selectorGripsGroup.appendChild(g)}if(!$("#canvasBackground").length){b=f.dimensions;b=a.createSVGElement({element:"svg",attr:{id:"canvasBackground",
width:b[0],height:b[1],x:0,y:0,overflow:svgedit.browser.isWebkit()?"none":"visible",style:"pointer-events:none"}});g=a.createSVGElement({element:"defs",attr:{id:"placeholder_defs"}});var d=a.createSVGElement({element:"pattern",attr:{id:"checkerPattern",patternUnits:"userSpaceOnUse",x:0,y:0,width:20,height:20,viewBox:"0 0 10 10"}}),c=a.createSVGElement({element:"rect",attr:{x:0,y:0,width:10,height:10,fill:"#fff"}}),h=a.createSVGElement({element:"rect",attr:{x:0,y:0,width:5,height:5,fill:"#eee"}}),
k=a.createSVGElement({element:"rect",attr:{x:5,y:5,width:5,height:5,fill:"#eee"}}),l=a.createSVGElement({element:"rect",attr:{width:"100%",height:"100%",x:0,y:0,"stroke-width":1,stroke:"#000",fill:"url(#checkerPattern)",style:"pointer-events:none"}});b.appendChild(g);g.appendChild(d);d.appendChild(c);d.appendChild(h);d.appendChild(k);b.appendChild(l);a.svgRoot().insertBefore(b,a.svgContent())}};svgedit.select.SelectorManager.prototype.requestSelector=function(b){if(b==null)return null;var g=this.selectors.length;
if(typeof this.selectorMap[b.id]=="object"){this.selectorMap[b.id].locked=true;return this.selectorMap[b.id]}for(var d=0;d<g;++d)if(this.selectors[d]&&!this.selectors[d].locked){this.selectors[d].locked=true;this.selectors[d].reset(b);this.selectorMap[b.id]=this.selectors[d];return this.selectors[d]}this.selectors[g]=new svgedit.select.Selector(g,b);this.selectorParentGroup.appendChild(this.selectors[g].selectorGroup);this.selectorMap[b.id]=this.selectors[g];return this.selectors[g]};svgedit.select.SelectorManager.prototype.releaseSelector=
function(b){if(b!=null)for(var g=this.selectors.length,d=this.selectorMap[b.id],c=0;c<g;++c)if(this.selectors[c]&&this.selectors[c]==d){d.locked==false&&console.log("WARNING! selector was released but was already unlocked");delete this.selectorMap[b.id];d.locked=false;d.selectedElement=null;d.showGrips(false);try{d.selectorGroup.setAttribute("display","none")}catch(h){}break}};svgedit.select.SelectorManager.prototype.getRubberBandBox=function(){if(!this.rubberBandBox)this.rubberBandBox=this.selectorParentGroup.appendChild(a.createSVGElement({element:"rect",
attr:{id:"selectorRubberBand",fill:"none",stroke:"#666","stroke-width":1,"stroke-dasharray":"3,2",display:"none",style:"pointer-events:none"}}));return this.rubberBandBox};svgedit.select.init=function(b,g){f=b;a=g;e=new svgedit.select.SelectorManager;a.createSVGElement({element:"g",attr:{id:"hover_group"}})};svgedit.select.getSelectorManager=function(){return e}})();svgedit=svgedit||{};
(function(){if(!svgedit.draw)svgedit.draw={};var a="a,circle,ellipse,foreignObject,g,image,line,path,polygon,polyline,rect,svg,text,tspan,use".split(","),f={LET_DOCUMENT_DECIDE:0,ALWAYS_RANDOMIZE:1,NEVER_RANDOMIZE:2},e=f.LET_DOCUMENT_DECIDE;svgedit.draw.Layer=function(b,g){this.name_=b;this.group_=g};svgedit.draw.Layer.prototype.getName=function(){return this.name_};svgedit.draw.Layer.prototype.getGroup=function(){return this.group_};svgedit.draw.randomizeIds=function(b,g){e=b==false?f.NEVER_RANDOMIZE:
f.ALWAYS_RANDOMIZE;if(e==f.ALWAYS_RANDOMIZE&&!g.getNonce())g.setNonce(Math.floor(Math.random()*100001));else e==f.NEVER_RANDOMIZE&&g.getNonce()&&g.clearNonce()};svgedit.draw.Drawing=function(b,g){if(!b||!b.tagName||!b.namespaceURI||b.tagName!="svg"||b.namespaceURI!="http://www.w3.org/2000/svg")throw"Error: svgedit.draw.Drawing instance initialized without a <svg> element";this.svgElem_=b;this.obj_num=0;this.idPrefix=g||"svg_";this.releasedNums=[];this.all_layers=[];this.current_layer=null;this.nonce_=
"";var d=this.svgElem_.getAttributeNS("http://svg-edit.googlecode.com","nonce");if(d&&e!=f.NEVER_RANDOMIZE)this.nonce_=d;else e==f.ALWAYS_RANDOMIZE&&this.setNonce(Math.floor(Math.random()*100001))};svgedit.draw.Drawing.prototype.getElem_=function(b){return this.svgElem_.querySelector?this.svgElem_.querySelector("#"+b):$(this.svgElem_).find("[id="+b+"]")[0]};svgedit.draw.Drawing.prototype.getSvgElem=function(){return this.svgElem_};svgedit.draw.Drawing.prototype.getNonce=function(){return this.nonce_};
svgedit.draw.Drawing.prototype.setNonce=function(b){this.svgElem_.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:se","http://svg-edit.googlecode.com");this.svgElem_.setAttributeNS("http://svg-edit.googlecode.com","se:nonce",b);this.nonce_=b};svgedit.draw.Drawing.prototype.clearNonce=function(){this.nonce_=""};svgedit.draw.Drawing.prototype.getId=function(){return this.nonce_?this.idPrefix+this.nonce_+"_"+this.obj_num:this.idPrefix+this.obj_num};svgedit.draw.Drawing.prototype.getNextId=function(){var b=
this.obj_num,g=false;if(this.releasedNums.length>0){this.obj_num=this.releasedNums.pop();g=true}else this.obj_num++;for(var d=this.getId();this.getElem_(d);){if(g){this.obj_num=b;g=false}this.obj_num++;d=this.getId()}if(g)this.obj_num=b;return d};svgedit.draw.Drawing.prototype.releaseId=function(b){var g=this.idPrefix+(this.nonce_?this.nonce_+"_":"");if(typeof b!="string"||b.indexOf(g)!=0)return false;b=parseInt(b.substr(g.length));if(typeof b!="number"||b<=0||this.releasedNums.indexOf(b)!=-1)return false;
this.releasedNums.push(b);return true};svgedit.draw.Drawing.prototype.getNumLayers=function(){return this.all_layers.length};svgedit.draw.Drawing.prototype.hasLayer=function(b){for(var g=0;g<this.getNumLayers();g++)if(this.all_layers[g][0]==b)return true;return false};svgedit.draw.Drawing.prototype.getLayerName=function(b){if(b>=0&&b<this.getNumLayers())return this.all_layers[b][0];return""};svgedit.draw.Drawing.prototype.getCurrentLayer=function(){return this.current_layer};svgedit.draw.Drawing.prototype.getCurrentLayerName=
function(){for(var b=0;b<this.getNumLayers();++b)if(this.all_layers[b][1]==this.current_layer)return this.getLayerName(b);return""};svgedit.draw.Drawing.prototype.setCurrentLayer=function(b){for(var g=0;g<this.getNumLayers();++g)if(b==this.getLayerName(g)){if(this.current_layer!=this.all_layers[g][1]){this.current_layer.setAttribute("style","pointer-events:none");this.current_layer=this.all_layers[g][1];this.current_layer.setAttribute("style","pointer-events:all")}return true}return false};svgedit.draw.Drawing.prototype.deleteCurrentLayer=
function(){if(this.current_layer&&this.getNumLayers()>1){var b=this.current_layer.parentNode.removeChild(this.current_layer);this.identifyLayers();return b}return null};svgedit.draw.Drawing.prototype.identifyLayers=function(){this.all_layers=[];for(var b=this.svgElem_.childNodes.length,g=[],d=[],c=null,h=false,k=0;k<b;++k){var l=this.svgElem_.childNodes.item(k);if(l&&l.nodeType==1)if(l.tagName=="g"){h=true;var o=$("title",l).text();if(!o&&svgedit.browser.isOpera()&&l.querySelectorAll)o=$(l.querySelectorAll("title")).text();
if(o){d.push(o);this.all_layers.push([o,l]);c=l;svgedit.utilities.walkTree(l,function(n){n.setAttribute("style","pointer-events:inherit")});c.setAttribute("style","pointer-events:none")}else g.push(l)}else if(~a.indexOf(l.nodeName)){svgedit.utilities.getBBox(l);g.push(l)}}b=this.svgElem_.ownerDocument;if(g.length>0||!h){for(k=1;d.indexOf("Layer "+k)>=0;)k++;d="Layer "+k;c=b.createElementNS("http://www.w3.org/2000/svg","g");h=b.createElementNS("http://www.w3.org/2000/svg","title");h.textContent=d;
c.appendChild(h);for(h=0;h<g.length;++h)c.appendChild(g[h]);this.svgElem_.appendChild(c);this.all_layers.push([d,c])}svgedit.utilities.walkTree(c,function(n){n.setAttribute("style","pointer-events:inherit")});this.current_layer=c.getAttribute("data-locked")==="true"?this.all_layers.slice(-2)[0][1]:c;this.current_layer.setAttribute("style","pointer-events:all")};svgedit.draw.Drawing.prototype.createLayer=function(b){var g=this.svgElem_.ownerDocument,d=g.createElementNS("http://www.w3.org/2000/svg",
"g");g=g.createElementNS("http://www.w3.org/2000/svg","title");g.textContent=b;d.appendChild(g);this.svgElem_.appendChild(d);this.identifyLayers();return d};svgedit.draw.Drawing.prototype.getLayerVisibility=function(b){for(var g=null,d=0;d<this.getNumLayers();++d)if(this.getLayerName(d)==b){g=this.all_layers[d][1];break}if(!g)return false;return g.getAttribute("display")!="none"};svgedit.draw.Drawing.prototype.setLayerVisibility=function(b,g){if(typeof g!="boolean")return null;for(var d=null,c=0;c<
this.getNumLayers();++c)if(this.getLayerName(c)==b){d=this.all_layers[c][1];break}if(!d)return null;d.getAttribute("display");d.setAttribute("display",g?"inline":"none");return d};svgedit.draw.Drawing.prototype.getLayerOpacity=function(b){for(var g=0;g<this.getNumLayers();++g)if(this.getLayerName(g)==b){(b=this.all_layers[g][1].getAttribute("opacity"))||(b="1.0");return parseFloat(b)}return null};svgedit.draw.Drawing.prototype.setLayerOpacity=function(b,g){if(!(typeof g!="number"||g<0||g>1))for(var d=
0;d<this.getNumLayers();++d)if(this.getLayerName(d)==b){this.all_layers[d][1].setAttribute("opacity",g);break}}})();svgedit=svgedit||{};
(function(){if(!svgedit.path)svgedit.path={};var a={pathNodeTooltip:"Drag node to move it. Double-click node to change segment type",pathCtrlPtTooltip:"Drag control point to adjust curve properties"},f={2:["x","y"],4:["x","y"],6:["x","y","x1","y1","x2","y2"],8:["x","y","x1","y1"],10:["x","y","r1","r2","angle","largeArcFlag","sweepFlag"],12:["x"],14:["y"],16:["x","y","x2","y2"],18:["x","y"]},e=[],b=false,g={};svgedit.path.setLinkControlPoints=function(h){b=h};var d=svgedit.path.path=null;svgedit.path.init=
function(h){d=h;e=[0,"ClosePath"];$.each(["Moveto","Lineto","CurvetoCubic","CurvetoQuadratic","Arc","LinetoHorizontal","LinetoVertical","CurvetoCubicSmooth","CurvetoQuadraticSmooth"],function(k,l){e.push(l+"Abs");e.push(l+"Rel")})};svgedit.path.insertItemBefore=function(h,k,l){h=h.pathSegList;if(svgedit.browser.supportsPathInsertItemBefore())h.insertItemBefore(k,l);else{for(var o=h.numberOfItems,n=[],m=0;m<o;m++){var C=h.getItem(m);n.push(C)}h.clear();for(m=0;m<o;m++){m==l&&h.appendItem(k);h.appendItem(n[m])}}};
svgedit.path.ptObjToArr=function(h,k){for(var l=f[h],o=l.length,n=Array(o),m=0;m<o;m++)n[m]=k[l[m]];return n};svgedit.path.getGripPt=function(h,k){var l={x:k?k.x:h.item.x,y:k?k.y:h.item.y},o=h.path;if(o.matrix)l=svgedit.math.transformPoint(l.x,l.y,o.matrix);l.x*=d.getCurrentZoom();l.y*=d.getCurrentZoom();return l};svgedit.path.getPointFromGrip=function(h,k){var l={x:h.x,y:h.y};if(k.matrix){h=svgedit.math.transformPoint(l.x,l.y,k.imatrix);l.x=h.x;l.y=h.y}l.x/=d.getCurrentZoom();l.y/=d.getCurrentZoom();
return l};svgedit.path.addPointGrip=function(h,k,l){var o=svgedit.path.getGripContainer(),n=svgedit.utilities.getElem("pathpointgrip_"+h);if(!n){n=document.createElementNS("http://www.w3.org/2000/svg","rect");svgedit.utilities.assignAttributes(n,{id:"pathpointgrip_"+h,display:"none",width:svgedit.browser.isTouch()?30:5,height:svgedit.browser.isTouch()?30:5,fill:"#fff",stroke:"#4F80FF","shape-rendering":"crispEdges","stroke-width":1,cursor:"move",style:"pointer-events:all","xlink:title":a.pathNodeTooltip});
n=o.appendChild(n);$("#pathpointgrip_"+h).dblclick(function(){svgedit.path.path&&svgedit.path.path.setSegType()})}if(k&&l)svgedit.utilities.assignAttributes(n,{x:k-(svgedit.browser.isTouch()?15:2.5),y:l-(svgedit.browser.isTouch()?15:2.5),display:"inline"});return n};svgedit.path.getGripContainer=function(){var h=svgedit.utilities.getElem("pathpointgrip_container");if(!h){h=svgedit.utilities.getElem("selectorParentGroup").appendChild(document.createElementNS("http://www.w3.org/2000/svg","g"));h.id=
"pathpointgrip_container"}return h};svgedit.path.addCtrlGrip=function(h){var k=svgedit.utilities.getElem("ctrlpointgrip_"+h);if(k)return k;k=document.createElementNS("http://www.w3.org/2000/svg","circle");svgedit.utilities.assignAttributes(k,{id:"ctrlpointgrip_"+h,display:"none",r:svgedit.browser.isTouch()?15:3,fill:"#4F80FF",stroke:"#4F80FF","stroke-opacity":0,"stroke-width":"3",cursor:"move",style:"pointer-events:all","xlink:title":a.pathCtrlPtTooltip});svgedit.path.getGripContainer().appendChild(k);
return k};svgedit.path.getCtrlLine=function(h){var k=svgedit.utilities.getElem("ctrlLine_"+h);if(k)return k;k=document.createElementNS("http://www.w3.org/2000/svg","line");svgedit.utilities.assignAttributes(k,{id:"ctrlLine_"+h,stroke:"#4F80FF","stroke-width":1,style:"pointer-events:none"});svgedit.path.getGripContainer().appendChild(k);return k};svgedit.path.getPointGrip=function(h,k){var l=svgedit.path.addPointGrip(h.index);if(k){var o=svgedit.path.getGripPt(h);svgedit.utilities.assignAttributes(l,
{x:o.x-(svgedit.browser.isTouch()?15:2.5),y:o.y-(svgedit.browser.isTouch()?15:2.5),display:"inline"})}return l};svgedit.path.getControlPoints=function(h){var k=h.item,l=h.index;if(!k||!("x1"in k)||!("x2"in k))return null;var o={};svgedit.path.getGripContainer();for(var n=[svgedit.path.path.segs[l-1].item,k],m=1;m<3;m++){var C=l+"c"+m,I=o["c"+m+"_line"]=svgedit.path.getCtrlLine(C),H=svgedit.path.getGripPt(h,{x:k["x"+m],y:k["y"+m]}),G=svgedit.path.getGripPt(h,{x:n[m-1].x,y:n[m-1].y});svgedit.utilities.assignAttributes(I,
{x1:H.x,y1:H.y,x2:G.x,y2:G.y,display:"inline"});o["c"+m+"_line"]=I;pointGrip=o["c"+m]=svgedit.path.addCtrlGrip(C);svgedit.utilities.assignAttributes(pointGrip,{cx:H.x,cy:H.y,display:"inline"});o["c"+m]=pointGrip}return o};svgedit.path.replacePathSeg=function(h,k,l,o){o=o||svgedit.path.path.elem;h=o["createSVGPathSeg"+e[h]].apply(o,l);if(svgedit.browser.supportsPathReplaceItem())o.pathSegList.replaceItem(h,k);else{l=o.pathSegList;o=l.numberOfItems;for(var n=[],m=0;m<o;m++){var C=l.getItem(m);n.push(C)}l.clear();
for(m=0;m<o;m++)m==k?l.appendItem(h):l.appendItem(n[m])}};svgedit.path.getSegSelector=function(h,k){var l=h.index,o=svgedit.utilities.getElem("segline_"+l);if(!o){var n=svgedit.path.getGripContainer();o=document.createElementNS("http://www.w3.org/2000/svg","path");svgedit.utilities.assignAttributes(o,{id:"segline_"+l,display:"none",fill:"none",stroke:"#0ff","stroke-opacity":1,"shape-rendering":"crispEdges","stroke-width":2,style:"pointer-events:none",d:"M0,0 0,0"});n.appendChild(o)}if(k){l=h.prev;
if(!l){o.setAttribute("display","none");return o}l=svgedit.path.getGripPt(l);svgedit.path.replacePathSeg(2,0,[l.x,l.y],o);n=svgedit.path.ptObjToArr(h.type,h.item,true);for(var m=0;m<n.length;m+=2){l=svgedit.path.getGripPt(h,{x:n[m],y:n[m+1]});n[m]=l.x;n[m+1]=l.y}svgedit.path.replacePathSeg(h.type,1,n,o)}return o};svgedit.path.smoothControlPoints=this.smoothControlPoints=function(h,k,l){var o=h.x-l.x,n=h.y-l.y,m=k.x-l.x,C=k.y-l.y;if((o!=0||n!=0)&&(m!=0||C!=0)){h=Math.atan2(n,o);k=Math.atan2(C,m);o=
Math.sqrt(o*o+n*n);m=Math.sqrt(m*m+C*C);n=d.getSVGRoot().createSVGPoint();C=d.getSVGRoot().createSVGPoint();if(h<0)h+=2*Math.PI;if(k<0)k+=2*Math.PI;var I=Math.abs(h-k),H=Math.abs(Math.PI-I)/2;if(h-k>0){h=I<Math.PI?h+H:h-H;k=I<Math.PI?k-H:k+H}else{h=I<Math.PI?h-H:h+H;k=I<Math.PI?k+H:k-H}n.x=o*Math.cos(h)+l.x;n.y=o*Math.sin(h)+l.y;C.x=m*Math.cos(k)+l.x;C.y=m*Math.sin(k)+l.y;return[n,C]}};svgedit.path.Segment=function(h,k){this.selected=false;this.index=h;this.item=k;this.type=k.pathSegType;this.ctrlpts=
[];this.segsel=this.ptgrip=null};svgedit.path.Segment.prototype.showCtrlPts=function(h){for(var k in this.ctrlpts)this.ctrlpts[k].setAttribute("display",h?"inline":"none")};svgedit.path.Segment.prototype.selectCtrls=function(){$("#ctrlpointgrip_"+this.index+"c1, #ctrlpointgrip_"+this.index+"c2").attr("fill","#4F80FF")};svgedit.path.Segment.prototype.show=function(h){if(this.ptgrip){this.ptgrip.setAttribute("display",h?"inline":"none");this.segsel.setAttribute("display",h?"inline":"none");this.showCtrlPts(h)}};
svgedit.path.Segment.prototype.select=function(h){if(this.ptgrip){this.ptgrip.setAttribute("stroke",h?"#4F80FF":"#4F80FF");this.ptgrip.setAttribute("fill",h?"#4F80FF":"#fff");this.segsel.setAttribute("display",h?"inline":"none");this.ctrlpts&&this.selectCtrls(h);this.selected=h}};svgedit.path.Segment.prototype.addGrip=function(){this.ptgrip=svgedit.path.getPointGrip(this,true);this.ctrlpts=svgedit.path.getControlPoints(this,true);this.segsel=svgedit.path.getSegSelector(this,true)};svgedit.path.Segment.prototype.update=
function(h){if(this.ptgrip){var k=svgedit.path.getGripPt(this),l=svgedit.browser.isTouch()?15:2.5;svgedit.utilities.assignAttributes(this.ptgrip,this.ptgrip.nodeName=="rect"?{x:k.x-l,y:k.y-l}:{cx:k.x,cy:k.y});svgedit.path.getSegSelector(this,true);if(this.ctrlpts){if(h){this.item=svgedit.path.path.elem.pathSegList.getItem(this.index);this.type=this.item.pathSegType}svgedit.path.getControlPoints(this)}}};svgedit.path.Segment.prototype.move=function(h,k){var l=this.item;l=$.extend({},l);l=this.ctrlpts?
[l.x+=h,l.y+=k,l.x1,l.y1,l.x2+=h,l.y2+=k]:[l.x+=h,l.y+=k];svgedit.path.replacePathSeg(this.type,this.index,l);if(this.next&&this.next.ctrlpts){l=this.next.item;l=[l.x,l.y,l.x1+=h,l.y1+=k,l.x2,l.y2];svgedit.path.replacePathSeg(this.next.type,this.next.index,l)}if(this.mate){l=this.mate.item;l=[l.x+=h,l.y+=k];svgedit.path.replacePathSeg(this.mate.type,this.mate.index,l)}this.update(true);this.next&&this.next.update(true)};svgedit.path.Segment.prototype.setLinked=function(h){var k,l,o;if(h==2){l=1;k=
this.next;if(!k)return;o=this.item}else{l=2;k=this.prev;if(!k)return;o=k.item}var n=$.extend({},k.item);n["x"+l]=o.x+(o.x-this.item["x"+h]);n["y"+l]=o.y+(o.y-this.item["y"+h]);svgedit.path.replacePathSeg(k.type,k.index,[n.x,n.y,n.x1,n.y1,n.x2,n.y2]);k.update(true)};svgedit.path.Segment.prototype.moveCtrl=function(h,k,l){var o=$.extend({},this.item);o["x"+h]+=k;o["y"+h]+=l;svgedit.path.replacePathSeg(this.type,this.index,[o.x,o.y,o.x1,o.y1,o.x2,o.y2]);this.update(true)};svgedit.path.Segment.prototype.setType=
function(h,k){svgedit.path.replacePathSeg(h,this.index,k);this.type=h;this.item=svgedit.path.path.elem.pathSegList.getItem(this.index);this.showCtrlPts(h===6);this.ctrlpts=svgedit.path.getControlPoints(this);this.update(true)};svgedit.path.Path=function(h){if(!h||h.tagName!=="path")throw"svgedit.path.Path constructed without a <path> element";this.elem=h;this.segs=[];this.selected_pts=[];svgedit.path.path=this;this.init()};svgedit.path.Path.prototype.init=function(){$(svgedit.path.getGripContainer()).find("*").attr("display",
"none");var h=this.elem.pathSegList,k=h.numberOfItems;this.segs=[];this.selected_pts=[];this.first_seg=null;for(var l=0;l<k;l++){var o=h.getItem(l);o=new svgedit.path.Segment(l,o);o.path=this;this.segs.push(o)}h=this.segs;o=null;for(l=0;l<k;l++){var n=h[l],m=l+1>=k?null:h[l+1],C=l-1<0?null:h[l-1];if(n.type===2){if(C&&C.type!==1){m=h[o];m.next=h[o+1];m.next.prev=m;m.addGrip()}o=l}else if(m&&m.type===1){n.next=h[o+1];n.next.prev=n;n.mate=h[o];n.addGrip();if(this.first_seg==null)this.first_seg=n}else if(m){if(n.type!==
1){n.addGrip();if(m&&m.type!==2){n.next=m;n.next.prev=n}}}else if(n.type!==1){m=h[o];m.next=h[o+1];m.next.prev=m;m.addGrip();n.addGrip();if(!this.first_seg)this.first_seg=h[o]}}return this};svgedit.path.Path.prototype.eachSeg=function(h){for(var k=this.segs.length,l=0;l<k;l++)if(h.call(this.segs[l],l)===false)break};svgedit.path.Path.prototype.addSeg=function(h){var k=this.segs[h];if(k.prev){var l=k.prev,o;switch(k.item.pathSegType){case 4:var n=(k.item.x+l.item.x)/2,m=(k.item.y+l.item.y)/2;o=this.elem.createSVGPathSegLinetoAbs(n,
m);break;case 6:o=(l.item.x+k.item.x1)/2;var C=(k.item.x1+k.item.x2)/2,I=(k.item.x2+k.item.x)/2,H=(o+C)/2;C=(C+I)/2;n=(H+C)/2;var G=(l.item.y+k.item.y1)/2,P=(k.item.y1+k.item.y2)/2;l=(k.item.y2+k.item.y)/2;var Q=(G+P)/2;P=(P+l)/2;m=(Q+P)/2;o=this.elem.createSVGPathSegCurvetoCubicAbs(n,m,o,G,H,Q);svgedit.path.replacePathSeg(k.type,h,[k.item.x,k.item.y,C,P,I,l])}svgedit.path.insertItemBefore(this.elem,o,h)}};svgedit.path.Path.prototype.deleteSeg=function(h){var k=this.segs[h],l=this.elem.pathSegList;
k.show(false);var o=k.next;if(k.mate){var n=[o.item.x,o.item.y];svgedit.path.replacePathSeg(2,o.index,n);svgedit.path.replacePathSeg(4,k.index,n);l.removeItem(k.mate.index)}else{if(!k.prev){n=[o.item.x,o.item.y];svgedit.path.replacePathSeg(2,k.next.index,n)}l.removeItem(h)}};svgedit.path.Path.prototype.subpathIsClosed=function(h){var k=false;svgedit.path.path.eachSeg(function(l){if(l<=h)return true;if(this.type===2)return false;else if(this.type===1){k=true;return false}});return k};svgedit.path.Path.prototype.removePtFromSelection=
function(h){var k=this.selected_pts.indexOf(h);if(k!=-1){this.segs[h].select(false);this.selected_pts.splice(k,1)}};svgedit.path.Path.prototype.clearSelection=function(){this.eachSeg(function(){this.select(false)});this.selected_pts=[]};svgedit.path.Path.prototype.storeD=function(){this.last_d=this.elem.getAttribute("d")};svgedit.path.Path.prototype.show=function(h){this.eachSeg(function(){this.show(h)});h&&this.selectPt(this.first_seg.index);return this};svgedit.path.Path.prototype.movePts=function(h,
k){for(var l=this.selected_pts.length;l--;)this.segs[this.selected_pts[l]].move(h,k)};svgedit.path.Path.prototype.moveCtrl=function(h,k){var l=this.segs[this.selected_pts[0]];l.moveCtrl(this.dragctrl,h,k);b&&l.setLinked(this.dragctrl)};svgedit.path.Path.prototype.setSegType=function(h){this.storeD();for(var k=this.selected_pts.length,l;k--;){var o=this.segs[this.selected_pts[k]],n=o.prev;if(n){if(!h){l="Toggle Path Segment Type";h=o.type==6?4:6}h-=0;var m=o.item.x,C=o.item.y,I=n.item.x;n=n.item.y;
var H;switch(h){case 6:if(o.olditem){I=o.olditem;H=[m,C,I.x1,I.y1,I.x2,I.y2]}else{H=m-I;var G=C-n;H=[m,C,I+H/3,n+G/3,m-H/3,C-G/3]}break;case 4:H=[m,C];o.olditem=o.item}o.setType(h,H)}}svgedit.path.path.endChanges(l)};svgedit.path.Path.prototype.selectPt=function(h,k){this.clearSelection();h==null&&this.eachSeg(function(l){if(this.prev)h=l});this.addPtsToSelection(h);if(k){this.dragctrl=k;b&&this.segs[h].setLinked(k)}};svgedit.path.Path.prototype.update=function(){var h=this.elem;if(svgedit.utilities.getRotationAngle(h)){this.matrix=
svgedit.math.getMatrix(h);this.imatrix=this.matrix.inverse()}else this.imatrix=this.matrix=null;this.eachSeg(function(k){this.item=h.pathSegList.getItem(k);this.update()});return this};svgedit.path.getPath_=function(h){var k=g[h.id];k||(k=g[h.id]=new svgedit.path.Path(h));return k};svgedit.path.removePath_=function(h){h in g&&delete g[h]};var c=function(h,k,l,o,n,m,C){dx=h-l;dy=k-o;r=Math.sqrt(dx*dx+dy*dy);theta=Math.atan2(dy,dx)+C;dx=r*Math.cos(theta)+l;dy=r*Math.sin(theta)+o;dx-=n;dy-=m;r=Math.sqrt(dx*
dx+dy*dy);theta=Math.atan2(dy,dx)-C;return{x:(r*Math.cos(theta)+n)/1,y:(r*Math.sin(theta)+m)/1}};svgedit.path.recalcRotatedPath=function(){var h=svgedit.path.path.elem,k=svgedit.utilities.getRotationAngle(h,true);if(k){var l=svgedit.utilities.getBBox(h),o=svgedit.path.path.oldbbox,n=o.x+o.width/2;o=o.y+o.height/2;var m=l.x+l.width/2;l=l.y+l.height/2;m=m-n;var C=l-o;l=Math.sqrt(m*m+C*C);C=Math.atan2(C,m)+k;m=l*Math.cos(C)+n;l=l*Math.sin(C)+o;C=h.pathSegList;for(var I=C.numberOfItems;I;){I-=1;var H=
C.getItem(I),G=H.pathSegType;if(G!=1){var P=c(H.x,H.y,n,o,m,l,k);P=[P.x,P.y];if(H.x1!=null&&H.x2!=null){c_vals1=c(H.x1,H.y1,n,o,m,l,k);c_vals2=c(H.x2,H.y2,n,o,m,l,k);P.splice(P.length,0,c_vals1.x,c_vals1.y,c_vals2.x,c_vals2.y)}svgedit.path.replacePathSeg(G,I,P)}}svgedit.utilities.getBBox(h);n=svgroot.createSVGTransform();h=svgedit.transformlist.getTransformList(h);n.setRotate(k*180/Math.PI,m,l);h.replaceItem(n,0)}};svgedit.path.clearData=function(){g={}}})();if(!window.console){window.console={};window.console.log=function(){};window.console.dir=function(){}}if(window.opera){window.console.log=function(a){opera.postError(a)};window.console.dir=function(){}}
(function(){var a=jQuery.fn.attr;jQuery.fn.attr=function(f,e){var b=this.length;if(!b)return a.apply(this,arguments);for(var g=0;g<b;g++){var d=this[g];if(d.namespaceURI==="http://www.w3.org/2000/svg")if(e!==undefined)d.setAttribute(f,e);else if($.isArray(f)){b=f.length;for(g={};b--;){var c=f[b],h=d.getAttribute(c);if(h||h==="0")h=isNaN(h)?h:h-0;g[c]=h}return g}else if(typeof f==="object")for(c in f)d.setAttribute(c,f[c]);else{if((h=d.getAttribute(f))||h==="0")h=isNaN(h)?h:h-0;return h}else return a.apply(this,
arguments)}return this}})();
$.SvgCanvas=function(a,f){function e(p,s){for(var u=svgedit.utilities.getBBox(p),D=0;D<2;D++){var B=D===0?"fill":"stroke",K=p.getAttribute(B);if(K&&K.indexOf("url(")===0){K=S(K);if(K.tagName==="linearGradient"){var E=K.getAttribute("x1")||0,A=K.getAttribute("y1")||0,J=K.getAttribute("x2")||1,q=K.getAttribute("y2")||0;E=u.width*E+u.x;A=u.height*A+u.y;J=u.width*J+u.x;q=u.height*q+u.y;E=N(E,A,s);q=N(J,q,s);J={};J.x1=(E.x-u.x)/u.width;J.y1=(E.y-u.y)/u.height;J.x2=(q.x-u.x)/u.width;J.y2=(q.y-u.y)/u.height;
K=K.cloneNode(true);$(K).attr(J);K.id=ma();gb().appendChild(K);p.setAttribute(B,"url(#"+K.id+")")}}}}var b="http://www.w3.org/2000/svg",g={show_outside_canvas:true,selectNew:true,dimensions:[640,480]};f&&$.extend(g,f);var d=g.dimensions,c=this,h=a.ownerDocument,k=h.importNode(svgedit.utilities.text2xml('<svg id="svgroot" xmlns="'+b+'" xlinkns="http://www.w3.org/1999/xlink" width="'+d[0]+'" height="'+d[1]+'" x="'+d[0]+'" y="'+d[1]+'" overflow="visible"><defs><filter id="canvashadow" filterUnits="objectBoundingBox"><feGaussianBlur in="SourceAlpha" stdDeviation="4" result="blur"/><feOffset in="blur" dx="5" dy="5" result="offsetBlur"/><feMerge><feMergeNode in="offsetBlur"/><feMergeNode in="SourceGraphic"/></feMerge></filter></defs></svg>').documentElement,
true);a.appendChild(k);var l=h.createElementNS(b,"svg");(c.clearSvgContentElement=function(){for(;l.firstChild;)l.removeChild(l.firstChild);$(l).attr({id:"svgcontent",width:d[0],height:d[1],x:d[0],y:d[1],overflow:g.show_outside_canvas?"visible":"hidden",xmlns:b,"xmlns:se":"http://svg-edit.googlecode.com","xmlns:xlink":"http://www.w3.org/1999/xlink"}).appendTo(k);var p=h.createComment(" Created with Method Draw - http://github.com/duopixel/Method-Draw/ ");l.appendChild(p)})();var o="svg_";c.setIdPrefix=
function(p){o=p};c.current_drawing_=new svgedit.draw.Drawing(l,o);var n=c.getCurrentDrawing=function(){return c.current_drawing_},m=1,C=null,I={shape:{fill:(g.initFill.color=="none"?"":"#")+g.initFill.color,fill_paint:null,fill_opacity:g.initFill.opacity,stroke:"#"+g.initStroke.color,stroke_paint:null,stroke_opacity:g.initStroke.opacity,stroke_width:g.initStroke.width,stroke_dasharray:"none",opacity:g.initOpacity}};I.text=$.extend(true,{},I.shape);$.extend(I.text,{fill:"#000000",stroke_width:0,font_size:24,
font_family:"Helvetica, Arial, sans-serif"});var H=I.shape,G=Array(1),P=this.addSvgElementFromJson=function(p){var s=svgedit.utilities.getElem(p.attr.id),u=n().getCurrentLayer();if(s&&p.element!=s.tagName){u.removeChild(s);s=null}if(!s){s=h.createElementNS(b,p.element);if(u)(C||u).appendChild(s)}p.curStyles&&svgedit.utilities.assignAttributes(s,{fill:H.fill,stroke:H.stroke,"stroke-width":H.stroke_width,"stroke-dasharray":H.stroke_dasharray,"stroke-opacity":H.stroke_opacity,"fill-opacity":H.fill_opacity,
opacity:H.opacity/2,style:"pointer-events:inherit"},100);svgedit.utilities.assignAttributes(s,p.attr,100);svgedit.utilities.cleanupElement(s);return s},Q=c.getTransformList=svgedit.transformlist.getTransformList,N=svgedit.math.transformPoint,ba=c.matrixMultiply=svgedit.math.matrixMultiply,ja=c.hasMatrixTransform=svgedit.math.hasMatrixTransform,V=c.transformListToTransform=svgedit.math.transformListToTransform,T=svgedit.math.snapToAngle,aa=svgedit.math.getMatrix;svgedit.units.init({getBaseUnit:function(){return g.baseUnit},
getElement:svgedit.utilities.getElem,getHeight:function(){return l.getAttribute("height")/m},getWidth:function(){return l.getAttribute("width")/m},getRoundDigits:function(){return $a.round_digits}});var sa=c.convertToNum=svgedit.units.convertToNum;svgedit.utilities.init({getDOMDocument:function(){return h},getDOMContainer:function(){return a},getSVGRoot:function(){return k},getSelectedElements:function(){return G},getSVGContent:function(){return l}});var ka=c.getUrlFromAttr=svgedit.utilities.getUrlFromAttr,
ea=c.getHref=svgedit.utilities.getHref,U=c.setHref=svgedit.utilities.setHref,Y=svgedit.utilities.getPathBBox;c.getBBox=svgedit.utilities.getBBox;var oa=c.getRotationAngle=svgedit.utilities.getRotationAngle,pa=c.getElem=svgedit.utilities.getElem,na=c.assignAttributes=svgedit.utilities.assignAttributes,ia=this.cleanupElement=svgedit.utilities.cleanupElement,ta=svgedit.sanitize.getNSMap(),wa=c.sanitizeSvg=svgedit.sanitize.sanitizeSvg,ra=svgedit.history.MoveElementCommand,Ha=svgedit.history.InsertElementCommand,
Da=svgedit.history.RemoveElementCommand,Ka=svgedit.history.ChangeElementCommand,Aa=svgedit.history.BatchCommand;c.undoMgr=new svgedit.history.UndoManager({handleHistoryEvent:function(p,s){var u=svgedit.history.HistoryEventTypes;if(p==u.BEFORE_UNAPPLY||p==u.BEFORE_APPLY)c.clearSelection();else if(p==u.AFTER_APPLY||p==u.AFTER_UNAPPLY){var D=s.elements();c.pathActions.clear();O("changed",D);D=s.type();u=p==u.AFTER_APPLY;if(D==ra.type())(u?s.newParent:s.oldParent)==l&&c.identifyLayers();else if(D==Ha.type()||
D==Da.type()){s.parent==l&&c.identifyLayers();if(D==Ha.type())u&&Ta(s.elem);else u||Ta(s.elem);s.elem.tagName==="use"&&Gb(s.elem)}else if(D==Ka.type()){s.elem.tagName=="title"&&s.elem.parentNode.parentNode==l&&c.identifyLayers();u=u?s.newValues:s.oldValues;u.stdDeviation&&c.setBlurOffsets(s.elem.parentNode,u.stdDeviation)}}}});var xa=function(p){c.undoMgr.addCommandToHistory(p)};svgedit.select.init(g,{createSVGElement:function(p){return c.addSvgElementFromJson(p)},svgRoot:function(){return k},svgContent:function(){return l},
currentZoom:function(){return m},getStrokedBBox:function(p){return c.getStrokedBBox([p])}});var ua=this.selectorManager=svgedit.select.getSelectorManager();svgedit.path.init({getCurrentZoom:function(){return m},getSVGRoot:function(){return k}});svgedit.utilities.snapToGrid=function(p){var s=g.snappingStep,u=g.baseUnit;if(u!=="px")s*=svgedit.units.getTypeMap()[u];return p=Math.round(p/s)*s};var Ba=svgedit.utilities.snapToGrid,kb={exportNoBlur:"Blurred elements will appear as un-blurred",exportNoforeignObject:"foreignObject elements will not appear",
exportNoDashArray:"Strokes will appear filled",exportNoText:"Text may not appear as expected"},vb=["clip-path","fill","filter","marker-end","marker-mid","marker-start","mask","stroke"],cb=$.data,Ta=function(p){var s=$(p).attr(vb),u;for(u in s){var D=s[u];if(D&&D.indexOf("url(")===0){D=ka(D).substr(1);if(!pa(D)){gb().appendChild(sb[D]);delete sb[D]}}}p=p.getElementsByTagName("*");if(p.length){s=0;for(u=p.length;s<u;s++)Ta(p[s])}},Va={},Ia=g.imgPath+"logo.png",ya=[],$a={round_digits:5},La=false,Sa=
null,Ja="select",db="none",lb={},Ua=I.text,Xa=H,wb=null,va=null,hb=[],eb={},sb={};c.clipBoard=[];var ib=this.runExtensions=function(p,s,u){var D=false;if(u)D=[];$.each(eb,function(B,K){if(p in K)if(u)D.push(K[p](s));else D=K[p](s)});return D};this.addExtension=function(p,s){if(p in eb)console.log('Cannot add extension "'+p+'", an extension by that name already exists"');else{var u=$.isFunction(s)?s($.extend(c.getPrivateMethods(),{svgroot:k,svgcontent:l,nonce:n().getNonce(),selectorManager:ua})):s;
eb[p]=u;O("extension_added",u)}};var ab=this.round=function(p){return parseInt(p*m)/m},ob=this.getIntersectionList=function(p){if(va==null)return null;var s=C||n().getCurrentLayer();hb.length||(hb=fb(s));var u=null;try{u=s.getIntersectionList(p,null)}catch(D){}if(u==null||typeof u.item!="function"){u=[];if(p)p=p;else{p=va.getBBox();s={};for(var B in p)s[B]=p[B]/m;p=s}for(B=hb.length;B--;)p.width&&p.width&&svgedit.math.rectsIntersect(p,hb[B].bbox)&&u.push(hb[B].elem)}return u};getStrokedBBox=this.getStrokedBBox=
function(p){p||(p=pb());if(!p.length)return false;var s=function(q){try{var v=svgedit.utilities.getBBox(q),w=svgedit.utilities.getRotationAngle(q);if(w&&w%90||svgedit.math.hasMatrixTransform(svgedit.transformlist.getTransformList(q))){w=false;if(["ellipse","path","line","polyline","polygon"].indexOf(q.tagName)>=0)v=w=c.convertToPath(q,true);else if(q.tagName=="rect"){var z=q.getAttribute("rx"),F=q.getAttribute("ry");if(z||F)v=w=c.convertToPath(q,true)}if(!w){var L=q.cloneNode(true),M=document.createElementNS(b,
"g"),R=q.parentNode;R.appendChild(M);M.appendChild(L);v=svgedit.utilities.bboxToObj(M.getBBox());R.removeChild(M)}}return v}catch(Z){console.log(q,Z)}},u;$.each(p,function(){if(!u)if(this.parentNode)u=s(this)});if(u==null)return null;var D=u.x+u.width,B=u.y+u.height,K=u.x,E=u.y,A=function(q){var v=q.getAttribute("stroke-width"),w=0;if(q.getAttribute("stroke")!="none"&&!isNaN(v))w+=v/2;return w},J=[];$.each(p,function(q,v){var w=s(v);if(w){var z=A(v);K=Math.min(K,w.x-z);E=Math.min(E,w.y-z);J.push(w)}});
u.x=K;u.y=E;$.each(p,function(q,v){var w=J[q];if(w&&v.nodeType==1){var z=A(v);D=Math.max(D,w.x+w.width+z);B=Math.max(B,w.y+w.height+z)}});u.width=D-K;u.height=B-E;return u};var pb=this.getVisibleElements=function(p){p||(p=$(l).children());p.find("#canvas_background").length&&p.splice(0,1);var s=[];$(p).children().each(function(u,D){try{D.getBBox()&&s.push(D)}catch(B){}});return s.reverse()},fb=this.getVisibleElementsAndBBoxes=function(p){p||(p=$(l).children());var s=[];$(p).children().each(function(u,
D){try{D.getBBox()&&s.push({elem:D,bbox:getStrokedBBox([D])})}catch(B){}});return s.reverse()},tb=this.groupSvgElem=function(p){var s=document.createElementNS(b,"g");p.parentNode.replaceChild(s,p);$(s).append(p).data("gsvg",p)[0].id=ma()},la=function(p){var s=document.createElementNS(p.namespaceURI,p.nodeName);s.removeAttribute("id");$.each(p.attributes,function(D,B){B.localName!="-moz-math-font-style"&&s.setAttributeNS(B.namespaceURI,B.nodeName,B.nodeValue)});if(svgedit.browser.isWebkit()&&p.nodeName==
"path"){var u=Ma.convertPath(p);s.setAttribute("d",u)}$.each(p.childNodes,function(D,B){switch(B.nodeType){case 1:s.appendChild(la(B));break;case 3:s.textContent=B.nodeValue}});if($(p).data("gsvg"))$(s).data("gsvg",s.firstChild);else if($(p).data("symbol")){p=$(p).data("symbol");$(s).data("ref",p).data("symbol",p)}else s.tagName=="image"&&Fb(s);s.id=ma();return s},ca,ma,O;(function(p){var s={};ca=p.getId=function(){return n().getId()};ma=p.getNextId=function(){return n().getNextId()};O=p.call=function(u,
D){if(s[u])return s[u](this,D)};p.bind=function(u,D){var B=s[u];s[u]=D;return B}})(c);this.prepareSvg=function(p){this.sanitizeSvg(p.documentElement);p=p.getElementsByTagNameNS(b,"path");for(var s=0,u=p.length;s<u;++s){var D=p[s];D.setAttribute("d",Ma.convertPath(D));Ma.fixEnd(D)}};var S=this.getRefElem=function(p){return pa(ka(p).substr(1))},fa=function(p){if(!svgedit.browser.isGecko())return p;var s=p.cloneNode(true);p.parentNode.insertBefore(s,p);p.parentNode.removeChild(p);ua.releaseSelector(p);
G[0]=s;ua.requestSelector(s).showGrips(true);return s};this.setRotationAngle=function(p,s){p=parseFloat(p);var u=G[0];if(u){var D=u.getAttribute("transform"),B=svgedit.utilities.getBBox(u),K=B.x+B.width/2,E=B.y+B.height/2;B=Q(u);B.numberOfItems>0&&B.getItem(0).type==4&&B.removeItem(0);if(p!=0){K=N(K,E,V(B).matrix);E=k.createSVGTransform();E.setRotate(p,K.x,K.y);B.numberOfItems?B.insertItemBefore(E,0):B.appendItem(E)}else B.numberOfItems==0&&u.removeAttribute("transform");if(!s){B=u.getAttribute("transform");
u.setAttribute("transform",D);Ya("transform",B,G);O("changed",G)}pa("pathpointgrip_container");u=ua.requestSelector(G[0]);u.resize();u.updateGripCursors(p)}};var Ga=this.recalculateAllSelectedDimensions=function(){for(var p=new Aa(db=="none"?"position":"size"),s=G.length;s--;){var u=Ra(G[s]);u&&p.addSubCommand(u)}if(!p.isEmpty()){xa(p);O("changed",G)}},Oa=[0,"z","M","m","L","l","C","c","Q","q","A","a","H","h","V","v","S","s","T","t"],Wa=function(p){console.log([p.a,p.b,p.c,p.d,p.e,p.f])},Za=this.remapElement=
function(p,s,u){var D=g.gridSnapping&&p.parentNode.parentNode.localName==="svg",B=function(){if(D)for(var w in s)s[w]=Ba(s[w]);na(p,s,1E3,true)};box=svgedit.utilities.getBBox(p);for(var K=0;K<2;K++){var E=K===0?"fill":"stroke",A=p.getAttribute(E);if(A&&A.indexOf("url(")===0)if(u.a<0||u.d<0){A=S(A).cloneNode(true);if(u.a<0){var J=A.getAttribute("x1"),q=A.getAttribute("x2");A.setAttribute("x1",-(J-1));A.setAttribute("x2",-(q-1))}if(u.d<0){J=A.getAttribute("y1");q=A.getAttribute("y2");A.setAttribute("y1",
-(J-1));A.setAttribute("y2",-(q-1))}A.id=ma();gb().appendChild(A);p.setAttribute(E,"url(#"+A.id+")")}}K=p.tagName;if(K==="g"||K==="text"||K==="use")if(u.a==1&&u.b==0&&u.c==0&&u.d==1&&(u.e!=0||u.f!=0)){E=V(p).matrix;E=ba(E.inverse(),u,E);s.x=parseFloat(s.x)+E.e;s.y=parseFloat(s.y)+E.f}else{E=Q(p);A=k.createSVGTransform();A.setMatrix(ba(V(E).matrix,u));E.clear();E.appendItem(A)}switch(K){case "foreignObject":case "rect":case "image":if(K==="image"&&(u.a<0||u.d<0)){E=Q(p);A=k.createSVGTransform();A.setMatrix(ba(V(E).matrix,
u));E.clear();E.appendItem(A)}else{E=N(s.x,s.y,u);s.width=u.a*s.width;s.height=u.d*s.height;s.x=E.x+Math.min(0,s.width);s.y=E.y+Math.min(0,s.height);s.width=Math.abs(s.width);s.height=Math.abs(s.height)}B();break;case "ellipse":K=N(s.cx,s.cy,u);s.cx=K.x;s.cy=K.y;s.rx=u.a*s.rx;s.ry=u.d*s.ry;s.rx=Math.abs(s.rx);s.ry=Math.abs(s.ry);B();break;case "circle":K=N(s.cx,s.cy,u);s.cx=K.x;s.cy=K.y;K=svgedit.math.transformBox(box.x,box.y,box.width,box.height,u);s.r=Math.min((K.tr.x-K.tl.x)/2,(K.bl.y-K.tl.y)/
2);if(s.r)s.r=Math.abs(s.r);B();break;case "line":E=N(s.x1,s.y1,u);J=N(s.x2,s.y2,u);s.x1=E.x;s.y1=E.y;s.x2=J.x;s.y2=J.y;case "text":u=p.querySelectorAll("tspan");for(K=u.length;K--;){E=sa("x",p.getAttribute("x"));A=sa("x",u[K].getAttribute("x"));J=sa("y",p.getAttribute("y"));q=sa("y",u[K].getAttribute("y"));var v={};if(!isNaN(E)&&!isNaN(A)&&E!=0&&A!=0&&s.x)v.x=s.x-(E-A);if(!isNaN(J)&&!isNaN(q)&&J!=0&&q!=0&&s.y)v.y=s.y-(J-q);if(v.x||v.y)na(u[K],v,1E3,true)}B();break;case "use":B();break;case "g":(B=
$(p).data("gsvg"))&&na(B,s,1E3,true);break;case "polyline":case "polygon":B=s.points.length;for(K=0;K<B;++K){q=s.points[K];q=N(q.x,q.y,u);s.points[K].x=q.x;s.points[K].y=q.y}B=s.points.length;u="";for(K=0;K<B;++K){q=s.points[K];u+=q.x+","+q.y+" "}p.setAttribute("points",u);break;case "path":E=p.pathSegList;B=E.numberOfItems;s.d=Array(B);for(K=0;K<B;++K){A=E.getItem(K);s.d[K]={type:A.pathSegType,x:A.x,y:A.y,x1:A.x1,y1:A.y1,x2:A.x2,y2:A.y2,r1:A.r1,r2:A.r2,angle:A.angle,largeArcFlag:A.largeArcFlag,sweepFlag:A.sweepFlag}}B=
s.d.length;K=s.d[0];v=N(K.x,K.y,u);s.d[0].x=v.x;s.d[0].y=v.y;for(K=1;K<B;++K){A=s.d[K];E=A.type;if(E%2==0){q=N(A.x!=undefined?A.x:v.x,A.y!=undefined?A.y:v.y,u);E=N(A.x1,A.y1,u);J=N(A.x2,A.y2,u);A.x=q.x;A.y=q.y;A.x1=E.x;A.y1=E.y;A.x2=J.x;A.y2=J.y}else{A.x=u.a*A.x;A.y=u.d*A.y;A.x1=u.a*A.x1;A.y1=u.d*A.y1;A.x2=u.a*A.x2;A.y2=u.d*A.y2}A.r1=u.a*A.r1;A.r2=u.d*A.r2}u="";B=s.d.length;for(K=0;K<B;++K){A=s.d[K];E=A.type;u+=Oa[E];switch(E){case 13:case 12:u+=A.x+" ";break;case 15:case 14:u+=A.y+" ";break;case 3:case 5:case 19:case 2:case 4:case 18:u+=
A.x+","+A.y+" ";break;case 7:case 6:u+=A.x1+","+A.y1+" "+A.x2+","+A.y2+" "+A.x+","+A.y+" ";break;case 9:case 8:u+=A.x1+","+A.y1+" "+A.x+","+A.y+" ";break;case 11:case 10:u+=A.r1+","+A.r2+" "+A.angle+" "+ +A.largeArcFlag+" "+ +A.sweepFlag+" "+A.x+","+A.y+" ";break;case 17:case 16:u+=A.x2+","+A.y2+" "+A.x+","+A.y+" "}}p.setAttribute("d",u)}},nb=function(p,s,u){p=S(p).firstChild;var D=Q(p),B=k.createSVGTransform();B.setTranslate(s,u);D.appendItem(B);Ra(p)},Ra=this.recalculateDimensions=function(p){if(p==
null)return null;var s=Q(p);if(s&&s.numberOfItems>0){for(var u=s.numberOfItems;u--;){var D=s.getItem(u);if(D.type===0)s.removeItem(u);else if(D.type===1)svgedit.math.isIdentity(D.matrix)&&s.removeItem(u);else D.type===4&&D.angle===0&&s.removeItem(u)}if(s.numberOfItems===1&&oa(p))return null}if(!s||s.numberOfItems==0){p.removeAttribute("transform");return null}if(s){u=s.numberOfItems;for(var B=[];u--;){D=s.getItem(u);if(D.type===1)B.push([D.matrix,u]);else if(B.length)B=[]}if(B.length===2){u=k.createSVGTransformFromMatrix(ba(B[1][0],
B[0][0]));s.removeItem(B[0][1]);s.removeItem(B[1][1]);s.insertItemBefore(u,B[1][1])}u=s.numberOfItems;if(u>=2&&s.getItem(u-2).type===1&&s.getItem(u-1).type===2){B=k.createSVGTransform();D=ba(s.getItem(u-2).matrix,s.getItem(u-1).matrix);B.setMatrix(D);s.removeItem(u-2);s.removeItem(u-2);s.appendItem(B)}}switch(p.tagName){case "line":case "polyline":case "polygon":case "path":break;default:if(s.numberOfItems===1&&s.getItem(0).type===1||s.numberOfItems===2&&s.getItem(0).type===1&&s.getItem(0).type===
4)return null}var K=$(p).data("gsvg");u=new Aa("Transform");var E={},A=null;D=[];switch(p.tagName){case "line":D=["x1","y1","x2","y2"];break;case "circle":D=["cx","cy","r"];break;case "ellipse":D=["cx","cy","rx","ry"];break;case "foreignObject":case "rect":case "image":D=["width","height","x","y"];break;case "use":case "text":case "tspan":D=["x","y"];break;case "polygon":case "polyline":A={};A.points=p.getAttribute("points");B=p.points;var J=B.numberOfItems;E.points=Array(J);for(var q=0;q<J;++q){var v=
B.getItem(q);E.points[q]={x:v.x,y:v.y}}break;case "path":A={};A.d=p.getAttribute("d");E.d=p.getAttribute("d")}if(D.length){E=$(p).attr(D);$.each(E,function(Fa,Pa){E[Fa]=sa(Fa,Pa)})}else if(K)E={x:$(K).attr("x")||0,y:$(K).attr("y")||0};if(A==null){A=$.extend(true,{},E);$.each(A,function(Fa,Pa){A[Fa]=sa(Fa,Pa)})}A.transform=Sa?Sa:"";if(p.tagName=="g"&&!K||p.tagName=="a"){B=svgedit.utilities.getBBox(p);var w={x:B.x+B.width/2,y:B.y+B.height/2},z=N(B.x+B.width/2,B.y+B.height/2,V(s).matrix);D=k.createSVGMatrix();
if(B=oa(p)){q=B*Math.PI/180;J=Math.abs(q)>1.0E-10?Math.sin(q)/(1-Math.cos(q)):2/q;for(q=0;q<s.numberOfItems;++q){D=s.getItem(q);if(D.type==4){D=D.matrix;w.y=(J*D.e+D.f)/2;w.x=(D.e-J*D.f)/2;s.removeItem(q);break}}}q=D=K=0;var F=s.numberOfItems;if(F)var L=s.getItem(0).matrix;if(F>=3&&s.getItem(F-2).type==3&&s.getItem(F-3).type==2&&s.getItem(F-1).type==2){q=3;var M=s.getItem(F-3).matrix,R=s.getItem(F-2).matrix,Z=s.getItem(F-1).matrix;J=p.childNodes;for(v=J.length;v--;){var da=J.item(v);D=K=0;if(da.nodeType==
1){var W=Q(da);if(W){D=V(W).matrix;K=oa(da);var ga=Sa,ha=[];Sa=da.getAttribute("transform");if(K||ja(W)){var X=k.createSVGTransform();X.setMatrix(ba(M,R,Z,D));W.clear();W.appendItem(X);ha.push(X)}else{K=ba(D.inverse(),Z,D);X=k.createSVGMatrix();X.e=-K.e;X.f=-K.f;D=ba(X.inverse(),D.inverse(),M,R,Z,D,K.inverse());var qa=k.createSVGTransform(),za=k.createSVGTransform(),Ea=k.createSVGTransform();qa.setTranslate(K.e,K.f);za.setScale(D.a,D.d);Ea.setTranslate(X.e,X.f);W.appendItem(Ea);W.appendItem(za);W.appendItem(qa);
ha.push(Ea);ha.push(za);ha.push(qa)}u.addSubCommand(Ra(da));Sa=ga}}}s.removeItem(F-1);s.removeItem(F-2);s.removeItem(F-3)}else if(F>=3&&s.getItem(F-1).type==1){q=3;D=V(s).matrix;X=k.createSVGTransform();X.setMatrix(D);s.clear();s.appendItem(X)}else if((F==1||F>1&&s.getItem(1).type!=3)&&s.getItem(0).type==2){q=2;K=V(s).matrix;s.removeItem(0);D=V(s).matrix.inverse();D=ba(D,K);K=D.e;D=D.f;if(K!=0||D!=0){J=p.childNodes;v=J.length;for(F=[];v--;){da=J.item(v);if(da.nodeType==1){if(da.getAttribute("clip-path")){ga=
da.getAttribute("clip-path");if(F.indexOf(ga)===-1){nb(ga,K,D);F.push(ga)}}ga=Sa;Sa=da.getAttribute("transform");if(W=Q(da)){M=k.createSVGTransform();M.setTranslate(K,D);W.numberOfItems?W.insertItemBefore(M,0):W.appendItem(M);u.addSubCommand(Ra(da));W=p.getElementsByTagNameNS(b,"use");da="#"+da.id;for(M=W.length;M--;){R=W.item(M);if(da==ea(R)){Z=k.createSVGTransform();Z.setTranslate(-K,-D);Q(R).insertItemBefore(Z,0);u.addSubCommand(Ra(R))}}Sa=ga}}}F=[];Sa=ga}}else if(F==1&&s.getItem(0).type==1&&!B){q=
1;D=s.getItem(0).matrix;J=p.childNodes;for(v=J.length;v--;){da=J.item(v);if(da.nodeType==1){ga=Sa;Sa=da.getAttribute("transform");if(W=Q(da)){K=ba(D,V(W).matrix);F=k.createSVGTransform();F.setMatrix(K);W.clear();W.appendItem(F,0);u.addSubCommand(Ra(da));Sa=ga;ga=da.getAttribute("stroke-width");da.getAttribute("stroke")!=="none"&&!isNaN(ga)&&da.setAttribute("stroke-width",ga*((Math.abs(K.a)+Math.abs(K.d))/2))}}}s.clear()}else{if(B){w=k.createSVGTransform();w.setRotate(B,z.x,z.y);s.numberOfItems?s.insertItemBefore(w,
0):s.appendItem(w)}s.numberOfItems==0&&p.removeAttribute("transform");return null}if(q==2){if(B){z={x:w.x+L.e,y:w.y+L.f};w=k.createSVGTransform();w.setRotate(B,z.x,z.y);s.numberOfItems?s.insertItemBefore(w,0):s.appendItem(w)}}else if(q==3){D=V(s).matrix;L=k.createSVGTransform();L.setRotate(B,w.x,w.y);L=L.matrix;w=k.createSVGTransform();w.setRotate(B,z.x,z.y);z=w.matrix.inverse();ga=D.inverse();z=ba(ga,z,L,D);K=z.e;D=z.f;if(K!=0||D!=0){J=p.childNodes;for(v=J.length;v--;){da=J.item(v);if(da.nodeType==
1){ga=Sa;Sa=da.getAttribute("transform");W=Q(da);M=k.createSVGTransform();M.setTranslate(K,D);W.numberOfItems?W.insertItemBefore(M,0):W.appendItem(M);u.addSubCommand(Ra(da));Sa=ga}}}if(B)s.numberOfItems?s.insertItemBefore(w,0):s.appendItem(w)}}else{B=svgedit.utilities.getBBox(p);if(!B&&p.tagName!="path")return null;D=k.createSVGMatrix();if(K=oa(p)){w={x:B.x+B.width/2,y:B.y+B.height/2};z=N(B.x+B.width/2,B.y+B.height/2,V(s).matrix);q=K*Math.PI/180;J=Math.abs(q)>1.0E-10?Math.sin(q)/(1-Math.cos(q)):2/
q;for(q=0;q<s.numberOfItems;++q){D=s.getItem(q);if(D.type==4){D=D.matrix;w.y=(J*D.e+D.f)/2;w.x=(D.e-J*D.f)/2;s.removeItem(q);break}}}q=0;F=s.numberOfItems;if(!svgedit.browser.isWebkit())if((L=p.getAttribute("fill"))&&L.indexOf("url(")===0){L=S(L);ga="pattern";if(L.tagName!==ga)ga="gradient";if(L.getAttribute(ga+"Units")==="userSpaceOnUse"){D=V(s).matrix;B=Q(L);B=V(B).matrix;D=ba(D,B);B="matrix("+[D.a,D.b,D.c,D.d,D.e,D.f].join(",")+")";L.setAttribute(ga+"Transform",B)}}if(F>=3&&s.getItem(F-2).type==
3&&s.getItem(F-3).type==2&&s.getItem(F-1).type==2){q=3;D=V(s,F-3,F-1).matrix;s.removeItem(F-1);s.removeItem(F-2);s.removeItem(F-3)}else if(F==4&&s.getItem(F-1).type==1){q=3;D=V(s).matrix;X=k.createSVGTransform();X.setMatrix(D);s.clear();s.appendItem(X);D=k.createSVGMatrix()}else if((F==1||F>1&&s.getItem(1).type!=3)&&s.getItem(0).type==2){q=2;L=s.getItem(0).matrix;ga=V(s,1).matrix;B=ga.inverse();D=ba(B,L,ga);s.removeItem(0)}else if(F==1&&s.getItem(0).type==1&&!K){D=V(s).matrix;switch(p.tagName){case "line":E=
$(p).attr(["x1","y1","x2","y2"]);case "polyline":case "polygon":E.points=p.getAttribute("points");if(E.points){B=p.points;J=B.numberOfItems;E.points=Array(J);for(q=0;q<J;++q){v=B.getItem(q);E.points[q]={x:v.x,y:v.y}}}case "path":E.d=p.getAttribute("d");q=1;s.clear()}}else{q=4;if(K){w=k.createSVGTransform();w.setRotate(K,z.x,z.y);s.numberOfItems?s.insertItemBefore(w,0):s.appendItem(w)}s.numberOfItems==0&&p.removeAttribute("transform");return null}if(q==1||q==2||q==3)Za(p,E,D);if(q==2){if(K){ja(s)||
(z={x:w.x+D.e,y:w.y+D.f});w=k.createSVGTransform();w.setRotate(K,z.x,z.y);s.numberOfItems?s.insertItemBefore(w,0):s.appendItem(w)}}else if(q==3&&K){D=V(s).matrix;L=k.createSVGTransform();L.setRotate(K,w.x,w.y);L=L.matrix;w=k.createSVGTransform();w.setRotate(K,z.x,z.y);z=w.matrix.inverse();ga=D.inverse();z=ba(ga,z,L,D);Za(p,E,z);if(K)s.numberOfItems?s.insertItemBefore(w,0):s.appendItem(w)}}s.numberOfItems==0&&p.removeAttribute("transform");u.addSubCommand(new Ka(p,A));return u},mb=null,Ca=this.clearSelection=
function(p){if(G[0]!=null)for(var s=G.length,u=0;u<s;++u){var D=G[u];if(D==null)break;ua.releaseSelector(D);G[u]=null}p||O("selected",G)},qb=this.addToSelection=function(p,s){if(p.length!=0){for(var u=0;u<G.length;){if(G[u]==null)break;++u}for(var D=p.length;D--;){var B=p[D];if(B&&svgedit.utilities.getBBox(B)){if(B.tagName==="a"&&B.childNodes.length===1)B=B.firstChild;if(G.indexOf(B)==-1){G[u]=B;u++;B=ua.requestSelector(B);G.length>1&&B.showGrips(false)}}}O("selected",G);s||G.length==1?ua.requestSelector(G[0]).showGrips(true):
ua.requestSelector(G[0]).showGrips(false);for(G.sort(function(K,E){if(K&&E&&K.compareDocumentPosition)return 3-(E.compareDocumentPosition(K)&6);else if(K==null)return 1});G[0]==null;)G.shift(0)}},rb=this.selectOnly=function(p,s){Ca(true);qb(p,s)};this.removeFromSelection=function(p){if(G[0]!=null)if(p.length!=0){var s=Array(G.length);j=0;len=G.length;for(var u=0;u<len;++u){var D=G[u];if(D)if(p.indexOf(D)==-1){s[j]=D;j++}else ua.releaseSelector(D)}G=s}};this.selectAllInCurrentLayer=function(){var p=
n().getCurrentLayer();if(p){Ja="select";rb($(C||p).children())}};var Bb=this.getMouseTarget=function(p){if(p==null||p.target==null)return null;p=p.target;if(p.correspondingUseElement)p=p.correspondingUseElement;if(["http://www.w3.org/1998/Math/MathML","http://www.w3.org/1999/xhtml"].indexOf(p.namespaceURI)>=0&&p.id!="svgcanvas")for(;p.nodeName!="foreignObject";){p=p.parentNode;if(!p)return k}var s=n().getCurrentLayer();if([k,a,l,s].indexOf(p)>=0)return k;if($(p).closest("#selectorParentGroup").length)return ua.selectorParentGroup;
for(;p.parentNode&&p.parentNode!==(C||s);)p=p.parentNode;return p};(function(){var p=null,s=null,u=null,D=null,B=null,K={},E={minx:null,miny:null,maxx:null,maxy:null};$(a).mousedown(function(A){if(!c.spaceKey){var J=A.button===2;mb=l.querySelector("g").getScreenCTM().inverse();var q=N(A.pageX,A.pageY,mb),v=q.x*m;q=q.y*m;A.preventDefault();if(J)Ja="select";v=v/m;q=q/m;var w=Bb(A);if(w.tagName==="a"&&w.childNodes.length===1)w=w.firstChild;var z=D=s=v,F=B=u=q;if(g.gridSnapping){v=Ba(v);q=Ba(q);s=Ba(s);
u=Ba(u)}if(w==ua.selectorParentGroup&&G[0]!=null){w=A.target;var L=cb(w,"type");if(L=="rotate"){Ja="rotate";current_rotate_mode=cb(w,"dir")}else if(L=="resize"){Ja="resize";db=cb(w,"dir")}w=G[0]}Sa=w.getAttribute("transform");L=Q(w);switch(Ja){case "select":La=true;db="none";if(J)La=false;if(w!=k){if(G.indexOf(w)==-1){A.shiftKey||Ca(true);qb([w]);wb=w;Ma.clear()}if(!J)for(J=0;J<G.length;++J)if(G[J]!=null){var M=Q(G[J]);M.numberOfItems?M.insertItemBefore(k.createSVGTransform(),0):M.appendItem(k.createSVGTransform())}}else if(!J){Ca();
Ja="multiselect";if(va==null)va=ua.getRubberBandBox();D*=m;B*=m;na(va,{x:D,y:B,width:0,height:0,display:"inline"},100)}break;case "zoom":La=true;if(va==null)va=ua.getRubberBandBox();na(va,{x:z*m,y:z*m,width:0,height:0,display:"inline"},100);break;case "resize":La=true;s=v;u=q;K=svgedit.utilities.getBBox($("#selectedBox0")[0]);var R={};$.each(K,function(Z,da){R[Z]=da/m});K=R;J=oa(w)?1:0;if(ja(L)){L.insertItemBefore(k.createSVGTransform(),J);L.insertItemBefore(k.createSVGTransform(),J);L.insertItemBefore(k.createSVGTransform(),
J)}else{L.appendItem(k.createSVGTransform());L.appendItem(k.createSVGTransform());L.appendItem(k.createSVGTransform());if(svgedit.browser.supportsNonScalingStroke()){if(v=svgedit.browser.isWebkit())M=function(Z){var da=Z.getAttributeNS(null,"stroke");Z.removeAttributeNS(null,"stroke");setTimeout(function(){Z.setAttributeNS(null,"stroke",da)},0)};w.style.vectorEffect="non-scaling-stroke";v&&M(w);q=w.getElementsByTagName("*");z=q.length;for(J=0;J<z;J++){q[J].style.vectorEffect="non-scaling-stroke";
v&&M(q[J])}}}break;case "fhellipse":case "fhrect":case "fhpath":La=true;p=z+","+F+" ";M=H.stroke_width==0?1:H.stroke_width;P({element:"polyline",curStyles:true,attr:{points:p,id:ma(),fill:"none",opacity:H.opacity/2,"stroke-linecap":"round",style:"pointer-events:none"}});E.minx=z;E.maxx=z;E.miny=F;E.maxy=F;break;case "image":La=true;M=P({element:"image",attr:{x:v,y:q,width:0,height:0,id:ma(),opacity:H.opacity/2,style:"pointer-events:inherit"}});U(M,Ia);Fb(M);break;case "square":case "rect":La=true;
s=v;u=q;P({element:"rect",curStyles:true,attr:{x:v,y:q,width:0,height:0,id:ma(),opacity:H.opacity/2}});break;case "line":La=true;M=H.stroke_width==0?1:H.stroke_width;P({element:"line",curStyles:true,attr:{x1:v,y1:q,x2:v,y2:q,id:ma(),stroke:H.stroke,"stroke-width":M,"stroke-dasharray":H.stroke_dasharray,"stroke-linejoin":H.stroke_linejoin,"stroke-linecap":H.stroke_linecap,"stroke-opacity":H.stroke_opacity,fill:"none",opacity:H.opacity/2,style:"pointer-events:none"}});break;case "circle":La=true;P({element:"circle",
curStyles:true,attr:{cx:v,cy:q,r:0,id:ma(),opacity:H.opacity/2}});break;case "ellipse":La=true;P({element:"ellipse",curStyles:true,attr:{cx:v,cy:q,rx:0,ry:0,id:ma(),opacity:H.opacity/2}});break;case "text":La=true;P({element:"text",curStyles:true,attr:{x:v,y:q,id:ma(),fill:Ua.fill,"stroke-width":Ua.stroke_width,"font-size":Ua.font_size,"font-family":Ua.font_family,"text-anchor":"left","xml:space":"preserve",opacity:H.opacity}});break;case "path":case "pathedit":s*=m;u*=m;Ma.mouseDown(A,w,s,u);La=
true;break;case "textedit":s*=m;u*=m;bb.mouseDown(A,w,s,u);La=true;break;case "rotate":La=true;c.undoMgr.beginUndoableChange("transform",G);document.getElementById("workarea").className="rotate"}M=ib("mouseDown",{event:A,start_x:s,start_y:u,selectedElements:G},true);$.each(M,function(Z,da){if(da&&da.started)La=true});if(Ja)document.getElementById("workarea").className=Ja=="resize"?A.target.style.cursor:Ja}}).mousemove(function(A){if(!(A.originalEvent.touches&&A.originalEvent.touches.length>1))if(La)if(!(A.button===
1||c.spaceKey)){var J=G[0],q=N(A.pageX,A.pageY,mb),v=q.x*m;q=q.y*m;var w=pa(ca()),z=x=v/m,F=y=q/m;if(g.gridSnapping){x=Ba(x);y=Ba(y)}A.preventDefault();switch(Ja){case "select":if(G[0]!==null){z=x-s;var L=y-u;if(g.gridSnapping){z=Ba(z);L=Ba(L)}if(A.shiftKey){var M=T(s,u,x,y);x=M.x;y=M.y}if(z!=0||L!=0){F=G.length;for(var R=0;R<F;++R){J=G[R];if(J==null)break;var Z=k.createSVGTransform();w=Q(J);if(M){z=M.x-s;L=M.y-u}Z.setTranslate(z,L);w.numberOfItems?w.replaceItem(Z,0):w.appendItem(Z);ua.requestSelector(J).resize()}if(A.altKey)if(!c.addClones){c.addClones=
c.cloneSelectedElements(0,0,Z);c.removeClones=function(){c.addClones&&c.addClones.forEach(function(za){za.parentNode&&za.parentNode.removeChild(za);c.addClones=false})};window.addEventListener("keyup",c.removeClones)}O("transition",G)}}break;case "multiselect":z*=m;F*=m;na(va,{x:Math.min(D,z),y:Math.min(B,F),width:Math.abs(z-D),height:Math.abs(F-B)},100);w=[];z=[];M=ob();F=G.length;for(R=0;R<F;++R){L=M.indexOf(G[R]);if(L==-1)w.push(G[R]);else M[L]=null}F=M.length;for(R=0;R<F;++R)M[R]&&z.push(M[R]);
w.length>0&&c.removeFromSelection(w);z.length>0&&qb(z);break;case "resize":w=Q(J);z=(M=ja(w))?K:svgedit.utilities.getBBox(J);F=z.x;R=z.y;var da=z.width,W=z.height;z=x-s;L=y-u;if(g.gridSnapping){z=Ba(z);L=Ba(L);W=Ba(W);da=Ba(da)}if(Z=oa(J)){var ga=Math.sqrt(z*z+L*L);L=Math.atan2(L,z)-Z*Math.PI/180;z=ga*Math.cos(L);L=ga*Math.sin(L)}if(db.indexOf("n")==-1&&db.indexOf("s")==-1)L=0;if(db.indexOf("e")==-1&&db.indexOf("w")==-1)z=0;var ha=ga=0,X=W?(W+L)/W:1,qa=da?(da+z)/da:1;if(db.indexOf("n")>=0){X=W?(W-
L)/W:1;ha=W}if(db.indexOf("w")>=0){qa=da?(da-z)/da:1;ga=da}z=k.createSVGTransform();L=k.createSVGTransform();da=k.createSVGTransform();if(g.gridSnapping){F=Ba(F);ga=Ba(ga);R=Ba(R);ha=Ba(ha)}z.setTranslate(-(F+ga),-(R+ha));if(A.shiftKey)if(qa==1)qa=X;else X=qa;L.setScale(qa,X);da.setTranslate(F+ga,R+ha);if(M){M=Z?1:0;w.replaceItem(z,2+M);w.replaceItem(L,1+M);w.replaceItem(da,0+M)}else{M=w.numberOfItems;w.replaceItem(da,M-3);w.replaceItem(L,M-2);w.replaceItem(z,M-1)}ua.requestSelector(J).resize();O("transition",
G);break;case "zoom":z*=m;F*=m;na(va,{x:Math.min(D*m,z),y:Math.min(B*m,F),width:Math.abs(z-D*m),height:Math.abs(F-B*m)},100);break;case "text":na(w,{x:x,y:y},1E3);break;case "line":z=null;window.opera||k.suspendRedraw(1E3);if(g.gridSnapping){x=Ba(x);y=Ba(y)}F=x;M=y;if(A.shiftKey){M=T(s,u,F,M);F=M.x;M=M.y}w.setAttributeNS(null,"x2",F);w.setAttributeNS(null,"y2",M);window.opera||k.unsuspendRedraw(z);break;case "foreignObject":case "square":case "rect":case "image":z=Math.abs(x-s);M=Math.abs(y-u);if(Ja==
"square"||A.shiftKey){z=M=Math.max(z,M);F=s<x?s:s-z;R=u<y?u:u-M}else{F=Math.min(s,x);R=Math.min(u,y)}if(A.altKey){z*=2;M*=2;F=s-z/2;R=u-M/2}if(g.gridSnapping){z=Ba(z);M=Ba(M);F=Ba(F);R=Ba(R)}na(w,{width:z,height:M,x:F,y:R},1E3);break;case "circle":z=$(w).attr(["cx","cy"]);M=z.cx;F=z.cy;z=Math.sqrt((x-M)*(x-M)+(y-F)*(y-F));if(g.gridSnapping)z=Ba(z);w.setAttributeNS(null,"r",z);break;case "ellipse":z=$(w).attr(["cx","cy"]);M=Math.abs(s+(x-s)/2);F=Math.abs(u+(y-u)/2);z=null;window.opera||k.suspendRedraw(1E3);
if(g.gridSnapping){x=Ba(x);M=Ba(M);y=Ba(y);F=Ba(F)}R=Math.abs(s-M);L=Math.abs(u-F);if(A.shiftKey){L=R;F=y>u?u+R:u-R}if(A.altKey){M=s;F=u;R=Math.abs(x-M);L=A.shiftKey?R:Math.abs(y-F)}w.setAttributeNS(null,"rx",R);w.setAttributeNS(null,"ry",L);w.setAttributeNS(null,"cx",M);w.setAttributeNS(null,"cy",F);window.opera||k.unsuspendRedraw(z);break;case "fhellipse":case "fhrect":E.minx=Math.min(z,E.minx);E.maxx=Math.max(z,E.maxx);E.miny=Math.min(F,E.miny);E.maxy=Math.max(F,E.maxy);case "fhpath":p+=+z+","+
F+" ";w.setAttributeNS(null,"points",p);break;case "path":case "pathedit":x*=m;y*=m;if(g.gridSnapping){x=Ba(x);y=Ba(y);s=Ba(s);u=Ba(u)}if(A.shiftKey){if(M=svgedit.path.path){w=M.dragging?M.dragging[0]:s;M=M.dragging?M.dragging[1]:u}else{w=s;M=u}M=T(w,M,x,y);x=M.x;y=M.y}if(va&&va.getAttribute("display")!=="none"){z*=m;F*=m;na(va,{x:Math.min(D*m,z),y:Math.min(B*m,F),width:Math.abs(z-D*m),height:Math.abs(F-B*m)},100)}Ma.mouseMove(A,x,y);break;case "textedit":x*=m;y*=m;bb.mouseMove(v,q);break;case "rotate":z=
svgedit.utilities.getBBox(J);M=z.x+z.width/2;F=z.y+z.height/2;w=aa(J);w=N(M,F,w);M=w.x;F=w.y;w=z.x;R=z.y;if(current_rotate_mode=="nw")w=z.x+z.width;if(current_rotate_mode=="se")R=z.y+z.height;if(current_rotate_mode=="sw"){w=z.x+z.width;R=z.y+z.height}compensation_angle=(Math.atan2(F-R,M-w)*(180/Math.PI)-90)%360;Z=(Math.atan2(F-y,M-x)*(180/Math.PI)-90)%360;Z+=compensation_angle;if(g.gridSnapping)Z=Ba(Z);if(A.shiftKey)Z=Math.round(Z/45)*45;c.setRotationAngle(Z<-180?360+Z:Z,true);O("transition",G)}ib("mouseMove",
{event:A,mouse_x:v,mouse_y:q,selected:J})}}).click(function(A){A.preventDefault();return false}).dblclick(function(A){var J=A.target.parentNode,q=Bb(A),v=q.tagName;if(J!==C){if(v==="text"&&Ja!=="textedit"){A=N(A.pageX,A.pageY,mb);bb.select(q,A.x,A.y)}if((v==="g"||v==="a")&&oa(q)){Db(q);q=G[0];Ca(true)}C&&Eb();J.tagName!=="g"&&J.tagName!=="a"||J===n().getCurrentLayer()||q===ua.selectorParentGroup||Kb(q)}}).mouseup(function(A){c.addClones=false;window.removeEventListener("keyup",c.removeClones);G=G.filter(Boolean);
if(A.button!==2){var J=wb;wb=null;if(La){var q=N(A.pageX,A.pageY,mb),v=q.x*m;q=q.y*m;var w=v/m,z=q/m,F=pa(ca()),L=false;La=false;switch(Ja){case "resize":case "multiselect":if(va!=null){va.setAttribute("display","none");hb=[]}Ja="select";case "select":if(G[0]!=null){if(G.length==1){v=G[0];switch(v.tagName){case "g":case "use":case "image":case "foreignObject":break;default:Xa.fill=v.getAttribute("fill");Xa.fill_opacity=v.getAttribute("fill-opacity");Xa.stroke=v.getAttribute("stroke");Xa.stroke_opacity=
v.getAttribute("stroke-opacity");Xa.stroke_width=v.getAttribute("stroke-width");Xa.stroke_dasharray=v.getAttribute("stroke-dasharray");Xa.stroke_linejoin=v.getAttribute("stroke-linejoin");Xa.stroke_linecap=v.getAttribute("stroke-linecap")}if(v.tagName=="text"){Ua.font_size=v.getAttribute("font-size");Ua.font_family=v.getAttribute("font-family")}ua.requestSelector(v).showGrips(true)}Ga();D=D;B=B;v=Math.abs(z-B);if(v>1||v>1){A=G.length;for(v=0;v<A;++v){if(G[v]==null)break;G[v].firstChild||ua.requestSelector(G[v]).resize()}}else{v=
A.target;if(G[0].nodeName==="path"&&G[1]==null)Ma.select(G[0]);else A.shiftKey&&J!=v&&c.removeFromSelection([v])}if(svgedit.browser.supportsNonScalingStroke())if(A=G[0]){A.removeAttribute("style");svgedit.utilities.walkTree(A,function(Z){Z.removeAttribute("style")})}}return;case "zoom":va!=null&&va.setAttribute("display","none");O("zoomed",{x:Math.min(D,w),y:Math.min(B,z),width:Math.abs(w-D),height:Math.abs(z-B),factor:A.altKey?0.5:2});return;case "fhpath":J=F.getAttribute("points");z=J.indexOf(",");
if(L=z>=0?J.indexOf(",",z+1)>=0:J.indexOf(" ",J.indexOf(" ")+1)>=0)F=Ma.smoothPolylineIntoPath(F);break;case "line":J=$(F).attr(["x1","x2","y1","y2"]);L=J.x1!=J.x2||J.y1!=J.y2;break;case "foreignObject":case "square":case "rect":case "image":J=$(F).attr(["width","height"]);L=J.width!=0||J.height!=0||Ja==="image";break;case "circle":L=F.getAttribute("r")!=0;break;case "ellipse":J=$(F).attr(["rx","ry"]);L=J.rx!=null||J.ry!=null;break;case "fhellipse":if(E.maxx-E.minx>0&&E.maxy-E.miny>0){F=P({element:"ellipse",
curStyles:true,attr:{cx:(E.minx+E.maxx)/2,cy:(E.miny+E.maxy)/2,rx:(E.maxx-E.minx)/2,ry:(E.maxy-E.miny)/2,id:ca()}});O("changed",[F]);L=true}break;case "fhrect":if(E.maxx-E.minx>0&&E.maxy-E.miny>0){F=P({element:"rect",curStyles:true,attr:{x:E.minx,y:E.miny,width:E.maxx-E.minx,height:E.maxy-E.miny,id:ca()}});O("changed",[F]);L=true}break;case "text":L=true;rb([F]);bb.start(F);break;case "path":F=null;La=true;J=Ma.mouseUp(A,F,v,q);F=J.element;L=J.keep;break;case "pathedit":L=true;F=null;Ma.mouseUp(A);
break;case "textedit":L=false;F=null;bb.mouseUp(A,v,q);break;case "rotate":L=true;F=null;Ja="select";J=c.undoMgr.finishUndoableChange();J.isEmpty()||xa(J);Ga();O("changed",G)}v=ib("mouseUp",{event:A,mouse_x:v,mouse_y:q},true);$.each(v,function(Z,da){if(da){L=da.keep||L;F=da.element;La=da.started||La}});if(!L&&F!=null){n().releaseId(ca());F.parentNode.removeChild(F);F=null;for(v=A.target;v.parentNode.parentNode.tagName=="g";)v=v.parentNode;if((Ja!="path"||!drawn_path)&&v.parentNode.id!="selectorParentGroup"&&
v.id!="svgcanvas"&&v.id!="svgroot"){c.setMode("select");rb([v],true)}}else if(F!=null){c.addedNew=true;A=0.2;var M;if(false.beginElement&&F.getAttribute("opacity")!=H.opacity){M=$(false).clone().attr({to:H.opacity,dur:A}).appendTo(F);try{M[0].beginElement()}catch(R){}}else A=0;setTimeout(function(){M&&M.remove();F.setAttribute("opacity",H.opacity);F.setAttribute("style","pointer-events:inherit");ia(F);if(Ja==="path")Ma.toEditMode(F);else g.selectNew&&rb([F],true);xa(new Ha(F));O("changed",[F])},A*
1E3)}Sa=null}}});$(a).bind("mousewheel DOMMouseScroll",function(A){if(A.shiftKey){A.preventDefault();mb=l.getScreenCTM().inverse();var J=N(A.pageX,A.pageY,mb);J={x:J.x,y:J.y,width:0,height:0};if(A.wheelDelta)if(A.wheelDelta>=120)J.factor=2;else{if(A.wheelDelta<=-120)J.factor=0.5}else if(A.detail)if(A.detail>0)J.factor=0.5;else if(A.detail<0)J.factor=2;J.factor&&O("zoomed",J)}})})();var Fb=function(p){$(p).click(function(s){s.preventDefault()})},bb=c.textActions=function(){function p(W){var ga=q.value===
"";$(q).focus();if(!arguments.length)if(ga)W=0;else{if(q.selectionEnd!==q.selectionStart)return;W=q.selectionEnd}var ha;ha=F[W];ga||q.setSelectionRange(W,W);v=pa("text_cursor");if(!v){v=document.createElementNS(b,"line");na(v,{id:"text_cursor",stroke:"#333","stroke-width":1});v=pa("selectorParentGroup").appendChild(v)}z||(z=setInterval(function(){var X=v.getAttribute("display")==="none";v.setAttribute("display",X?"inline":"none")},600));ga=K(ha.x,L.y);ha=K(ha.x,L.y+L.height);na(v,{x1:ga.x,y1:ga.y,
x2:ha.x,y2:ha.y,visibility:"visible",display:"inline"});w&&w.setAttribute("d","M 0 0")}function s(W,ga,ha){if(W===ga)p(ga);else{ha||q.setSelectionRange(W,ga);w=pa("text_selectblock");if(!w){w=document.createElementNS(b,"path");na(w,{id:"text_selectblock",fill:"green",opacity:0.5,style:"pointer-events:none"});pa("selectorParentGroup").appendChild(w)}W=F[W];var X=F[ga];v.setAttribute("visibility","hidden");ga=K(W.x,L.y);ha=K(W.x+(X.x-W.x),L.y);var qa=K(W.x,L.y+L.height);W=K(W.x+(X.x-W.x),L.y+L.height);
na(w,{d:"M"+ga.x+","+ga.y+" L"+ha.x+","+ha.y+" "+W.x+","+W.y+" "+qa.x+","+qa.y+"z",display:"inline"})}}function u(W,ga){var ha=k.createSVGPoint();ha.x=W;ha.y=ga;if(F.length==1)return 0;ha=J.getCharNumAtPosition(ha);if(ha<0){ha=F.length-2;if(W<=F[0].x)ha=0}else if(ha>=F.length-2)ha=F.length-2;var X=F[ha];W>X.x+X.width/2&&ha++;return ha}function D(W,ga,ha){var X=q.selectionStart;W=u(W,ga);s(Math.min(X,W),Math.max(X,W),!ha)}function B(W,ga){var ha={x:W,y:ga};ha.x/=m;ha.y/=m;if(M){var X=N(ha.x,ha.y,M.inverse());
ha.x=X.x;ha.y=X.y}return ha}function K(W,ga){var ha={x:W,y:ga};if(M){var X=N(ha.x,ha.y,M);ha.x=X.x;ha.y=X.y}ha.x*=m;ha.y*=m;return ha}function E(W){s(0,J.textContent.length);$(this).unbind(W)}function A(W){if(da&&J){var ga=N(W.pageX,W.pageY,mb);ga=B(ga.x*m,ga.y*m);ga=u(ga.x,ga.y);var ha=J.textContent,X=ha.substr(0,ga).replace(/[a-z0-9]+$/i,"").length;ha=ha.substr(ga).match(/^[a-z0-9]+/i);s(X,(ha?ha[0].length:0)+ga);$(W.target).click(E);setTimeout(function(){$(W.target).unbind("click",E)},300)}}var J,
q,v,w,z,F=[],L,M,R,Z,da;return{select:function(W,ga,ha){J=W;bb.toEditMode(ga,ha)},start:function(W){J=W;bb.toEditMode()},mouseDown:function(W,ga,ha,X){W=B(ha,X);q.focus();p(u(W.x,W.y));R=ha;Z=X},mouseMove:function(W,ga){var ha=B(W,ga);D(ha.x,ha.y)},mouseUp:function(W,ga,ha){var X=B(ga,ha);D(X.x,X.y,true);W.target!==J&&ga<R+2&&ga>R-2&&ha<Z+2&&ha>Z-2&&bb.toSelectMode(true)},setCursor:p,toEditMode:function(W,ga){rb([J],false);da=false;Ja="textedit";ua.requestSelector(J).showGrips(false);ua.requestSelector(J);
bb.init();$(J).css("cursor","text");if(arguments.length){var ha=B(W,ga);p(u(ha.x,ha.y))}else p();setTimeout(function(){da=true},300)},toSelectMode:function(W){Ja="select";clearInterval(z);z=null;w&&$(w).attr("display","none");v&&$(v).attr("visibility","hidden");$(J).css("cursor","move");if(W){Ca();$(J).css("cursor","move");O("selected",[J]);qb([J],true)}J&&!J.textContent.length&&c.deleteSelectedElements();$(q).blur();J=false},setInputElem:function(W){q=W},clear:function(){Ja=="textedit"&&bb.toSelectMode()},
init:function(){if(J){if(!J.parentNode){J=G[0];ua.requestSelector(J).showGrips(false)}var W=J.textContent.length,ga=J.getAttribute("transform");L=svgedit.utilities.getBBox(J);M=ga?aa(J):null;F=Array(W);q.focus();$(J).unbind("dblclick",A).dblclick(A);if(!W)var ha={x:L.x+L.width/2,width:0};for(ga=0;ga<W;ga++){var X=J.getStartPositionOfChar(ga);ha=J.getEndPositionOfChar(ga);if(!svgedit.browser.supportsGoodTextCharPos()){var qa=c.contentW*m;X.x-=qa;ha.x-=qa;X.x/=m;ha.x/=m}F[ga]={x:X.x,y:L.y,width:ha.x-
X.x,height:L.height}}F.push({x:ha.x,width:0});s(q.selectionStart,q.selectionEnd,true)}}}}(),Ma=c.pathActions=function(){var p=false,s,u,D;svgedit.path.Path.prototype.endChanges=function(E){if(svgedit.browser.isWebkit()){var A=this.elem;A.setAttribute("d",Ma.convertPath(A))}E=new Ka(this.elem,{d:this.last_d},E);xa(E);O("changed",[this.elem])};svgedit.path.Path.prototype.addPtsToSelection=function(E){$.isArray(E)||(E=[E]);for(var A=0;A<E.length;A++){var J=E[A],q=this.segs[J];q.ptgrip&&this.selected_pts.indexOf(J)==
-1&&J>=0&&this.selected_pts.push(J)}this.selected_pts.sort();A=this.selected_pts.length;for(E=Array(A);A--;){q=this.segs[this.selected_pts[A]];q.select(true);E[A]=q.ptgrip}Ma.canDeleteNodes=true;Ma.closed_subpath=this.subpathIsClosed(this.selected_pts[0]);O("selected",E)};var B=s=null,K=false;this.lastCtrlPoint=[0,0];return{mouseDown:function(E,A,J,q){if(Ja==="path"){mouse_x=J;mouse_y=q;J=mouse_x/m;A=mouse_y/m;q=pa("path_stretch_line");u=[J,A];if(g.gridSnapping){J=Ba(J);A=Ba(A);mouse_x=Ba(mouse_x);
mouse_y=Ba(mouse_y)}if(!q){q=document.createElementNS(b,"path");na(q,{id:"path_stretch_line",stroke:"#22C","stroke-width":"0.5",fill:"none"});q=pa("selectorParentGroup").appendChild(q)}q.setAttribute("display","inline");this.stretchy=q;var v=null;if(B){v=B.pathSegList;for(var w=v.numberOfItems,z=6/m,F=false;w;){w--;var L=v.getItem(w),M=L.x;L=L.y;if(J>=M-z&&J<=M+z&&A>=L-z&&A<=L+z){F=true;break}}z=ca();svgedit.path.removePath_(z);z=pa(z);M=v.numberOfItems;if(F){if(w<=1&&M>=2){J=v.getItem(0).x;A=v.getItem(0).y;
w=svgedit.path.first_grip?svgedit.path.first_grip[0]/m:v.getItem(0).x;F=svgedit.path.first_grip?svgedit.path.first_grip[1]/m:v.getItem(0).y;E=q.pathSegList.getItem(1);E=E.pathSegType===4?B.createSVGPathSegLinetoAbs(J,A):B.createSVGPathSegCurvetoCubicAbs(J,A,E.x1/m,E.y1/m,w,F);J=B.createSVGPathSegClosePath();v.appendItem(E);v.appendItem(J)}else if(M<3)return v=false;$(q).remove();element=z;B=null;La=false;if(p){svgedit.path.path.matrix&&Za(z,{},svgedit.path.path.matrix.inverse());J=z.getAttribute("d");
q=$(svgedit.path.path.elem).attr("d");$(svgedit.path.path.elem).attr("d",q+J);$(z).remove();svgedit.path.path.matrix&&svgedit.path.recalcRotatedPath();svgedit.path.path.init();Ma.toEditMode(svgedit.path.path.elem);svgedit.path.path.selectPt();return false}}else{if(!$.contains(a,Bb(E))){console.log("Clicked outside canvas");return false}v=B.pathSegList.numberOfItems;w=B.pathSegList.getItem(v-1);z=w.x;w=w.y;if(E.shiftKey){A=T(z,w,J,A);J=A.x;A=A.y}E=q.pathSegList.getItem(1);E=E.pathSegType===4?B.createSVGPathSegLinetoAbs(ab(J),
ab(A)):B.createSVGPathSegCurvetoCubicAbs(ab(J),ab(A),E.x1/m,E.y1/m,E.x2/m,E.y2/m);B.pathSegList.appendItem(E);J*=m;A*=m;q.setAttribute("d",["M",J,A,J,A].join(" "));q=svgedit.path.addCtrlGrip("1c1");E=svgedit.path.addCtrlGrip("0c2");z=svgedit.path.getCtrlLine(1);w=svgedit.path.getCtrlLine(2);q.setAttribute("cx",J);q.setAttribute("cy",A);E.setAttribute("cx",J);E.setAttribute("cy",A);z.setAttribute("x1",J);z.setAttribute("x2",J);z.setAttribute("y1",A);z.setAttribute("y2",A);w.setAttribute("x1",J);w.setAttribute("x2",
J);w.setAttribute("y1",A);w.setAttribute("y2",A);q=v;if(p)q+=svgedit.path.path.segs.length;svgedit.path.addPointGrip(q,J,A)}v=true}else{d_attr="M"+J+","+A+" ";B=P({element:"path",curStyles:true,attr:{d:d_attr,id:ma(),opacity:H.opacity/2}});q.setAttribute("d",["M",mouse_x,mouse_y,mouse_x,mouse_y].join(" "));q=p?svgedit.path.path.segs.length:0;svgedit.path.addPointGrip(q,mouse_x,mouse_y);svgedit.path.first_grip=null}}else if(svgedit.path.path){svgedit.path.path.storeD();z=E.target.id;if(z.substr(0,
14)=="pathpointgrip_"){A=svgedit.path.path.cur_pt=parseInt(z.substr(14));svgedit.path.path.dragging=[J,q];z=svgedit.path.path.segs[A];if(E.shiftKey)z.selected?svgedit.path.path.removePtFromSelection(A):svgedit.path.path.addPtsToSelection(A);else{if(svgedit.path.path.selected_pts.length<=1||!z.selected)svgedit.path.path.clearSelection();svgedit.path.path.addPtsToSelection(A)}}else if(z.indexOf("ctrlpointgrip_")==0){svgedit.path.path.dragging=[J,q];E=z.split("_")[1].split("c");A=E[0]-0;v=E=E[1]-0;w=
svgedit.path.path.segs[A];svgedit.path.path.selectPt(A,E);if(v==2){F=1;z=w.next}else{F=2;z=w.prev}if(!z)return;E=function(R,Z){return Math.sqrt(Math.pow(R.x-Z.x,2)+Math.pow(R.y-Z.y,2))};A={x:w.item["x"+v],y:w.item["y"+v]};v=v==2?{x:w.item.x,y:w.item.y}:{x:z.item.x,y:z.item.y};w={x:z.item["x"+F],y:z.item["y"+F]};z=E(A,v);E=E(w,v);A=Math.abs(Math.round(Math.atan2(A.y-v.y,A.x-v.x)*(180/Math.PI),0)-Math.round(Math.atan2(w.y-v.y,w.x-v.x)*(180/Math.PI),0))==180;if(Math.abs(z-E)<5&&A){svgedit.path.setLinkControlPoints(true);
svgedit.path.is_linked=true}else{svgedit.path.setLinkControlPoints(false);svgedit.path.is_linked=false}}if(!svgedit.path.path.dragging){if(va==null)va=ua.getRubberBandBox();na(va,{x:J*m,y:q*m,width:0,height:0,display:"inline"},100)}}},mouseMove:function(E,A,J){K=true;var q=!E.altKey;if(Ja==="path"){if(B){var v=B.pathSegList,w=v.numberOfItems-1,z=svgedit.path.addCtrlGrip("1c1"),F=svgedit.path.addCtrlGrip("0c2");if(u){var L=F.getAttribute("cx")/m||0,M=F.getAttribute("cy")/m||0;z.setAttribute("cx",A);
z.setAttribute("cy",J);z.setAttribute("display","inline");E=u[0];z=u[1];v.getItem(w);var R=A/m,Z=J/m;L=q?E+(E-R):L;q=q?z+(z-Z):M;F.setAttribute("cx",L*m);F.setAttribute("cy",q*m);F.setAttribute("display","inline");F=svgedit.path.getCtrlLine(1);M=svgedit.path.getCtrlLine(2);na(F,{x1:A,y1:J,x2:E*m,y2:z*m,display:"inline"});na(M,{x1:L*m,y1:q*m,x2:E*m,y2:z*m,display:"inline"});if(w===0)D=[A,J];else{v=v.getItem(w-1);A=v.x;J=v.y;if(v.pathSegType===6){A+=A-v.x2;J+=J-v.y2}else if(D){A=D[0]/m;J=D[1]/m}svgedit.path.replacePathSeg(6,
w,[E,z,this.lastCtrlPoint[0]/m,this.lastCtrlPoint[1]/m,L,q],B)}}else if(q=this.stretchy){w=v.getItem(w);v=A;z=J;if(E.target.id==="pathpointgrip_0"&&svgedit.path.first_grip){v=svgedit.path.first_grip[0];z=svgedit.path.first_grip[1]}if(w.pathSegType===6)svgedit.path.replacePathSeg(6,1,[A,J,(this.lastCtrlPoint[0]/m||w.x+(w.x-w.x2))*m,(this.lastCtrlPoint[1]/m||w.y+(w.y-w.y2))*m,v,z],q);else D?svgedit.path.replacePathSeg(6,1,[A,J,D[0],D[1],A,J],q):svgedit.path.replacePathSeg(4,1,[A,J],q)}}}else if(svgedit.path.path.dragging){v=
svgedit.path.getPointFromGrip({x:svgedit.path.path.dragging[0],y:svgedit.path.path.dragging[1]},svgedit.path.path);E=svgedit.path.getPointFromGrip({x:A,y:J},svgedit.path.path);w=E.x-v.x;v=E.y-v.y;svgedit.path.path.dragging=[A,J];!q||!svgedit.path.is_linked?svgedit.path.setLinkControlPoints(false):svgedit.path.setLinkControlPoints(true);svgedit.path.path.dragctrl?svgedit.path.path.moveCtrl(w,v):svgedit.path.path.movePts(w,v)}else{svgedit.path.path.selected_pts=[];svgedit.path.path.eachSeg(function(){if(this.next||
this.prev){var da=va.getBBox(),W=svgedit.path.getGripPt(this);da=svgedit.math.rectsIntersect(da,{x:W.x,y:W.y,width:0,height:0});this.select(da);da&&svgedit.path.path.selected_pts.push(this.index)}})}},mouseUp:function(E,A,J,q){var v=pa("ctrlpointgrip_1c1"),w=pa("ctrlpointgrip_0c2");this.lastCtrlPoint=v?[v.getAttribute("cx"),v.getAttribute("cy")]:[J,q];if(!svgedit.path.first_grip&&w)svgedit.path.first_grip=[w.getAttribute("cx"),w.getAttribute("cy")];if(Ja==="path"){u=null;if(!B){A=pa(ca());La=false;
D=null}return{keep:true,element:A}}if(svgedit.path.path.dragging){A=svgedit.path.path.cur_pt;svgedit.path.path.dragging=false;svgedit.path.path.dragctrl=false;svgedit.path.path.update();K&&svgedit.path.path.endChanges("Move path point(s)");!E.shiftKey&&!K&&svgedit.path.path.selectPt(A)}else if(va&&va.getAttribute("display")!="none"){va.setAttribute("display","none");va.getAttribute("width")<=2&&va.getAttribute("height")<=2&&Ma.toSelectMode(E.target)}else Ma.toSelectMode(E.target);K=false},toEditMode:function(E){svgedit.path.path=
svgedit.path.getPath_(E);Ja="pathedit";Ca();svgedit.path.path.show(true).update();svgedit.path.path.oldbbox=svgedit.utilities.getBBox(svgedit.path.path.elem);p=false},toSelectMode:function(E){var A=E==svgedit.path.path.elem;Ja="select";svgedit.path.path.show(false);s=false;Ca();svgedit.path.path.matrix&&svgedit.path.recalcRotatedPath();if(A){O("selected",[E]);qb([E],true)}},addSubPath:function(E){if(E){Ja="path";p=true}else{Ma.clear(true);Ma.toEditMode(svgedit.path.path.elem)}},select:function(E){if(s===
E){Ma.toEditMode(E);Ja="pathedit"}else s=E},reorient:function(){var E=G[0];if(E)if(oa(E)!=0){var A=new Aa("Reorient path"),J={d:E.getAttribute("d"),transform:E.getAttribute("transform")};A.addSubCommand(new Ka(E,J));Ca();this.resetOrientation(E);xa(A);svgedit.path.getPath_(E).show(false).matrix=null;this.clear();qb([E],true);O("changed",G)}},clear:function(E){s=null;if(B){var A=pa(ca());$(pa("path_stretch_line")).remove();E&&$(A).remove();$(pa("pathpointgrip_container")).find("*").attr("display",
"none");B=D=null;La=false}else Ja=="pathedit"&&this.toSelectMode();svgedit.path.path&&svgedit.path.path.init().show(false)},resetOrientation:function(E){if(E==null||E.nodeName!="path")return false;var A=Q(E),J=V(A).matrix;A.clear();E.removeAttribute("transform");A=E.pathSegList;for(var q=A.numberOfItems,v=0;v<q;++v){var w=A.getItem(v),z=w.pathSegType;if(z!=1){var F=[];$.each(["",1,2],function(L,M){var R=w["x"+M],Z=w["y"+M];if(R!==undefined&&Z!==undefined){R=N(R,Z,J);F.splice(F.length,0,R.x,R.y)}});
svgedit.path.replacePathSeg(z,v,F,E)}}e(E,J)},zoomChange:function(){Ja=="pathedit"&&svgedit.path.path.update()},getNodePoint:function(){if(svgedit.path.path){var E=svgedit.path.path.segs[svgedit.path.path.selected_pts.length?svgedit.path.path.selected_pts[0]:1];return{x:E.item.x,y:E.item.y,type:E.type}}},linkControlPoints:function(E){svgedit.path.setLinkControlPoints(E)},clonePathNode:function(){svgedit.path.path.storeD();for(var E=svgedit.path.path.selected_pts,A=E.length,J=[];A--;){var q=E[A];svgedit.path.path.addSeg(q);
J.push(q+A);J.push(q+A+1)}svgedit.path.path.init().addPtsToSelection(J);svgedit.path.path.endChanges("Clone path node(s)")},opencloseSubPath:function(){var E=svgedit.path.path.selected_pts;if(E.length===1){var A=svgedit.path.path.elem,J=A.pathSegList,q=E[0],v=null,w=null;svgedit.path.path.eachSeg(function(M){if(this.type===2&&M<=q)w=this.item;if(M<=q)return true;if(this.type===2){v=M;return false}else if(this.type===1)return v=false});if(v==null)v=svgedit.path.path.segs.length-1;if(v!==false){var z=
A.createSVGPathSegLinetoAbs(w.x,w.y),F=A.createSVGPathSegClosePath();if(v==svgedit.path.path.segs.length){J.appendItem(z);J.appendItem(F)}else{svgedit.path.insertItemBefore(A,F,v);svgedit.path.insertItemBefore(A,z,v)}svgedit.path.path.init().selectPt(v+1)}else if(svgedit.path.path.segs[q].mate){J.removeItem(q);J.removeItem(q);svgedit.path.path.init().selectPt(q-1)}else{for(E=0;E<J.numberOfItems;E++){var L=J.getItem(E);if(L.pathSegType===2)z=E;else if(E===q)J.removeItem(z);else if(L.pathSegType===
1&&q<E){F=E-1;J.removeItem(E);break}}for(E=q-z-1;E--;)svgedit.path.insertItemBefore(A,J.getItem(z),F);A=J.getItem(z);svgedit.path.replacePathSeg(2,z,[A.x,A.y]);E=q;svgedit.path.path.init().selectPt(0)}}},deletePathNode:function(){if(Ma.canDeleteNodes){svgedit.path.path.storeD();for(var E=svgedit.path.path.selected_pts,A=E.length;A--;)svgedit.path.path.deleteSeg(E[A]);var J=function(){var q=svgedit.path.path.elem.pathSegList,v=q.numberOfItems,w=function(L,M){for(;M--;)q.removeItem(L)};if(v<=1)return true;
for(;v--;){var z=q.getItem(v);if(z.pathSegType===1){z=q.getItem(v-1);var F=q.getItem(v-2);if(z.pathSegType===2){w(v-1,2);J();break}else if(F.pathSegType===2){w(v-2,3);J();break}}else if(z.pathSegType===2)if(v>0){z=q.getItem(v-1).pathSegType;if(z===2){w(v-1,1);J();break}else if(z===1&&q.numberOfItems-1===v){w(v,1);J();break}}}return false};J();if(svgedit.path.path.elem.pathSegList.numberOfItems<=1){c.setMode("select");c.deleteSelectedElements()}else{svgedit.path.path.init();svgedit.path.path.clearSelection();
if(window.opera){E=$(svgedit.path.path.elem);E.attr("d",E.attr("d"))}svgedit.path.path.endChanges("Delete path node(s)")}}},smoothPolylineIntoPath:function(E){var A=E.points,J=A.numberOfItems;if(J>=4){var q=A.getItem(0),v=null;E=[];E.push(["M",q.x,",",q.y," C"].join(""));for(var w=1;w<=J-4;w+=3){var z=A.getItem(w),F=A.getItem(w+1),L=A.getItem(w+2);if(v)if((q=svgedit.path.smoothControlPoints(v,z,q))&&q.length==2){z=E[E.length-1].split(",");z[2]=q[0].x;z[3]=q[0].y;E[E.length-1]=z.join(",");z=q[1]}E.push([z.x,
z.y,F.x,F.y,L.x,L.y].join(","));q=L;v=F}for(E.push("L");w<J;++w){F=A.getItem(w);E.push([F.x,F.y].join(","))}E=E.join(" ");E=P({element:"path",curStyles:true,attr:{id:ca(),d:E,fill:"none"}})}return E},setSegType:function(E){svgedit.path.path.setSegType(E)},moveNode:function(E,A){var J=svgedit.path.path.selected_pts;if(J.length){svgedit.path.path.storeD();J=svgedit.path.path.segs[J[0]];var q={x:0,y:0};q[E]=A-J.item[E];J.move(q.x,q.y);svgedit.path.path.endChanges("Move path point")}},fixEnd:function(E){for(var A=
E.pathSegList,J=A.numberOfItems,q,v=0;v<J;++v){var w=A.getItem(v);if(w.pathSegType===2)q=w;if(w.pathSegType===1){w=A.getItem(v-1);if(w.x!=q.x||w.y!=q.y){A=E.createSVGPathSegLinetoAbs(q.x,q.y);svgedit.path.insertItemBefore(E,A,v);Ma.fixEnd(E);break}}}svgedit.browser.isWebkit()&&E.setAttribute("d",Ma.convertPath(E))},convertPath:function(E,A){for(var J=E.pathSegList,q=J.numberOfItems,v=0,w=0,z="",F=null,L=0;L<q;++L){var M=J.getItem(L),R=M.x||0,Z=M.y||0,da=M.x1||0,W=M.y1||0,ga=M.x2||0,ha=M.y2||0,X=M.pathSegType,
qa=Oa[X]["to"+(A?"Lower":"Upper")+"Case"](),za=function(Ea,Fa,Pa){Fa=Fa?" "+Fa.join(" "):"";Pa=Pa?" "+svgedit.units.shortFloat(Pa):"";$.each(Ea,function(Qa,Na){Ea[Qa]=svgedit.units.shortFloat(Na)});z+=qa+Ea.join(" ")+Fa+Pa};switch(X){case 1:z+="z";break;case 12:R-=v;case 13:if(A){v+=R;qa="l"}else{R+=v;v=R;qa="L"}za([[R,w]]);break;case 14:Z-=w;case 15:if(A){w+=Z;qa="l"}else{Z+=w;w=Z;qa="L"}za([[v,Z]]);break;case 2:case 4:case 18:R-=v;Z-=w;case 5:case 3:if(F&&J.getItem(L-1).pathSegType===1&&!A){v=F[0];
w=F[1]}case 19:if(A){v+=R;w+=Z}else{R+=v;Z+=w;v=R;w=Z}if(X===3)F=[v,w];za([[R,Z]]);break;case 6:R-=v;da-=v;ga-=v;Z-=w;W-=w;ha-=w;case 7:if(A){v+=R;w+=Z}else{R+=v;da+=v;ga+=v;Z+=w;W+=w;ha+=w;v=R;w=Z}za([[da,W],[ga,ha],[R,Z]]);break;case 8:R-=v;da-=v;Z-=w;W-=w;case 9:if(A){v+=R;w+=Z}else{R+=v;da+=v;Z+=w;W+=w;v=R;w=Z}za([[da,W],[R,Z]]);break;case 10:R-=v;Z-=w;case 11:if(A){v+=R;w+=Z}else{R+=v;Z+=w;v=R;w=Z}za([[M.r1,M.r2]],[M.angle,M.largeArcFlag?1:0,M.sweepFlag?1:0],[R,Z]);break;case 16:R-=v;ga-=v;Z-=
w;ha-=w;case 17:if(A){v+=R;w+=Z}else{R+=v;ga+=v;Z+=w;ha+=w;v=R;w=Z}za([[ga,ha],[R,Z]])}}return z}}}(),yb=this.removeUnusedDefElems=function(){var p=l.getElementsByTagNameNS(b,"defs");if(!p||!p.length)return 0;for(var s=[],u=0,D=["fill","stroke","filter","marker-start","marker-mid","marker-end"],B=D.length,K=l.getElementsByTagNameNS(b,"*"),E=K.length,A=0;A<E;A++){for(var J=K[A],q=0;q<B;q++)if(J){var v=ka(J.getAttribute(D[q]));v&&s.push(v.substr(1))}(J=ea(J))&&J.indexOf("#")===0&&s.push(J.substr(1))}p=
$(p).find("linearGradient, radialGradient, filter, marker, svg, symbol");defelem_ids=[];for(A=p.length;A--;){D=p[A];B=D.id;if(s.indexOf(B)<0){sb[B]=D;D.parentNode.removeChild(D);u++}}return u};this.svgCanvasToString=function(){for(;yb()>0;);Ma.clear(true);$.each(l.childNodes,function(u,D){u&&D.nodeType===8&&D.data.indexOf("Created with")>=0&&l.insertBefore(D,l.firstChild)});if(C){Eb();rb([C])}$("#canvasGrid").attr("display","none");var p=[];$(l).find("g:data(gsvg)").each(function(){for(var u=this.attributes,
D=u.length,B=0;B<D;B++)if(u[B].nodeName=="id"||u[B].nodeName=="style")D--;if(D<=0){u=this.firstChild;p.push(u);$(this).replaceWith(u)}});var s=this.svgToString(l,0);p.length&&$(p).each(function(){tb(this)});return s};this.svgToString=function(p,s){var u=[],D=svgedit.utilities.toXml,B=g.baseUnit,K=RegExp("^-?[\\d\\.]+"+B+"$");if(p){ia(p);var E=p.attributes,A,J,q=p.childNodes;for(J=0;J<s;J++)u.push(" ");u.push("<");u.push(p.nodeName);if(p.id==="svgcontent"){J=zb();if(B!=="px"){J.w=svgedit.units.convertUnit(J.w,
B)+B;J.h=svgedit.units.convertUnit(J.h,B)+B}u.push(' width="'+J.w+'" height="'+J.h+'" xmlns="'+b+'"');var v={};$(p).find("*").andSelf().each(function(){$.each(this.attributes,function(L,M){var R=M.namespaceURI;if(R&&!v[R]&&ta[R]!=="xmlns"&&ta[R]!=="xml"){v[R]=true;u.push(" xmlns:"+ta[R]+'="'+R+'"')}})});J=E.length;for(B=["width","height","xmlns","x","y","viewBox","id","overflow"];J--;){A=E.item(J);var w=D(A.nodeValue);if(A.nodeName.indexOf("xmlns:")!==0)if(w!=""&&B.indexOf(A.localName)==-1)if(!A.namespaceURI||
ta[A.namespaceURI]){u.push(" ");u.push(A.nodeName);u.push('="');u.push(w);u.push('"')}}}else{if(p.nodeName==="defs"&&!p.firstChild)return;var z=["-moz-math-font-style","_moz-math-font-style"];for(J=E.length-1;J>=0;J--){A=E.item(J);w=D(A.nodeValue);if(!(z.indexOf(A.localName)>=0))if(w!="")if(w.indexOf("pointer-events")!==0)if(!(A.localName==="class"&&w.indexOf("se_")===0)){u.push(" ");if(A.localName==="d")w=Ma.convertPath(p,true);if(isNaN(w)){if(K.test(w))w=svgedit.units.shortFloat(w)+B}else w=svgedit.units.shortFloat(w);
if($a.apply&&p.nodeName==="image"&&A.localName==="href"&&$a.images&&$a.images==="embed"){var F=Va[w];if(F)w=F}if(!A.namespaceURI||A.namespaceURI==b||ta[A.namespaceURI]){u.push(A.nodeName);u.push('="');u.push(w);u.push('"')}}}}if(p.hasChildNodes()){u.push(">");s++;E=false;for(J=0;J<q.length;J++){B=q.item(J);switch(B.nodeType){case 1:u.push("\n");u.push(this.svgToString(q.item(J),s));break;case 3:B=B.nodeValue.replace(/^\s+|\s+$/g,"");if(B!=""){E=true;u.push(D(B)+"")}break;case 4:u.push("\n");u.push(Array(s+
1).join(" "));u.push("<![CDATA[");u.push(B.nodeValue);u.push("]]\>");break;case 8:u.push("\n");u.push(Array(s+1).join(" "));u.push("<!--");u.push(B.data);u.push("--\>")}}s--;if(!E){u.push("\n");for(J=0;J<s;J++)u.push(" ")}u.push("</");u.push(p.nodeName);u.push(">")}else u.push("/>")}return u.join("")};this.embedImage=function(p,s){$(new Image).load(function(){var u=document.createElement("canvas");u.width=this.width;u.height=this.height;u.getContext("2d").drawImage(this,0,0);try{var D=";svgedit_url="+
encodeURIComponent(p);D=u.toDataURL().replace(";base64",D+";base64");Va[p]=D}catch(B){Va[p]=false}Ia=p;s&&s(Va[p])}).attr("src",p)};this.setGoodImage=function(p){Ia=p};this.open=function(){};this.save=function(p){Ca();p&&$.extend($a,p);$a.apply=true;p=this.svgCanvasToString();O("saved",p)};this.rasterExport=function(){Ca();var p=[],s={feGaussianBlur:kb.exportNoBlur,foreignObject:kb.exportNoforeignObject,"[stroke-dasharray]":kb.exportNoDashArray},u=$(l);if(!("font"in $("<canvas>")[0].getContext("2d")))s.text=
kb.exportNoText;$.each(s,function(D,B){u.find(D).length&&p.push(B)});s=this.svgCanvasToString();O("exported",{svg:s,issues:p})};this.getSvgString=function(){$a.apply=false;return this.svgCanvasToString()};this.randomizeIds=function(){arguments.length>0&&arguments[0]==false?svgedit.draw.randomizeIds(false,n()):svgedit.draw.randomizeIds(true,n())};var Hb=this.uniquifyElems=function(p){var s={},u=["filter","linearGradient","pattern","radialGradient","symbol","textPath","use"];svgedit.utilities.walkTree(p,
function(A){if(A.nodeType==1){if(A.id){A.id in s||(s[A.id]={elem:null,attrs:[],hrefs:[]});s[A.id].elem=A}$.each(vb,function(q,v){var w=A.getAttributeNode(v);if(w){var z=svgedit.utilities.getUrlFromAttr(w.value);if(z=z?z.substr(1):null){z in s||(s[z]={elem:null,attrs:[],hrefs:[]});s[z].attrs.push(w)}}});var J=svgedit.utilities.getHref(A);if(J&&u.indexOf(A.nodeName)>=0)if(J=J.substr(1)){J in s||(s[J]={elem:null,attrs:[],hrefs:[]});s[J].hrefs.push(A)}}});for(var D in s)if(D){var B=s[D].elem;if(B){p=
ma();B.id=p;B=s[D].attrs;for(var K=B.length;K--;){var E=B[K];E.ownerElement.setAttribute(E.name,"url(#"+p+")")}B=s[D].hrefs;for(K=B.length;K--;)svgedit.utilities.setHref(B[K],"#"+p)}}},Gb=this.setUseData=function(p){var s=$(p);if(p.tagName!=="use")s=s.find("use");s.each(function(){var u=ea(this).substr(1);if(u=pa(u)){$(this).data("ref",u);if(u.tagName=="symbol"||u.tagName=="svg")$(this).data("symbol",u).data("ref",u)}})},Ib=this.convertGradients=function(p){var s=$(p).find("linearGradient, radialGradient");
if(!s.length&&svgedit.browser.isWebkit())s=$(p).find("*").filter(function(){return this.tagName.indexOf("Gradient")>=0});s.each(function(){if($(this).attr("gradientUnits")==="userSpaceOnUse"){var u=$(l).find('[fill="url(#'+this.id+')"],[stroke="url(#'+this.id+')"]');if(u.length)if(u=svgedit.utilities.getBBox(u[0]))if(this.tagName==="linearGradient"){var D=$(this).attr(["x1","y1","x2","y2"]),B=this.gradientTransform.baseVal;if(B&&B.numberOfItems>0){var K=V(B).matrix;B=N(D.x1,D.y1,K);K=N(D.x2,D.y2,
K);D.x1=B.x;D.y1=B.y;D.x2=K.x;D.y2=K.y;this.removeAttribute("gradientTransform")}$(this).attr({x1:(D.x1-u.x)/u.width,y1:(D.y1-u.y)/u.height,x2:(D.x2-u.x)/u.width,y2:(D.y2-u.y)/u.height});this.removeAttribute("gradientUnits")}}})},Lb=this.convertToGroup=function(p){p||(p=G[0]);var s=$(p),u=new Aa,D;if(s.data("gsvg")){u=$(p.firstChild).attr(["x","y"]);$(p.firstChild.firstChild).unwrap();$(p).removeData("gsvg");D=Q(p);var B=k.createSVGTransform();B.setTranslate(u.x,u.y);D.appendItem(B);Ra(p);O("selected",
[p])}else if(s.data("symbol")){p=s.data("symbol");D=s.attr("transform");B=s.attr(["x","y"]);var K=p.getAttribute("viewBox");if(K){K=K.split(" ");B.x-=+K[0];B.y-=+K[1]}D+=" translate("+(B.x||0)+","+(B.y||0)+")";B=s.prev();u.addSubCommand(new Da(s[0],s[0].nextSibling,s[0].parentNode));s.remove();K=$(l).find("use:data(symbol)").length;s=h.createElementNS(b,"g");for(var E=p.childNodes,A=0;A<E.length;A++)s.appendChild(E[A].cloneNode(true));if(svgedit.browser.isGecko()){E=$(gb()).children("linearGradient,radialGradient,pattern").clone();
$(s).append(E)}D&&s.setAttribute("transform",D);D=p.parentNode;Hb(s);svgedit.browser.isGecko()&&$(gb()).append($(s).find("linearGradient,radialGradient,pattern"));s.id=ma();B.after(s);if(D){if(!K){B=p.nextSibling;D.removeChild(p);u.addSubCommand(new Da(p,B,D))}u.addSubCommand(new Ha(s))}Gb(s);svgedit.browser.isGecko()?Ib(gb()):Ib(s);svgedit.utilities.walkTreePost(s,function(J){try{Ra(J)}catch(q){console.log(q)}});$(s).find("a,circle,ellipse,foreignObject,g,image,line,path,polygon,polyline,rect,svg,text,tspan,use").each(function(){if(!this.id)this.id=
ma()});rb([s]);(p=Db(s,true))&&u.addSubCommand(p);xa(u)}else console.log("Unexpected element to ungroup:",p)};this.setSvgString=function(p){try{var s=svgedit.utilities.text2xml(p);this.prepareSvg(s);var u=new Aa("Change Source"),D=l.nextSibling,B=k.removeChild(l);u.addSubCommand(new Da(B,D,k));l=h.adoptNode?h.adoptNode(s.documentElement):h.importNode(s.documentElement,true);k.appendChild(l);var K=$(l);c.current_drawing_=new svgedit.draw.Drawing(l,o);var E=n().getNonce();E?O("setnonce",E):O("unsetnonce");
K.find("image").each(function(){var M=this;Fb(M);var R=ea(this);if(R.indexOf("data:")===0){var Z=R.match(/svgedit_url=(.*?);/);if(Z){var da=decodeURIComponent(Z[1]);$(new Image).load(function(){M.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",da)}).attr("src",da)}}c.embedImage(R)});K.find("svg").each(function(){if(!$(this).closest("defs").length){Hb(this);var M=this.parentNode;if(M.childNodes.length===1&&M.nodeName==="g"){$(M).data("gsvg",this);M.id=M.id||ma()}else tb(this)}});K.find("linearGradient, radialGradient, pattern").appendTo(gb());
Gb(K);Ib(K[0]);svgedit.utilities.walkTreePost(l,function(M){try{Ra(M)}catch(R){console.log(R)}});var A={id:"svgcontent",overflow:g.show_outside_canvas?"visible":"hidden"},J=false;if(K.attr("viewBox")){var q=K.attr("viewBox").split(" ");A.width=q[2];A.height=q[3]}else $.each(["width","height"],function(M,R){var Z=K.attr(R);Z||(Z="100%");if((Z+"").substr(-1)==="%")J=true;else A[R]=sa(R,Z)});xb();K.children().find("a,circle,ellipse,foreignObject,g,image,line,path,polygon,polyline,rect,svg,text,tspan,use").each(function(){if(!this.id)this.id=
ma()});if(J){var v=getStrokedBBox();A.width=v.width+v.x;A.height=v.height+v.y}if(A.width<=0)A.width=200;if(A.height<=0)A.height=200;K.attr(A);this.contentW=A.width;this.contentH=A.height;$("#canvas_width").val(this.contentW);$("#canvas_height").val(this.contentH);var w=$("#canvas_background");if(w.length){var z=w.attr("fill-opacity");z=z?parseInt(z)*100:100;fill=this.getPaint(w.attr("fill"),z,"canvas")}else fill=this.getPaint("none",100,"canvas");methodDraw.paintBox.canvas.setPaint(fill);u.addSubCommand(new Ha(l));
var F=K.attr(["width","height"]);u.addSubCommand(new Ka(k,F));m=1;svgedit.transformlist.resetListMap();Ca();svgedit.path.clearData();k.appendChild(ua.selectorParentGroup);xa(u);O("changed",[l])}catch(L){console.log(L);return false}return true};this.getPaint=function(p,s,u){var D=null;if(p.indexOf("url(#")===0){p=(p=svgCanvas.getRefElem(p))?p.cloneNode(true):$("#"+u+"_color defs *")[0];D={alpha:s};D[p.tagName]=p}else D=p.indexOf("#")===0?{alpha:s,solidColor:p.substr(1)}:{alpha:s,solidColor:"none"};
return new $.jGraduate.Paint(D)};this.importSvgString=function(p){try{var s=svgedit.utilities.encode64(p.length+p).substr(0,32),u=false;if(lb[s])if($(lb[s].symbol).parents("#svgroot").length)u=true;var D=new Aa("Import SVG");if(u)var B=lb[s].symbol,K=lb[s].xform;else{var E=svgedit.utilities.text2xml(p);this.prepareSvg(E);var A;A=h.adoptNode?h.adoptNode(E.documentElement):h.importNode(E.documentElement,true);Hb(A);var J=sa("width",A.getAttribute("width")),q=sa("height",A.getAttribute("height")),v=
A.getAttribute("viewBox"),w=v?v.split(" "):[0,0,J,q];for(p=0;p<4;++p)w[p]=+w[p];l.getAttribute("width");var z=+l.getAttribute("height");K=q>J?"scale("+z/3/w[3]+")":"scale("+z/3/w[2]+")";K="translate(0) "+K+" translate(0)";B=h.createElementNS(b,"symbol");var F=gb();for(svgedit.browser.isGecko()&&$(A).find("linearGradient, radialGradient, pattern").appendTo(F);A.firstChild;)B.appendChild(A.firstChild);var L=A.attributes;for(A=0;A<L.length;A++){var M=L[A];B.setAttribute(M.nodeName,M.nodeValue)}B.id=
ma();lb[s]={symbol:B,xform:K};gb().appendChild(B);D.addSubCommand(new Ha(B))}var R=h.createElementNS(b,"use");R.id=ma();U(R,"#"+B.id);(C||n().getCurrentLayer()).appendChild(R);D.addSubCommand(new Ha(R));Ca();R.setAttribute("transform",K);Ra(R);$(R).data("symbol",B).data("ref",B);qb([R]);xa(D);O("changed",[l])}catch(Z){console.log(Z);return false}return true};var xb=c.identifyLayers=function(){Eb();n().identifyLayers()};this.createLayer=function(p){var s=new Aa("Create Layer");p=n().createLayer(p);
s.addSubCommand(new Ha(p));xa(s);Ca();O("changed",[p])};this.cloneLayer=function(p){var s=new Aa("Duplicate Layer"),u=h.createElementNS(b,"g"),D=h.createElementNS(b,"title");D.textContent=p;u.appendChild(D);D=n().getCurrentLayer();$(D).after(u);D=D.childNodes;for(var B=0;B<D.length;B++){var K=D[B];K.localName!="title"&&u.appendChild(la(K))}Ca();xb();s.addSubCommand(new Ha(u));xa(s);c.setCurrentLayer(p);O("changed",[u])};this.deleteCurrentLayer=function(){var p=n().getCurrentLayer(),s=p.nextSibling,
u=p.parentNode;if(p=n().deleteCurrentLayer()){var D=new Aa("Delete Layer");D.addSubCommand(new Da(p,s,u));xa(D);Ca();O("changed",[u]);return true}return false};this.setCurrentLayer=function(p){(p=n().setCurrentLayer(svgedit.utilities.toXml(p)))&&Ca();return p};this.renameCurrentLayer=function(p){var s=n();if(s.current_layer){var u=s.current_layer;if(!c.setCurrentLayer(p)){for(var D=new Aa("Rename Layer"),B=0;B<s.getNumLayers();++B)if(s.all_layers[B][1]==u)break;var K=s.getLayerName(B);s.all_layers[B][0]=
svgedit.utilities.toXml(p);var E=u.childNodes.length;for(B=0;B<E;++B){var A=u.childNodes.item(B);if(A&&A.tagName=="title"){for(;A.firstChild;)A.removeChild(A.firstChild);A.textContent=p;D.addSubCommand(new Ka(A,{"#text":K}));xa(D);O("changed",[u]);return true}}}s.current_layer=u}return false};this.setCurrentLayerPosition=function(p){var s=n();if(s.current_layer&&p>=0&&p<s.getNumLayers()){for(var u=0;u<s.getNumLayers();++u)if(s.all_layers[u][1]==s.current_layer)break;if(u==s.getNumLayers())return false;
if(u!=p){var D=null,B=s.current_layer.nextSibling;if(p>u){if(p<s.getNumLayers()-1)D=s.all_layers[p+1][1]}else D=s.all_layers[p][1];l.insertBefore(s.current_layer,D);xa(new ra(s.current_layer,B,l));xb();c.setCurrentLayer(s.getLayerName(p));return true}}return false};this.setLayerVisibility=function(p,s){var u=n(),D=u.getLayerVisibility(p),B=u.setLayerVisibility(p,s);if(B)xa(new Ka(B,{display:D?"inline":"none"},"Layer Visibility"));else return false;if(B==u.getCurrentLayer()){Ca();Ma.clear()}return true};
this.moveSelectedToLayer=function(p){for(var s=null,u=n(),D=0;D<u.getNumLayers();++D)if(u.getLayerName(D)==p){s=u.all_layers[D][1];break}if(!s)return false;p=new Aa("Move Elements to Layer");u=G;for(D=u.length;D--;){var B=u[D];if(B){var K=B.nextSibling,E=B.parentNode;s.appendChild(B);p.addSubCommand(new ra(B,K,E))}}xa(p);return true};this.mergeLayer=function(p){var s=new Aa("Merge Layer"),u=n(),D=$(u.current_layer).prev()[0];if(D){for(s.addSubCommand(new Da(u.current_layer,u.current_layer.nextSibling,
l));u.current_layer.firstChild;){var B=u.current_layer.firstChild;if(B.localName=="title"){s.addSubCommand(new Da(B,B.nextSibling,u.current_layer));u.current_layer.removeChild(B)}else{var K=B.nextSibling;D.appendChild(B);s.addSubCommand(new ra(B,K,u.current_layer))}}l.removeChild(u.current_layer);if(!p){Ca();xb();O("changed",[l]);xa(s)}u.current_layer=D;return s}};this.mergeAllLayers=function(){var p=new Aa("Merge all Layers"),s=n();for(s.current_layer=s.all_layers[s.getNumLayers()-1][1];$(l).children("g").length>
1;)p.addSubCommand(c.mergeLayer(true));Ca();xb();O("changed",[l]);xa(p)};var Eb=this.leaveContext=function(){var p=ya.length;if(p){for(var s=0;s<p;s++){var u=ya[s],D=cb(u,"orig_opac");D!==1?u.setAttribute("opacity",D):u.removeAttribute("opacity");u.setAttribute("style","pointer-events: inherit")}ya=[];Ca(true);O("contextset",null)}C=null},Kb=this.setContext=function(p){Eb();if(typeof p==="string")p=pa(p);C=p;$(p).parentsUntil("#svgcontent").andSelf().siblings().each(function(){var s=this.getAttribute("opacity")||
1;cb(this,"orig_opac",s);this.setAttribute("opacity",s*0.33);this.setAttribute("style","pointer-events: none");ya.push(this)});Ca();O("contextset",C)};this.clear=function(){Ma.clear();Ca();c.clearSvgContentElement();c.current_drawing_=new svgedit.draw.Drawing(l);c.createLayer("Layer 1");c.undoMgr.resetUndoStack();ua.initGroup();va=ua.getRubberBandBox();O("cleared")};this.linkControlPoints=Ma.linkControlPoints;this.getContentElem=function(){return l};this.getRootElem=function(){return k};this.getSelectedElems=
function(){return G};var zb=this.getResolution=function(){var p=l.getAttribute("width")/m,s=l.getAttribute("height")/m;return{w:p,h:s,zoom:m}};this.getZoom=function(){return m};this.getVersion=function(){return"svgcanvas.js ($Rev: 2082 $)"};this.setUiStrings=function(p){$.extend(kb,p.notification)};this.setConfig=function(p){$.extend(g,p)};this.getTitle=function(p){if(p=p||G[0]){p=$(p).data("gsvg")||$(p).data("symbol")||p;p=p.childNodes;for(var s=0;s<p.length;s++)if(p[s].nodeName=="title")return p[s].textContent;
return""}};this.setGroupTitle=function(p){var s=G[0];s=$(s).data("gsvg")||s;var u=$(s).children("title"),D=new Aa("Set Label");if(p.length)if(u.length){u=u[0];D.addSubCommand(new Ka(u,{"#text":u.textContent}));u.textContent=p}else{u=h.createElementNS(b,"title");u.textContent=p;$(s).prepend(u);D.addSubCommand(new Ha(u))}else{D.addSubCommand(new Da(u[0],u.nextSibling,s));u.remove()}xa(D)};this.getDocumentTitle=function(){return c.getTitle(l)};this.setDocumentTitle=function(p){for(var s=l.childNodes,
u=false,D="",B=new Aa("Change Image Title"),K=0;K<s.length;K++)if(s[K].nodeName=="title"){u=s[K];D=u.textContent;break}if(!u){u=h.createElementNS(b,"title");l.insertBefore(u,l.firstChild)}if(p.length)u.textContent=p;else u.parentNode.removeChild(u);B.addSubCommand(new Ka(u,{"#text":D}));xa(B)};this.getEditorNS=function(p){p&&l.setAttribute("xmlns:se","http://svg-edit.googlecode.com");return"http://svg-edit.googlecode.com"};this.setResolution=function(p,s){var u=zb(),D=u.w;u=u.h;var B;if(p=="fit"){var K=
getStrokedBBox();if(K){B=new Aa("Fit Canvas to Content");var E=pb();qb(E);var A=[],J=[];$.each(E,function(){A.push(K.x*-1);J.push(K.y*-1)});E=c.moveSelectedElements(A,J,true);B.addSubCommand(E);Ca();p=Math.round(K.width);s=Math.round(K.height)}else return false}if(p!=D||s!=u){E=k.suspendRedraw(1E3);B||(B=new Aa("Change Image Dimensions"));p=sa("width",p);s=sa("height",s);l.setAttribute("width",p);l.setAttribute("height",s);this.contentW=p;this.contentH=s;B.addSubCommand(new Ka(l,{width:D,height:u}));
l.setAttribute("viewBox",[0,0,p/m,s/m].join(" "));B.addSubCommand(new Ka(l,{viewBox:["0 0",D,u].join(" ")}));xa(B);k.unsuspendRedraw(E);if(background=document.getElementById("canvas_background")){background.setAttribute("x",-1);background.setAttribute("y",-1);background.setAttribute("width",p+2);background.setAttribute("height",s+2)}O("changed",[l])}return[p,s]};this.getOffset=function(){return $(l).attr(["x","y"])};this.setBBoxZoom=function(p,s,u){var D=0.85,B=function(K){if(!K)return false;var E=
Math.min(Math.round(s/K.width*100*D)/100,Math.round(u/K.height*100*D)/100);c.setZoom(E);return{zoom:E,bbox:K}};if(typeof p=="object"){p=p;if(p.width==0||p.height==0){c.setZoom(p.zoom?p.zoom:m*p.factor);return{zoom:m,bbox:p}}return B(p)}switch(p){case "selection":if(!G[0])return;p=$.map(G,function(K){if(K)return K});p=getStrokedBBox(p);break;case "canvas":p=zb();D=0.95;p={width:p.w,height:p.h,x:0,y:0};break;case "content":p=getStrokedBBox();break;case "layer":p=getStrokedBBox(pb(n().getCurrentLayer()));
break;default:return}return B(p)};this.setZoom=function(p){var s=zb();l.setAttribute("viewBox","0 0 "+s.w/p+" "+s.h/p);m=p;$.each(G,function(u,D){D&&ua.requestSelector(D).resize()});Ma.zoomChange();ib("zoomChanged",p)};this.getMode=function(){return Ja};this.setMode=function(p){Ma.clear();bb.clear();$("#workarea").attr("class",p);Xa=G[0]&&G[0].nodeName=="text"?Ua:H;Ja=p};this.getColor=function(p){return Xa[p]};this.setColor=function(p,s,u){H[p]=s;Xa[p+"_paint"]={type:"solidColor"};for(var D=[],B=
G.length;B--;){var K=G[B];if(K)if(K.tagName=="g")svgedit.utilities.walkTree(K,function(E){E.nodeName!="g"&&D.push(E)});else if(p=="fill")K.tagName!="polyline"&&K.tagName!="line"&&D.push(K);else D.push(K)}if(D.length>0)if(u)Ab(p,s,D);else{Ya(p,s,D);O("changed",D)}};var gb=function(){var p=l.getElementsByTagNameNS(b,"defs");if(p.length>0)p=p[0];else{p=h.createElementNS(b,"defs");l.firstChild?l.insertBefore(p,l.firstChild.nextSibling):l.appendChild(p)}return p},Nb=this.setGradient=function(p){if(!(!Xa[p+
"_paint"]||Xa[p+"_paint"].type=="solidColor")){var s=c[p+"Grad"],u=Mb(s),D=gb();if(u)s=u;else{s=D.appendChild(h.importNode(s,true));s.id=ma()}c.setColor(p,"url(#"+s.id+")");if(p=="canvas")(p=document.getElementById("canvas_background"))&&p.setAttribute("fill","url(#"+s.id+")")}},Mb=function(p){var s=gb();s=$(s).find("linearGradient, radialGradient");for(var u=s.length,D=["r","cx","cy","fx","fy"];u--;){var B=s[u];if(p.tagName=="linearGradient"){if(p.getAttribute("x1")!=B.getAttribute("x1")||p.getAttribute("y1")!=
B.getAttribute("y1")||p.getAttribute("x2")!=B.getAttribute("x2")||p.getAttribute("y2")!=B.getAttribute("y2"))continue}else{var K=$(p).attr(D),E=$(B).attr(D),A=false;$.each(D,function(F,L){if(K[L]!=E[L])A=true});if(A)continue}var J=p.getElementsByTagNameNS(b,"stop"),q=B.getElementsByTagNameNS(b,"stop");if(J.length==q.length){for(var v=J.length;v--;){var w=J[v],z=q[v];if(w.getAttribute("offset")!=z.getAttribute("offset")||w.getAttribute("stop-opacity")!=z.getAttribute("stop-opacity")||w.getAttribute("stop-color")!=
z.getAttribute("stop-color"))break}if(v==-1)return B}}return null};this.setPaint=function(p,s){var u=new $.jGraduate.Paint(s);this.setPaintOpacity(p,u.alpha/100,true);Xa[p+"_paint"]=u;switch(u.type){case "solidColor":if(u.solidColor!="none"&&u.solidColor!="#none")this.setColor(p,"#"+u.solidColor);else{this.setColor(p,"none");document.querySelector(p=="fill"?"#fill_color rect":"#stroke_color rect").setAttribute("fill","none")}break;case "linearGradient":case "radialGradient":c[p+"Grad"]=u[u.type];
Nb(p)}};this.getStrokeWidth=function(){return Xa.stroke_width};this.setStrokeWidth=function(p){if(p==0&&["line","path"].indexOf(Ja)>=0)c.setStrokeWidth(1);else{Xa.stroke_width=p;for(var s=[],u=G.length;u--;){var D=G[u];if(D)D.tagName=="g"?svgedit.utilities.walkTree(D,function(B){B.nodeName!="g"&&s.push(B)}):s.push(D)}if(s.length>0){Ya("stroke-width",p,s);O("changed",G)}}};this.setStrokeAttr=function(p,s){H[p.replace("-","_")]=s;for(var u=[],D=G.length;D--;){var B=G[D];if(B)B.tagName=="g"?svgedit.utilities.walkTree(B,
function(K){K.nodeName!="g"&&u.push(K)}):u.push(B)}if(u.length>0){Ya(p,s,u);O("changed",G)}};this.getStyle=function(){return H};this.getOpacity=function(){return H.opacity};this.setOpacity=function(p){H.opacity=p;Ya("opacity",p)};this.getFillOpacity=function(){return H.fill_opacity};this.getStrokeOpacity=function(){return H.stroke_opacity};this.setPaintOpacity=function(p,s,u){H[p+"_opacity"]=s;u?Ab(p+"-opacity",s):Ya(p+"-opacity",s)};this.getBlur=function(p){var s=0;if(p)if(p.getAttribute("filter"))if(p=
pa(p.id+"_blur"))s=p.firstChild.getAttribute("stdDeviation");return s};(function(){function p(){var B=c.undoMgr.finishUndoableChange();s.addSubCommand(B);xa(s);u=s=null}var s=null,u=null,D=false;c.setBlurNoUndo=function(B){if(u)if(B===0){Ab("filter","");D=true}else{var K=G[0];D&&Ab("filter","url(#"+K.id+"_blur)");if(svgedit.browser.isWebkit()){K.removeAttribute("filter");K.setAttribute("filter","url(#"+K.id+"_blur)")}Ab("stdDeviation",B,[u.firstChild]);c.setBlurOffsets(u,B)}else c.setBlur(B)};c.setBlurOffsets=
function(B,K){if(K>3)na(B,{x:"-50%",y:"-50%",width:"200%",height:"200%"},100);else if(!svgedit.browser.isWebkit()){B.removeAttribute("x");B.removeAttribute("y");B.removeAttribute("width");B.removeAttribute("height")}};c.setBlur=function(B,K){if(s)p();else{var E=G[0],A=E.id;u=pa(A+"_blur");B-=0;var J=new Aa;if(u){if(B===0)u=null}else{var q=P({element:"feGaussianBlur",attr:{"in":"SourceGraphic",stdDeviation:B}});u=P({element:"filter",attr:{id:A+"_blur"}});u.appendChild(q);gb().appendChild(u);J.addSubCommand(new Ha(u))}q=
{filter:E.getAttribute("filter")};if(B===0){E.removeAttribute("filter");J.addSubCommand(new Ka(E,q))}else{Ya("filter","url(#"+A+"_blur)");J.addSubCommand(new Ka(E,q));c.setBlurOffsets(u,B);s=J;c.undoMgr.beginUndoableChange("stdDeviation",[u?u.firstChild:null]);if(K){c.setBlurNoUndo(B);p()}}}}})();this.getBold=function(){var p=true;G.filter(Boolean).forEach(function(s){if(s.getAttribute("font-weight")!="bold")p=false});return p};this.setBold=function(p){var s=G.filter(Boolean);s.forEach(function(u){if(u!=
null&&u.tagName=="text")Ya("font-weight",p?"bold":"normal")});s[0].textContent||bb.setCursor()};this.getItalic=function(){var p=true;G.filter(Boolean).forEach(function(s){if(s.getAttribute("font-style")!="italic")p=false});return p};this.setItalic=function(p){var s=G.filter(Boolean);s.forEach(function(u){if(u!=null&&u.tagName=="text")Ya("font-style",p?"italic":"normal")});s[0].textContent||bb.setCursor()};this.getFontFamily=function(){return Ua.font_family};this.setFontFamily=function(p){Ua.font_family=
p;Ya("font-family",p);G[0]&&!G[0].textContent&&bb.setCursor()};this.setFontColor=function(p){Ua.fill=p;Ya("fill",p)};this.getFontSize=function(){return Ua.fill};this.getFontSize=function(){return Ua.font_size};this.setFontSize=function(p){Ua.font_size=p;Ya("font-size",p);G[0].textContent||bb.setCursor()};this.getText=function(){var p=G[0];if(p==null)return"";return p.textContent};this.setTextContent=function(p){Ya("#text",p);bb.init(p);bb.setCursor()};this.setImageURL=function(p){var s=G[0];if(s){var u=
$(s).attr(["width","height"]);u=!u.width||!u.height;var D=ea(s);if(D!==p)u=true;else if(!u)return;var B=new Aa("Change Image URL");U(s,p);B.addSubCommand(new Ka(s,{"#href":D}));u?$(new Image).load(function(){var K=$(s).attr(["width","height"]);$(s).attr({width:this.width,height:this.height});ua.requestSelector(s).resize();B.addSubCommand(new Ka(s,K));xa(B);O("changed",[s])}).attr("src",p):xa(B)}};this.setLinkURL=function(p){var s=G[0];if(s){if(s.tagName!=="a"){s=$(s).parents("a");if(s.length)s=s[0];
else return}var u=ea(s);if(u!==p){var D=new Aa("Change Link URL");U(s,p);D.addSubCommand(new Ka(s,{"#href":u}));xa(D)}}};this.elementsAreSame=function(p){return!p.length||p[0]==null?null:G.every(function(s){return s&&G[0]?s.nodeName==G[0].nodeName:null})};this.setRectRadius=function(p){c.elementsAreSame(G)&&G[0].tagName=="rect"&&G.forEach(function(s){var u=s.getAttribute("rx");if(u!=p){s.setAttribute("rx",p);s.setAttribute("ry",p);xa(new Ka(s,{rx:u,ry:u},"Radius"));O("changed",[s])}})};this.makeHyperlink=
function(p){c.groupSelectedElements("a",p)};this.removeHyperlink=function(){c.ungroupSelectedElement()};this.setSegType=function(p){Ma.setSegType(p)};this.convertToPath=function(p,s){if(p==null)$.each(G,function(da,W){W&&c.convertToPath(W)});else{if(!s)var u=new Aa("Convert element to Path");var D=s?{}:{fill:H.fill,"fill-opacity":H.fill_opacity,stroke:H.stroke,"stroke-width":H.stroke_width,"stroke-dasharray":H.stroke_dasharray,"stroke-linejoin":H.stroke_linejoin,"stroke-linecap":H.stroke_linecap,
"stroke-opacity":H.stroke_opacity,opacity:H.opacity,visibility:"hidden"};$.each(["marker-start","marker-end","marker-mid","filter","clip-path"],function(){if(p.getAttribute(this))D[this]=p.getAttribute(this)});var B=P({element:"path",attr:D}),K=p.getAttribute("transform");K&&B.setAttribute("transform",K);var E=p.id,A=p.parentNode;p.nextSibling?A.insertBefore(B,p):A.appendChild(B);var J="",q=function(da){$.each(da,function(W,ga){var ha=ga[1];J+=ga[0];for(var X=0;X<ha.length;X+=2)J+=ha[X]+","+ha[X+
1]+" "})},v=1.81;switch(p.tagName){case "ellipse":case "circle":var w=$(p).attr(["rx","ry","cx","cy"]),z=w.cx,F=w.cy,L=w.rx;w=w.ry;if(p.tagName=="circle")L=w=$(p).attr("r");q([["M",[z-L,F]],["C",[z-L,F-w/v,z-L/v,F-w,z,F-w]],["C",[z+L/v,F-w,z+L,F-w/v,z+L,F]],["C",[z+L,F+w/v,z+L/v,F+w,z,F+w]],["C",[z-L/v,F+w,z-L,F+w/v,z-L,F]],["Z",[]]]);break;case "path":J=p.getAttribute("d");break;case "line":w=$(p).attr(["x1","y1","x2","y2"]);J="M"+w.x1+","+w.y1+"L"+w.x2+","+w.y2;break;case "polyline":case "polygon":J=
"M"+p.getAttribute("points");break;case "rect":w=$(p).attr(["rx","ry"]);L=w.rx;w=w.ry;var M=p.getBBox();z=M.x;F=M.y;var R=M.width;M=M.height;v=4-v;if(!L&&!w)q([["M",[z,F]],["L",[z+R,F]],["L",[z+R,F+M]],["L",[z,F+M]],["L",[z,F]],["Z",[]]]);else{w||(w=L);q([["M",[z,F+w]],["C",[z,F+w/v,z+L/v,F,z+L,F]],["L",[z+R-L,F]],["C",[z+R-L/v,F,z+R,F+w/v,z+R,F+w]],["L",[z+R,F+M-w]],["C",[z+R,F+M-w/v,z+R-L/v,F+M,z+R-L,F+M]],["L",[z+L,F+M]],["C",[z+L/v,F+M,z,F+M-w/v,z,F+M-w]],["L",[z,F+w]],["Z",[]]])}break;default:B.parentNode.removeChild(B)}J&&
B.setAttribute("d",J);if(s){Ma.resetOrientation(B);u=false;try{u=B.getBBox()}catch(Z){}B.parentNode.removeChild(B);return u}else{if(K){K=Q(B);ja(K)&&Ma.resetOrientation(B)}u.addSubCommand(new Da(p,p.nextSibling,A));u.addSubCommand(new Ha(B));Ca();p.parentNode.removeChild(p);B.setAttribute("id",E);B.removeAttribute("visibility");qb([B],true);xa(u)}}};var Ab=this.changeSelectedAttributeNoUndo=function(p,s,u){var D=k.suspendRedraw(1E3);Ja=="pathedit"&&Ma.moveNode(p,s);u=u||G;for(var B=u.length,K=["g",
"polyline","path"];B--;){var E=u[B];if(E!=null){Ja==="textedit"&&p!=="#text"&&E.textContent.length&&bb.toSelectMode(E);if((p==="x"||p==="y")&&K.indexOf(E.tagName)>=0){var A=getStrokedBBox([E]);c.moveSelectedElements((p==="x"?s-A.x:0)*m,(p==="y"?s-A.y:0)*m,true)}else{A=p==="#text"?E.textContent:E.getAttribute(p);if(A==null)A="";if(A!==String(s)){if(p=="#text"){svgedit.utilities.getBBox(E);E.textContent=s}else p=="#href"?U(E,s):E.setAttribute(p,s);G.indexOf(E)>=0&&setTimeout(function(){E.parentNode&&
ua.requestSelector(E).resize()},0);A=oa(E);if(A!=0&&p!="transform")for(var J=Q(E),q=J.numberOfItems;q--;)if(J.getItem(q).type==4){J.removeItem(q);var v=svgedit.utilities.getBBox(E),w=N(v.x+v.width/2,v.y+v.height/2,V(J).matrix);v=w.x;w=w.y;var z=k.createSVGTransform();z.setRotate(A,v,w);J.insertItemBefore(z,q);break}}}}}k.unsuspendRedraw(D)},Ya=this.changeSelectedAttribute=function(p,s,u){u=u||G;c.undoMgr.beginUndoableChange(p,u);Ab(p,s,u);p=c.undoMgr.finishUndoableChange();p.isEmpty()||xa(p)};this.deleteSelectedElements=
function(){for(var p=new Aa("Delete Elements"),s=G.length,u=[],D=0;D<s;++D){var B=G[D];if(B==null)break;var K=B.parentNode,E=B;ua.releaseSelector(E);svgedit.path.removePath_(E.id);if(K.tagName==="a"&&K.childNodes.length===1){E=K;K=K.parentNode}var A=E.nextSibling;E=K.removeChild(E);u.push(B);G[D]=null;p.addSubCommand(new Da(E,A,K))}p.isEmpty()||xa(p);O("changed",u);Ca()};this.cutSelectedElements=function(){for(var p=new Aa("Cut Elements"),s=G.length,u=[],D=0;D<s;++D){var B=G[D];if(B==null)break;var K=
B.parentNode,E=B;ua.releaseSelector(E);svgedit.path.removePath_(E.id);var A=E.nextSibling;E=K.removeChild(E);u.push(B);G[D]=null;p.addSubCommand(new Da(E,A,K))}p.isEmpty()||xa(p);O("changed",u);Ca();c.clipBoard=u};this.copySelectedElements=function(){c.clipBoard=$.merge([],G)};this.pasteElements=function(){var p=c.clipBoard,s=p.length;if(s){for(var u=[],D=new Aa("Paste elements");s--;){var B=p[s];if(B){var K=la(B);if(!pa(B.id))K.id=B.id;u.push(K);(C||n().getCurrentLayer()).appendChild(K);D.addSubCommand(new Ha(K))}}svgCanvas.clearSelection();
setTimeout(function(){rb(u)},100);xa(D);O("changed",u)}};this.groupSelectedElements=function(p){p||(p="g");var s="";switch(p){case "a":s="Make hyperlink";var u="";if(arguments.length>1)u=arguments[1];break;default:p="g";s="Group Elements"}s=new Aa(s);var D=P({element:p,attr:{id:ma()}});p==="a"&&U(D,u);s.addSubCommand(new Ha(D));for(u=G.length;u--;){var B=G[u];if(B!=null){if(B.parentNode.tagName==="a"&&B.parentNode.childNodes.length===1)B=B.parentNode;var K=B.nextSibling,E=B.parentNode;D.appendChild(B);
s.addSubCommand(new ra(B,K,E))}}s.isEmpty()||xa(s);rb([D],true)};var Db=this.pushGroupProperties=function(p,s){var u=p.childNodes,D=u.length,B=p.getAttribute("transform"),K=Q(p),E=V(K).matrix,A=new Aa("Push group properties"),J=0,q=oa(p),v=$(p).attr(["filter","opacity"]),w,z;for(J=0;J<D;J++){var F=u[J];if(F.nodeType===1){if(v.opacity!==null&&v.opacity!==1){F.getAttribute("opacity");var L=Math.round((F.getAttribute("opacity")||1)*v.opacity*100)/100;Ya("opacity",L,[F])}if(v.filter){var M=L=this.getBlur(F);
z||(z=this.getBlur(p));if(L)L=z-0+(L-0);else if(L===0)L=z;if(M)w=S(F.getAttribute("filter"));else if(w){w=la(w);gb().appendChild(w)}else w=S(v.filter);w.id=F.id+"_"+(w.firstChild.tagName==="feGaussianBlur"?"blur":"filter");Ya("filter","url(#"+w.id+")",[F]);if(L){Ya("stdDeviation",L,[w.firstChild]);c.setBlurOffsets(w,L)}}L=Q(F);if(~F.tagName.indexOf("Gradient"))L=null;if(L)if(F.tagName!=="defs")if(K.numberOfItems){if(q&&K.numberOfItems==1){var R=K.getItem(0).matrix,Z=k.createSVGMatrix();if(M=oa(F))Z=
L.getItem(0).matrix;var da=svgedit.utilities.getBBox(F),W=V(L).matrix,ga=N(da.x+da.width/2,da.y+da.height/2,W);da=q+M;W=k.createSVGTransform();W.setRotate(da,ga.x,ga.y);R=ba(R,Z,W.matrix.inverse());M&&L.removeItem(0);if(da)L.numberOfItems?L.insertItemBefore(W,0):L.appendItem(W);if(R.e||R.f){M=k.createSVGTransform();M.setTranslate(R.e,R.f);L.numberOfItems?L.insertItemBefore(M,0):L.appendItem(M)}}else{M=F.getAttribute("transform");R={};R.transform=M?M:"";M=k.createSVGTransform();R=V(L).matrix;Z=R.inverse();
R=ba(Z,E,R);M.setMatrix(R);L.appendItem(M)}(F=Ra(F))&&A.addSubCommand(F)}}}if(B){R={};R.transform=B;p.setAttribute("transform","");p.removeAttribute("transform");A.addSubCommand(new Ka(p,R))}if(s&&!A.isEmpty())return A};this.ungroupSelectedElement=function(){var p=G[0];if($(p).data("gsvg")||$(p).data("symbol"))Lb(p);else if(p.tagName==="use"){var s=pa(ea(p).substr(1));$(p).data("symbol",s).data("ref",s);Lb(p)}else{s=$(p).parents("a");if(s.length)p=s[0];if(p.tagName==="g"||p.tagName==="a"){s=new Aa("Ungroup Elements");
var u=Db(p,true);u&&s.addSubCommand(u);u=p.parentNode;for(var D=p.nextSibling,B=Array(p.childNodes.length),K=0;p.firstChild;){var E=p.firstChild,A=E.nextSibling,J=E.parentNode;if(E.tagName==="title"){s.addSubCommand(new Da(E,E.nextSibling,J));J.removeChild(E)}else{B[K++]=E=u.insertBefore(E,D);s.addSubCommand(new ra(E,A,J))}}Ca();D=p.nextSibling;p=u.removeChild(p);s.addSubCommand(new Da(p,D,u));s.isEmpty()||xa(s);qb(B)}}};this.moveToTopSelectedElement=function(){var p=G.filter(Boolean).reverse(),s=
new Aa("Move to top");p.forEach(function(u){u=u;var D=u.parentNode,B=u.nextSibling;u=u.parentNode.appendChild(u);if(B!=u.nextSibling){s.addSubCommand(new ra(u,B,D,"top"));O("changed",[u])}s.isEmpty()||xa(s)})};this.moveToBottomSelectedElement=function(){var p=G.filter(Boolean).reverse(),s=new Aa("Move to top");p.forEach(function(u){u=u;var D=u.parentNode,B=u.nextSibling,K=u.parentNode.firstChild;if(K.tagName=="title")K=K.nextSibling;if(K.tagName=="defs")K=K.nextSibling;u=u.parentNode.insertBefore(u,
K);if(B!=u.nextSibling){s.addSubCommand(new ra(u,B,D,"bottom"));O("changed",[u])}});s.isEmpty()||xa(s)};this.moveUpDownSelected=function(p){var s=G.filter(Boolean);p=="Down"&&s.reverse();var u=new Aa("Move "+p);s.forEach(function(D){hb=[];var B,K,E=$(ob(getStrokedBBox([D]))).toArray();p=="Down"&&E.reverse();$.each(E,function(){if(K){B=this;return false}else if(this==D)K=true});if(B){E=D.parentNode;var A=D.nextSibling;$(B)[p=="Down"?"before":"after"](D);if(A!=D.nextSibling){u.addSubCommand(new ra(D,
A,E,"Move "+p));O("changed",[D])}}});u.isEmpty()||xa(u)};this.moveSelectedElements=function(p,s,u){if(p.constructor!=Array){p/=m;s/=m}u=u||true;for(var D=new Aa("position"),B=G.length;B--;){var K=G[B];if(K!=null){var E=k.createSVGTransform(),A=Q(K);p.constructor==Array?E.setTranslate(p[B],s[B]):E.setTranslate(p,s);A.numberOfItems?A.insertItemBefore(E,0):A.appendItem(E);(E=Ra(K))&&D.addSubCommand(E);ua.requestSelector(K).resize()}}if(!D.isEmpty()){u&&xa(D);O("changed",G);return D}};this.cloneSelectedElements=
function(p,s,u){for(var D=new Aa("Clone Elements"),B=G.length,K=0;K<B;++K){var E=G[K];if(E==null)break}B=G.slice(0,K);this.clearSelection(true);K=B.length;for(clones=[];K--;){E=B[K];var A=la(B[K]),J=C||n().getCurrentLayer();if(u){tlist=Q(A);tlist.removeItem(u);Ra(A);J.insertBefore(A,E)}else J.appendChild(A);clones.push(A);D.addSubCommand(new Ha(A))}if(!D.isEmpty()){qb(B.reverse());u||this.moveSelectedElements(p,s,false);xa(D)}return clones};this.alignSelectedElements=function(p,s){var u=[],D=Number.MAX_VALUE,
B=Number.MIN_VALUE,K=Number.MAX_VALUE,E=Number.MIN_VALUE,A=Number.MIN_VALUE,J=Number.MIN_VALUE,q=G.length;if(q){for(var v=0;v<q;++v){if(G[v]==null)break;u[v]=getStrokedBBox([G[v]]);switch(s){case "smallest":if((p=="l"||p=="c"||p=="r")&&(A==Number.MIN_VALUE||A>u[v].width)||(p=="t"||p=="m"||p=="b")&&(J==Number.MIN_VALUE||J>u[v].height)){D=u[v].x;K=u[v].y;B=u[v].x+u[v].width;E=u[v].y+u[v].height;A=u[v].width;J=u[v].height}break;case "largest":if((p=="l"||p=="c"||p=="r")&&(A==Number.MIN_VALUE||A<u[v].width)||
(p=="t"||p=="m"||p=="b")&&(J==Number.MIN_VALUE||J<u[v].height)){D=u[v].x;K=u[v].y;B=u[v].x+u[v].width;E=u[v].y+u[v].height;A=u[v].width;J=u[v].height}break;default:if(u[v].x<D)D=u[v].x;if(u[v].y<K)K=u[v].y;if(u[v].x+u[v].width>B)B=u[v].x+u[v].width;if(u[v].y+u[v].height>E)E=u[v].y+u[v].height}}if(s=="page"){K=D=0;B=c.contentW;E=c.contentH}A=Array(q);J=Array(q);for(v=0;v<q;++v){if(G[v]==null)break;var w=u[v];A[v]=0;J[v]=0;switch(p){case "l":A[v]=D-w.x;break;case "c":A[v]=(D+B)/2-(w.x+w.width/2);break;
case "r":A[v]=B-(w.x+w.width);break;case "t":J[v]=K-w.y;break;case "m":J[v]=(K+E)/2-(w.y+w.height/2);break;case "b":J[v]=E-(w.y+w.height)}}this.moveSelectedElements(A,J)}};this.contentW=zb().w;this.contentH=zb().h;this.updateCanvas=function(p,s){k.setAttribute("width",p);k.setAttribute("height",s);var u=$("#canvasBackground")[0],D=l.getAttribute("x"),B=l.getAttribute("y"),K=p/2-this.contentW*m/2,E=s/2-this.contentH*m/2;na(l,{width:this.contentW*m,height:this.contentH*m,x:K,y:E,viewBox:"0 0 "+this.contentW+
" "+this.contentH});na(u,{width:l.getAttribute("width"),height:l.getAttribute("height"),x:K,y:E});(u=pa("background_image"))&&na(u,{width:"100%",height:"100%"});ua.selectorParentGroup.setAttribute("transform","translate("+K+","+E+")");return{x:K,y:E,old_x:D,old_y:B,d_x:K-D,d_y:E-B}};this.setBackground=function(p,s){var u=pa("canvasBackground"),D=$(u).find("rect")[0],B=pa("background_image");D.setAttribute("fill",p);if(s){if(!B){B=h.createElementNS(b,"image");na(B,{id:"background_image",width:"100%",
height:"100%",preserveAspectRatio:"xMinYMin",style:"pointer-events:none"})}U(B,s);u.appendChild(B)}else B&&B.parentNode.removeChild(B)};this.cycleElement=function(p){var s=G[0],u=false,D=pb(C||n().getCurrentLayer());if(D.length){if(s==null){p=p?D.length-1:0;u=D[p]}else for(var B=D.length;B--;)if(D[B]==s){p=p?B-1:B+1;if(p>=D.length)p=0;else if(p<0)p=D.length-1;u=D[p];break}rb([u],true);O("selected",G)}};this.clear();this.getPrivateMethods=function(){return{addCommandToHistory:xa,setGradient:Nb,addSvgElementFromJson:P,
assignAttributes:na,BatchCommand:Aa,call:O,ChangeElementCommand:Ka,copyElem:la,ffClone:fa,findDefs:gb,findDuplicateGradient:Mb,getElem:pa,getId:ca,getIntersectionList:ob,getMouseTarget:Bb,getNextId:ma,getPathBBox:Y,getUrlFromAttr:ka,hasMatrixTransform:ja,identifyLayers:xb,InsertElementCommand:Ha,isIdentity:svgedit.math.isIdentity,logMatrix:Wa,matrixMultiply:ba,MoveElementCommand:ra,preventClickDefault:Fb,recalculateAllSelectedDimensions:Ga,recalculateDimensions:Ra,remapElement:Za,RemoveElementCommand:Da,
removeUnusedDefElems:yb,round:ab,runExtensions:ib,sanitizeSvg:wa,SVGEditTransformList:svgedit.transformlist.SVGTransformList,toString:toString,transformBox:svgedit.math.transformBox,transformListToTransform:V,transformPoint:N,walkTree:svgedit.utilities.walkTree}}};(function(){document.addEventListener("touchstart",touchHandler,true);document.addEventListener("touchmove",touchHandler,true);document.addEventListener("touchend",touchHandler,true);document.addEventListener("touchcancel",touchHandler,true);if(!window.methodDraw)window.methodDraw=function(a){function f(k,l){var o=e.setSvgString(k)!==false;l=l||a.noop;o?l(true):a.alert(uiStrings.notification.errorLoadingSVG,function(){l(false)})}var e,b={},g=false;curConfig={canvas_expansion:1,dimensions:[580,400],
initFill:{color:"fff",opacity:1},initStroke:{width:1.5,color:"000",opacity:1},initOpacity:1,imgPath:"images/",extPath:"extensions/",jGraduatePath:"lib/jgraduate/images/",extensions:[],initTool:"select",wireframe:false,colorPickerCSS:false,gridSnapping:false,gridColor:"#000",baseUnit:"px",snappingStep:10,showRulers:svgedit.browser.isTouch()?false:true,show_outside_canvas:false,no_save_warning:true,initFont:"Helvetica, Arial, sans-serif"};uiStrings=b.uiStrings={common:{ok:"OK",cancel:"Cancel",key_up:"Up",
key_down:"Down",key_backspace:"Backspace",key_del:"Del"},layers:{layer:"Layer"},notification:{invalidAttrValGiven:"Invalid value given",noContentToFitTo:"No content to fit to",dupeLayerName:"There is already a layer named that!",enterUniqueLayerName:"Please enter a unique layer name",enterNewLayerName:"Please enter the new layer name",layerHasThatName:"Layer already has that name",QmoveElemsToLayer:'Move selected elements to layer "%s"?',QwantToClear:"<strong>Do you want to clear the drawing?</strong>\nThis will also erase your undo history",
QwantToOpen:"Do you want to open a new file?\nThis will also erase your undo history",QerrorsRevertToSource:"There were parsing errors in your SVG source.\nRevert back to original SVG source?",QignoreSourceChanges:"Ignore changes made to SVG source?",featNotSupported:"Feature not supported",enterNewImgURL:"Enter the new image URL",defsFailOnSave:"NOTE: Due to a bug in your browser, this image may appear wrong (missing gradients or elements). It will however appear correct once actually saved.",loadingImage:"Loading image, please wait...",
saveFromBrowser:'Select "Save As..." in your browser to save this image as a %s file.',noteTheseIssues:"Also note the following issues: ",unsavedChanges:"There are unsaved changes.",enterNewLinkURL:"Enter the new hyperlink URL",errorLoadingSVG:"Error: Unable to load SVG data",URLloadFail:"Unable to load from URL",retrieving:'Retrieving "%s" ...'}};var d={},c={};b.curConfig=curConfig;b.tool_scale=1;b.setConfig=function(k){a.extend(true,curConfig,k);if(k.extensions)curConfig.extensions=k.extensions};
b.setCustomHandlers=function(k){b.ready(function(){if(k.open){a('#tool_open > input[type="file"]').remove();a("#tool_open").show();e.open=k.open}if(k.save){b.show_save_warning=false;e.bind("saved",k.save)}k.pngsave&&e.bind("exported",k.pngsave);c=k})};b.randomizeIds=function(){e.randomizeIds(arguments)};b.init=function(){(function(){var q=window.opener;if(q)try{var v=q.document.createEvent("Event");v.initEvent("methodDrawReady",true,true);q.document.documentElement.dispatchEvent(v)}catch(w){}})();
(function(){a("body").toggleClass("touch",svgedit.browser.isTouch());var q=a.deparam.querystring(true);if(!a.isEmptyObject(q)){if(q.dimensions)q.dimensions=q.dimensions.split(",");if(q.extensions)q.extensions=q.extensions.split(",");if(q.bkgd_color)q.bkgd_color="#"+q.bkgd_color;methodDraw.setConfig(q);var v=q.source,w=a.param.querystring();if(!v)if(w.indexOf("source=data:")>=0)v=w.match(/source=(data:[^&]*)/)[1];if(v)if(v.indexOf("data:")===0){v=v.replace(/ /g,"+");b.loadFromDataURI(v)}else b.loadFromString(v);
else if(w.indexOf("paramurl=")!==-1)methodDraw.loadFromURL(w.substr(9));else q.url&&methodDraw.loadFromURL(q.url)}})();a("#canvas_width").val(curConfig.dimensions[0]);a("#canvas_height").val(curConfig.dimensions[1]);var k=function(){a.each(curConfig.extensions,function(){var q=this;a.getScript(curConfig.extPath+q,function(v){if(!v){v=document.createElement("script");v.src=curConfig.extPath+q;document.querySelector("head").appendChild(v)}})})};document.location.protocol==="file:"?setTimeout(k,100):
k();a.svgIcons(curConfig.imgPath+"svg_edit_icons.svg",{w:27,h:27,id_match:false,no_img:true,fallback_path:curConfig.imgPath,fallback:{logo:"logo.png",select:"select.png",select_node:"select_node.png",pencil:"pencil.png",pen:"line.png",rect:"square.png",ellipse:"ellipse.png",path:"path.png",text:"text.png",image:"image.png",zoom:"zoom.png","delete":"delete.png",spapelib:"shapelib.png",node_delete:"node_delete.png",align_left:"align-left.png",align_center:"align-center.png",align_right:"align-right.png",
align_top:"align-top.png",align_middle:"align-middle.png",align_bottom:"align-bottom.png",arrow_right:"flyouth.png",arrow_down:"dropdown.gif"},placement:{"#logo":"logo","#tool_select":"select","#tool_fhpath":"pencil","#tool_line":"pen","#tool_rect,#tools_rect_show":"rect","#tool_ellipse,#tools_ellipse_show":"ellipse","#tool_path":"path","#tool_text,#layer_rename":"text","#tool_image":"image","#tool_zoom":"zoom","#tool_node_clone":"node_clone","#tool_node_delete":"node_delete","#tool_add_subpath":"add_subpath",
"#tool_openclose_path":"open_path","#tool_alignleft, #tool_posleft":"align_left","#tool_aligncenter, #tool_poscenter":"align_center","#tool_alignright, #tool_posright":"align_right","#tool_aligntop, #tool_postop":"align_top","#tool_alignmiddle, #tool_posmiddle":"align_middle","#tool_alignbottom, #tool_posbottom":"align_bottom","#cur_position":"align","#zoomLabel":"zoom"},resize:{"#logo .svg_icon":15,".flyout_arrow_horiz .svg_icon":5,"#fill_bg .svg_icon, #stroke_bg .svg_icon":svgedit.browser.isTouch()?
24:24,".palette_item:first .svg_icon":svgedit.browser.isTouch()?30:16,"#zoomLabel .svg_icon":16,"#zoom_dropdown .svg_icon":7},callback:function(){a(".toolbar_button button > svg, .toolbar_button button > img").each(function(){a(this).parent().prepend(this)});a(".tool_button, .tool_button_current").addClass("loaded");var q=a("#tools_left");if(q.length!=0){q.offset();q.outerHeight()}a(".tools_flyout").each(function(){var v=a("#"+this.id+"_show"),w=v.attr("data-curopt");if(!v.children("svg, img").length){w=
a(w).children().clone();if(w.length){w[0].removeAttribute("style");v.append(w)}}});methodDraw.runCallbacks();setTimeout(function(){a(".flyout_arrow_horiz:empty").each(function(){a(this).append(a.getSvgIcon("arrow_right").width(5).height(5))})},1)}});a("#rulers").on("dblclick",function(q){a("#base_unit_container").css({top:q.pageY-10,left:q.pageX-50,display:"block"})});a("#base_unit_container").on("mouseleave mouseenter",function(){t=setTimeout(function(){a("#base_unit_container").fadeOut(500)},200);
event.type=="mouseover"&&clearTimeout(t)});a("#base_unit").on("change",function(){savePreferences()});b.canvas=e=new a.SvgCanvas(document.getElementById("svgcanvas"),curConfig);b.show_save_warning=false;b.paintBox={fill:null,stroke:null,canvas:null};k=navigator.platform.indexOf("Mac")>=0;var l=navigator.userAgent.indexOf("AppleWebKit")>=0,o=k?"meta+":"ctrl+",n=e.pathActions,m=e.undoMgr,C=svgedit.utilities,I=curConfig.imgPath+"placeholder.svg",H=a("#workarea"),G=a("#cmenu_canvas"),P=null,Q=1,N="toolbars",
ba="";k||a(".shortcut").each(function(){var q=a(this).text();a(this).text(q.split("\u2318").join("Ctrl+"))});(function(){a("#dialog_container").draggable({cancel:"#dialog_content, #dialog_buttons *",containment:"window"});var q=a("#dialog_box"),v=a("#dialog_buttons"),w=function(z,F,L,M){a("#dialog_content").html("<p>"+F.replace(/\n/g,"</p><p>")+"</p>").toggleClass("prompt",z=="prompt");v.empty();var R=a('<input type="button" value="'+uiStrings.common.ok+'">').appendTo(v);z!="alert"&&a('<input type="button" value="'+
uiStrings.common.cancel+'">').appendTo(v).on("click touchstart",function(){q.hide();L(false)});if(z=="prompt"){var Z=a('<input type="text">').prependTo(v);Z.val(M||"");Z.bind("keydown","return",function(){R.trigger("click touchstart")})}z=="process"&&R.hide();q.show();R.on("click touchstart",function(){q.hide();var da=z=="prompt"?Z.val():true;L&&L(da)}).focus();z=="prompt"&&Z.focus()};a.alert=function(z,F){w("alert",z,F)};a.confirm=function(z,F){w("confirm",z,F)};a.process_cancel=function(z,F){w("process",
z,F)};a.prompt=function(z,F,L){w("prompt",z,L,F)}})();var ja=function(){var q=a(".tool_button_current");if(q.length&&q[0].id!=="tool_select"){q.removeClass("tool_button_current").addClass("tool_button");a("#tool_select").addClass("tool_button_current").removeClass("tool_button")}e.setMode("select")},V=null,T=false,aa=false,sa="",ka=function(q,v){var w=e.getResolution(),z=H;a("#svgcanvas").position();if(z=e.setBBoxZoom(v,z.width()-15,z.height()-15)){var F=z.zoom;z=z.bbox;if(F<0.001)xa({value:0.1});
else{typeof animatedZoom!="undefined"&&q.cancelAnimationFrame(animatedZoom);var L=Date.now(),M=F-w.zoom;a("#zoom");var R=w.zoom,Z=function(){var da=(Date.now()-L)/500;da=Math.pow(da-1,3)+1;e.setZoom(R+M*da);K();if(da<1&&da>-0.9)q.animatedZoom=requestAnimationFrame(Z);else{a("#zoom").val(parseInt(F*100));a("option","#zoom_select").removeAttr("selected");a("option[value="+parseInt(F*100)+"]","#zoom_select").attr("selected","selected")}};Z();e.getMode()=="zoom"&&z.width&&ja();xb()}}};a("#cur_context_panel").delegate("a",
"click",function(){var q=a(this);q.attr("data-root")?e.leaveContext():e.setContext(q.text());e.clearSelection();return false});var ea=function(){b.paintBox.fill.prep();b.paintBox.stroke.prep()},U={},Y=function(q){a.each(q,function(v,w){var z=a(v).children(),F=v+"_show",L=a(F),M=false;z.addClass("tool_button").unbind("click mousedown mouseup").each(function(da){var W=w[da];U[W.sel]=W.fn;if(W.isDefault)M=da;da=function(ga){var ha=W;if(ga.type==="keydown"){var X=a(ha.parent+"_show").hasClass("tool_button_current"),
qa=a(ha.parent+"_show").attr("data-curopt");a.each(q[W.parent],function(Ea,Fa){if(Fa.sel==qa)ha=!ga.shiftKey||!X?Fa:q[W.parent][Ea+1]||q[W.parent][0]})}if(a(this).hasClass("disabled"))return false;ua(F)&&ha.fn();var za=ha.icon?a.getSvgIcon(ha.icon,true):a(ha.sel).children().eq(0).clone();za[0].setAttribute("width",L.width());za[0].setAttribute("height",L.height());L.children(":not(.flyout_arrow_horiz)").remove();L.append(za).attr("data-curopt",ha.sel)};a(this).mouseup(da);W.key&&a(document).bind("keydown",
W.key[0]+" shift+"+W.key[0],da)});if(M)L.attr("data-curopt",w[M].sel);else L.attr("data-curopt")||L.attr("data-curopt",w[0].sel);var R,Z=a(F).position();a(v).css({left:Z.left+34,top:Z.top+77});L.mousedown(function(da){a("#workarea").one("mousedown",function(){a("#tools_shapelib").hide()});a("#tools_shapelib").is(":visible")&&ua(F,false);if(L.hasClass("disabled"))return false;var W=a(v),ga=Z.left+34,ha=W.width()*-1,X=W.data("shown_popop")?200:0;R=setTimeout(function(){L.data("isLibrary")?W.css("left",
ga).show():W.css("left",ha).show().animate({left:ga},50);W.data("shown_popop",true)},X);da.preventDefault()}).mouseup(function(){clearTimeout(R);var da=a(this).attr("data-curopt");if(L.data("isLibrary")&&a(F.replace("_show","")).is(":visible"))ua(F,true);else ua(F)&&da in U&&U[da]()})});na()},oa=function(q,v){return a("<div>",{"class":"tools_flyout",id:q}).appendTo("#svg_editor").append(v)},pa=function(){a(".tools_flyout").each(function(){var q=a("#"+this.id+"_show"),v=q.offset();q=q.outerWidth();
a(this).css({left:(v.left+q)*Q,top:v.top})})},na=function(){a(".tools_flyout").each(function(){var q=a("#"+this.id+"_show");if(!q.data("isLibrary")){var v=[];a(this).children().each(function(){v.push(this.title)});q[0].title=v.join(" / ")}})},ia,ta=function(q,v,w){var z=null;if(q.indexOf("url(#")===0){q=(q=e.getRefElem(q))?q.cloneNode(true):a("#"+w+"_color defs *")[0];z={alpha:v};z[q.tagName]=q}else z=q.indexOf("#")===0?{alpha:v,solidColor:q.substr(1)}:{alpha:v,solidColor:"none"};return new a.jGraduate.Paint(z)},
wa=e.getResolution();if(curConfig.baseUnit!=="px"){wa.w=svgedit.units.convertUnit(wa.w)+curConfig.baseUnit;wa.h=svgedit.units.convertUnit(wa.h)+curConfig.baseUnit}var ra=function(q){e.createLayer("background");cur_shape=e.addSvgElementFromJson({element:"rect",attr:{x:-1,y:-1,width:wa.w+2,height:wa.h+2,stroke:"none",id:"canvas_background",opacity:1,fill:q||"#fff",style:"pointer-events:none"}});e.setCurrentLayer("Layer 1");e.setCurrentLayerPosition("1")};document.getElementById("canvas_background")||
ra();document.getElementById("canvas_background").getAttribute("fill");var Ha=b.setImageURL=function(q){q||(q=I);e.setImageURL(q);a("#image_url").val(q)},Da=function(){var q=V;if(q!=null&&!q.parentNode)q=null;if(T&&T[0]!=null&&!T[0].parentNode)T=false;var v=e.getCurrentDrawing().getCurrentLayerName(),w=e.getMode(),z=curConfig.baseUnit!=="px"?curConfig.baseUnit:null,F=w=="pathedit";if(F){a(".context_panel").hide();a("#path_node_panel").show();a("#stroke_panel").hide();v=n.getNodePoint();a("#tool_add_subpath").removeClass("push_button_pressed").addClass("tool_button");
a("#tool_node_delete").toggleClass("disabled",!n.canDeleteNodes);zb("#tool_openclose_path",n.closed_subpath?"open_path":"close_path");if(v){F=a("#seg_type");if(z){v.x=svgedit.units.convertUnit(v.x);v.y=svgedit.units.convertUnit(v.y)}a("#path_node_x").val(Math.round(v.x));a("#path_node_y").val(Math.round(v.y));if(v.type){F.val(v.type).removeAttr("disabled");a("#seg_type_label").html(v.type==4?"Straight":"Curve")}else F.val(4).attr("disabled","disabled")}a("#tools_top").removeClass("multiselected");
a("#stroke_panel").hide();a("#canvas_panel").hide()}else{var L=a("#cmenu_canvas li");a(".context_panel").hide();a(".menu_item","#edit_menu").addClass("disabled");a(".menu_item","#object_menu").addClass("disabled");if(T){T=T.filter(Boolean);(q=e.elementsAreSame(T)?T[0]:null)&&a("#tools_top").addClass("multiselected")}if(!q&&!T){a("#tools_top").removeClass("multiselected");a("#stroke_panel").hide();a("#canvas_panel").show()}if(q!=null){a("#stroke_panel").show();var M=q.nodeName,R=e.getRotationAngle(q);
a("#angle").val(Math.round(R));R=e.getBlur(q);a("#blur").val(R);if(!F&&w!="pathedit"){a("#selected_panel").show();a(".action_selected").removeClass("disabled");var Z,da;if(["g","polyline","path"].indexOf(M)>=0)if(w=e.getStrokedBBox([q])){Z=w.x;da=w.y}if(z){Z=svgedit.units.convertUnit(Z);da=svgedit.units.convertUnit(da)}a("#"+M+"_x").val(Math.round(Z));a("#"+M+"_y").val(Math.round(da));if(M==="polyline"){a("#path_x").val(Math.round(Z));a("#path_y").val(Math.round(da))}["image","text","path","g","use"].indexOf(M)==
-1&&a(".action_path_convert_selected").removeClass("disabled");M==="path"&&a(".action_path_selected").removeClass("disabled")}z=null;if(W==="a"){z=e.getHref(q);a("#g_panel").show()}if(q.parentNode.tagName==="a")if(!a(q).siblings().length){a("#a_panel").show();z=e.getHref(q.parentNode)}a("#tool_make_link, #tool_make_link").toggle(!z);z&&a("#link_url").val(z);z={g:[],a:[],rect:["rx","width","height","x","y"],image:["width","height","x","y"],circle:["cx","cy","r"],ellipse:["cx","cy","rx","ry"],line:["x1",
"y1","x2","y2"],text:["x","y"],use:[],path:[]};var W=q.tagName;a(q).data("gsvg")&&a("#g_panel").show();if(W=="path"||W=="polyline")a("#path_panel").show();if(z[W]){z=z[W];a("#"+W+"_panel").show();W=="rect"?a("#cornerRadiusLabel").show():a("#cornerRadiusLabel").hide();a.each(z,function(ga,ha){var X=q.getAttribute(ha);if(curConfig.baseUnit!=="px"&&q[ha])X=svgedit.units.convertUnit(q[ha].baseVal.value);var qa=document.getElementById(W+"_"+ha);qa.value=Math.round(X)||0;qa.getAttribute("data-cursor")===
"true"&&a.fn.dragInput.updateCursor(qa)});if(W=="text"){z=q.getAttribute("font-family");document.getElementById("font_family_dropdown").selectedIndex=3;a("#text_panel").css("display","inline");a("#tool_italic").toggleClass("active",e.getItalic());a("#tool_bold").toggleClass("active",e.getBold());a("#font_family").val(z);a("#font_size").val(q.getAttribute("font-size"));a("#text").val(q.textContent);a("#preview_font").text(z.split(",")[0].replace(/'/g,"")).css("font-family",z);e.addedNew&&setTimeout(function(){a("#text").focus().select()},
100)}else if(W=="image")Ha(e.getHref(q));else if(W==="g"||W==="use"){a("#container_panel").show();a(".action_group_selected").removeClass("disabled");e.getTitle()}}L[(W==="g"?"en":"dis")+"ableContextMenuItems"]("#ungroup");L[(W==="g"||!T?"dis":"en")+"ableContextMenuItems"]("#group")}if(T){a("#multiselected_panel").show();a(".action_multi_selected").removeClass("disabled");L.enableContextMenuItems("#group").disableContextMenuItems("#ungroup")}q||L.disableContextMenuItems("#delete,#cut,#copy,#group,#ungroup,#move_front,#move_up,#move_down,#move_back");
m.getUndoStackSize()>0?a("#tool_undo").removeClass("disabled"):a("#tool_undo").addClass("disabled");m.getRedoStackSize()>0?a("#tool_redo").removeClass("disabled"):a("#tool_redo").addClass("disabled");e.addedNew=false;if(q&&!F||T){a("#selLayerNames").removeAttr("disabled").val(v);G.enableContextMenuItems("#delete,#cut,#copy,#move_front,#move_up,#move_down,#move_back")}}};a("#text").on("focus",function(){});a("#text").on("blur",function(){});e.bind("selected",function(q,v){var w=e.getMode();w==="select"&&
ja();if(w==="pathedit")return Da();V=v.length==1||v[1]==null?v[0]:null;v=v.filter(Boolean);T=v.length>=2?v:false;if(e.elementsAreSame(T))V=T[0];if(V!=null){a("#multiselected_panel").hide();if(V!=null)switch(V.tagName){case "use":a(".context_panel").hide();a("#use_panel").show();break;case "image":a(".context_panel").hide();a("#image_panel").show();break;case "foreignObject":a(".context_panel").hide();break;case "g":case "a":w=null;for(var z=V.getElementsByTagName("*"),F=0,L=z.length;F<L;F++){var M=
z[F].getAttribute("stroke-width");if(F===0)w=M;else if(w!==M)w=null}a("#stroke_width").val(w===null?"0":w);Da();break;default:a("#stroke_width").val(V.getAttribute("stroke-width")||0);w=V.getAttribute("stroke-dasharray")||"none";a("option","#stroke_style").removeAttr("selected");a('#stroke_style option[value="'+w+'"]').attr("selected","selected");a("#stroke_style").trigger("change");a.fn.dragInput.updateCursor(a("#stroke_width")[0]);a.fn.dragInput.updateCursor(a("#blur")[0])}if(V!=null){w=(V.getAttribute("opacity")||
1)*100;a("#group_opacity").val(w);a.fn.dragInput.updateCursor(a("#group_opacity")[0])}T.length&&a("#tools_top").addClass("multiselected")}else if(T.length){a(".context_panel").hide();a("#tools_top").removeClass("multiselected");a("#multiselected_panel").show()}else{a(".context_panel").hide();a("#canvas_panel").show();a("#tools_top").removeClass("multiselected")}e.runExtensions("selectedChanged",{elems:v,selectedElement:V,multiselected:T})});e.bind("transition",function(q,v){var w=e.getMode(),z=v[0];
if(z){T=v.length>=2&&v[1]!=null?v:null;if(!T)switch(w){case "rotate":w=e.getRotationAngle(z);a("#angle").val(Math.round(w));rotateCursor(w);a("#tool_reorient").toggleClass("disabled",w==0)}e.runExtensions("elementTransition",{elems:v})}});e.bind("changed",function(q,v){var w=e.getMode();w==="select"&&ja();for(var z=0;z<v.length;++z){var F=v[z];if(F&&F.tagName==="svg")K();else if(F&&V&&V.parentNode==null)V=F}b.show_save_warning=true;Da();if(V&&w==="select"){b.paintBox.fill.update();b.paintBox.stroke.update()}e.runExtensions("elementChanged",
{elems:v})});e.bind("saved",function(q,v){b.show_save_warning=false;v='<?xml version="1.0"?>\n'+v;var w=navigator.userAgent;if(~w.indexOf("MSIE"))Eb(0,true);else{var z=q.open("data:image/svg+xml;base64,"+C.encode64(v)),F=a.pref("save_notice_done");if(F!=="all"){var L=uiStrings.notification.saveFromBrowser.replace("%s","SVG");if(w.indexOf("Gecko/")!==-1)if(v.indexOf("<defs")!==-1){L+="\n\n"+uiStrings.notification.defsFailOnSave;a.pref("save_notice_done","all");F="all"}else a.pref("save_notice_done",
"part");else a.pref("save_notice_done","all");F!=="part"&&z.alert(L)}}});e.bind("exported",function(q,v){var w=v.issues;a("#export_canvas").length||a("<canvas>",{id:"export_canvas"}).hide().appendTo("body");var z=a("#export_canvas")[0];z.width=e.contentW;z.height=e.contentH;canvg(z,v.svg,{renderCallback:function(){var F=z.toDataURL("image/png");P.location.href=F;if(a.pref("export_notice_done")!=="all"){F=uiStrings.notification.saveFromBrowser.replace("%s","PNG");if(w.length)F+="\n\n"+uiStrings.notification.noteTheseIssues+
"\n \u2022 "+w.join("\n \u2022 ");a.pref("export_notice_done","all");P.alert(F)}}})});e.bind("zoomed",ka);e.bind("contextset",function(q,v){var w="";if(v){var z="";w='<a href="#" data-root="y">'+e.getCurrentDrawing().getCurrentLayerName()+"</a>";a(v).parentsUntil("#svgcontent > g").andSelf().each(function(){if(this.id){z+=" > "+this.id;w+=this!==v?' > <a href="#">'+this.id+"</a>":" > "+this.id}});sa=z}else sa=null;a("#cur_context_panel").toggle(!!v).html(w)});e.bind("extension_added",function(q,v){function w(){if(ia){clearTimeout(ia);
ia=null}F||(ia=setTimeout(function(){F=true;Mb(d.iconsize)},50))}var z=false,F=false,L=true,M=function(){if(v.callback&&!z&&L){z=true;v.callback()}},R=[];v.context_tools&&a.each(v.context_tools,function(ha,X){var qa=X.container_id?' id="'+X.container_id+'"':"",za=a("#"+X.panel);za.length||(za=a("<div>",{id:X.panel}).appendTo("#tools_top").hide());switch(X.type){case "tool_button":var Ea='<div class="tool_button">'+X.id+"</div>",Fa=a(Ea).appendTo(za);X.events&&a.each(X.events,function(Na,jb){a(Fa).bind(Na,
jb)});break;case "select":Ea="<label"+qa+'><select id="'+X.id+'">';a.each(X.options,function(Na,jb){Ea+='<option value="'+Na+'"'+(Na==X.defval?" selected":"")+">"+jb+"</option>"});Ea+="</select></label>";var Pa=a(Ea).appendTo(za).find("select");a.each(X.events,function(Na,jb){a(Pa).bind(Na,jb)});break;case "button-select":Ea='<div id="'+X.id+'" class="dropdown toolset" title="'+X.title+'"><div id="cur_'+X.id+'" class="icon_label"></div><button></button></div>';qa=a('<ul id="'+X.id+'_opts"></ul>').appendTo("#option_lists");
X.colnum&&qa.addClass("optcols"+X.colnum);a(Ea).appendTo(za).children();R.push({elem:"#"+X.id,list:"#"+X.id+"_opts",title:X.title,callback:X.events.change,cur:"#cur_"+X.id});break;case "input":Ea="<label"+qa+'><span id="'+X.id+'_label">'+X.label+':</span><input id="'+X.id+'" title="'+X.title+'" size="'+(X.size||"4")+'" value="'+(X.defval||"")+'" type="text"/></label>';var Qa=a(Ea).appendTo(za).find("input");X.spindata&&Qa.SpinButton(X.spindata);X.events&&a.each(X.events,function(Na,jb){Qa.bind(Na,
jb)})}});if(v.buttons){var Z={},da={},W=v.svgicons,ga={};a.each(v.buttons,function(ha,X){for(var qa,za=X.id,Ea=ha;a("#"+za).length;)za=X.id+"_"+ ++Ea;if(W){Z[za]=X.icon;Ea=X.svgicon?X.svgicon:X.id;if(X.type=="app_menu")da["#"+za+" > div"]=Ea;else da["#"+za]=Ea}else qa=X.type=="menu"?"":a('<img src="'+X.icon+'">');var Fa,Pa;switch(X.type){case "mode_flyout":case "mode":Fa="tool_button";if(X.cls)Fa+=" "+X.cls;Pa="#tools_left";break;case "context":Fa="tool_button";Pa="#"+X.panel;a(Pa).length||a("<div>",
{id:X.panel}).appendTo("#tools_top");break;case "menu":Fa="menu_item tool_button";Pa="#"+(X.after||X.panel);break;case "app_menu":Fa="";Pa=X.parent||"#main_menu ul";a(Pa).length||a("<div>",{id:X.panel}).appendTo("#tools_top")}var Qa=a(X.list||X.type=="app_menu"?"<li/>":"<div/>").attr("id",za).attr("title",X.title).addClass(Fa);if(!X.includeWith&&!X.list){if("position"in X)a(Pa).children().eq(X.position).before(Qa);else X.type!="menu"||!X.after?Qa.appendTo(Pa):a(Pa).after(Qa);if(X.type=="mode_flyout"){Ea=
a(Qa);Fa=Ea.parent();if(!Ea.parent().hasClass("tools_flyout")){var Na=Ea[0].id.replace("tool_","tools_"),jb=Ea.clone().attr("id",Na+"_show").append(a("<div>",{"class":"flyout_arrow_horiz"}));Ea.before(jb);Fa=oa(Na,Ea);Fa.data("isLibrary",true);jb.data("isLibrary",true)}da["#"+Na+"_show"]=X.id;za=ga["#"+Fa[0].id]=[{sel:"#"+za,fn:X.events.click,icon:X.id,isDefault:true},ub]}else if(X.type=="app_menu"||X.type=="menu")Qa.append(X.title)}else if(X.list){Qa.addClass("push_button");a("#"+X.list+"_opts").append(Qa);
if(X.isDefault){a("#cur_"+X.list).append(Qa.children().clone());Ea=X.svgicon?X.svgicon:X.id;da["#cur_"+X.list]=Ea}}else if(X.includeWith){Pa=X.includeWith;Ea=a(Pa.button);Fa=Ea.parent();if(!Ea.parent().hasClass("tools_flyout")){Na=Ea[0].id.replace("tool_","tools_");jb=Ea.clone().attr("id",Na+"_show").append(a("<div>",{"class":"flyout_arrow_horiz"}));Ea.before(jb);Fa=oa(Na,Ea)}var ub=D.getButtonData(Pa.button);if(Pa.isDefault)da["#"+Na+"_show"]=X.id;za=ga["#"+Fa[0].id]=[{sel:"#"+za,fn:X.events.click,
icon:X.id,key:X.key,isDefault:X.includeWith?X.includeWith.isDefault:0},ub];Na="position"in Pa?Pa.position:"last";ub=Fa.children().length;if(!isNaN(Na)&&Na>=0&&Na<ub)Fa.children().eq(Na).before(Qa);else{Fa.append(Qa);za.reverse()}}W||Qa.append(qa);X.list||a.each(X.events,function(Cb,Jb){if(Cb=="click")if(X.type=="mode"){X.includeWith?Qa.bind(Cb,Jb):Qa.bind(Cb,function(){ua(Qa)&&Jb()});if(X.key){a(document).bind("keydown",X.key,Jb);X.title&&Qa.attr("title",X.title+" ["+X.key+"]")}}else Qa.bind(Cb,Jb);
else Qa.bind(Cb,Jb)});Y(ga)});a.each(R,function(){vb(this.elem,this.list,this.callback,{seticon:true})});if(W)L=false;a.svgIcons(W,{w:27,h:27,id_match:false,no_img:!l,fallback:Z,placement:da,callback:function(){d.iconsize&&d.iconsize!="m"&&w();L=true;M()}})}M()});e.textActions.setInputElem(a("#text")[0]);var Ka='<div class="palette_item transparent" data-rgb="none"></div>                <div class="palette_item black" data-rgb="#000000"></div>                <div class="palette_item white" data-rgb="#ffffff"></div>';
["#444444","#482816","#422C10","#3B2F0E","#32320F","#293414","#1F361B","#153723","#0C372C","#083734","#0E353B","#1A333F","#273141","#332D40","#3E2A3C","#462735","#4B252D","#4D2425","#4C261D","#666666","#845335","#7B572D","#6F5C2A","#62612C","#546433","#46673D","#396849","#306856","#2D6862","#33666C","#426373","#535F75","#645A73","#74556D","#805064","#884D58","#8B4D4B","#894F3F","#999999","#C48157","#B8874D","#A98E49","#97944B","#849854","#729C62","#619E73","#559E84","#529D94","#5B9BA2","#6D97AB",
"#8391AE","#9A8AAB","#AF84A3","#BF7E96","#C97A86","#CE7975","#CC7C65","#BBBBBB","#FFB27C","#FABA6F","#E6C36A","#CFCA6D","#B8D078","#A0D58A","#8CD79F","#7DD8B5","#7AD6CA","#84D3DB","#9ACEE6","#B6C7EA","#D3BEE7","#EDB6DC","#FFAFCC","#FFAAB8","#FFA9A2","#FFAC8D","#DDDDDD","#FFE7A2","#FFF093","#FFFA8D","#FFFF91","#EEFF9F","#D1FFB4","#B9FFCE","#A8FFE9","#A4FFFF","#B1FFFF","#CBFFFF","#EDFFFF","#FFF5FF","#FFEBFF","#FFE2FF","#FFDCEC","#FFDBD2","#FFDFB8"].forEach(function(q){Ka+='<div class="palette_item" style="background-color: '+
q+';" data-rgb="'+q+'"></div>'});a("#palette").append(Ka);var Aa=a("#tool_angle_indicator");a("#tool_reorient");rotateCursor=function(q){q="rotate("+q+"deg)";Aa.css({"-webkit-transform":q,"-moz-transform":q,"-o-transform":q,"-ms-transform":q,transform:q})};var xa=function(q){var v=q.value/100;if(v<0.001)q.value=0.1;else{q=e.getZoom();var w=H;ka(window,{width:0,height:0,x:(w[0].scrollLeft+w.width()/2)/q,y:(w[0].scrollTop+w.height()/2)/q,zoom:v},true)}};a("#stroke_style").change(function(){e.setStrokeAttr("stroke-dasharray",
a(this).val());a("#stroke_style_label").html(this.options[this.selectedIndex].text);window.opera&&a("<p/>").hide().appendTo("body").remove()});a("#seg_type").change(function(){e.setSegType(a(this).val());a("#seg_type_label").html(this.options[this.selectedIndex].text)});a("select").change(function(){a(this).blur()});a("#font_family").change(function(){e.setFontFamily(this.value)});a("#text").keyup(function(){e.setTextContent(this.value)});changeAttribute=function(q){var v=q.getAttribute("data-attr"),
w=q.getAttribute("data-multiplier")||1;w=parseFloat(w);w=q.value*w;if(!svgedit.units.isValidUnit(v,w,V)){a.alert(uiStrings.notification.invalidAttrValGiven);q.value=V.getAttribute(v);return false}e.changeSelectedAttributeNoUndo(v,w)};picking=false;a(document).on("mouseup",function(){picking=false});a("#palette").on("mousemove mousedown touchstart touchmove",".palette_item",function(q){q.preventDefault();if(q.type=="mousedown")picking=true;if(picking){var v=a("#tool_stroke").hasClass("active"),w=v?
"stroke":"fill",z=a(this).attr("data-rgb"),F=null,L=true;if(q.type=="mousedown")L=false;if(z==="transparent"||z==="initial"||z==="#none"){z="none";F=new a.jGraduate.Paint}else F=new a.jGraduate.Paint({alpha:100,solidColor:z.substr(1)});b.paintBox[w].setPaint(F);if(v){e.setColor("stroke",z,L);z!="none"&&e.getStrokeOpacity()!=1&&e.setPaintOpacity("stroke",1)}else{e.setColor("fill",z,L);z!="none"&&e.getFillOpacity()!=1&&e.setPaintOpacity("fill",1)}}}).bind("contextmenu",function(q){q.preventDefault()});
a("#toggle_stroke_tools").toggle(function(){a(".stroke_tool").css("display","table-cell");a(this).addClass("expanded");Db()},function(){a(".stroke_tool").css("display","none");a(this).removeClass("expanded");Db()});var ua=function(q,v){if(a(q).hasClass("disabled"))return false;if(a(q).parent().hasClass("tools_flyout"))return true;var w=w||"normal";v||a(".tools_flyout").fadeOut(w);a("#styleoverrides").text("");a(".tool_button_current").removeClass("tool_button_current").addClass("tool_button");a(q).addClass("tool_button_current").removeClass("tool_button");
return true};(function(){var q=null,v=null,w=H[0],z=false,F=false;a("#svgcanvas").on("mousemove mouseup touchend",function(L){if(z!==false){w.scrollLeft-=L.clientX-q;w.scrollTop-=L.clientY-v;q=L.clientX;v=L.clientY;if(L.type==="mouseup"||L.type==="touchend")z=false;return false}}).on("mousedown touchmove",function(L){if(L.button===1||F===true||L.originalEvent.touches&&L.originalEvent.touches.length>=2){z=true;q=L.clientX;v=L.clientY;return false}});a(window).mouseup(function(){z=false});a(document).bind("keydown",
"space",function(L){L.preventDefault();e.spaceKey=F=true}).bind("keyup","space",function(L){L.preventDefault();e.spaceKey=F=false}).bind("keydown","alt",function(){e.getMode()==="zoom"&&H.addClass("out")}).bind("keyup","alt",function(){e.getMode()==="zoom"&&H.removeClass("out")})})();var Ba=a(".menu"),kb=function(q){q.target.style.background="#fff";setTimeout(function(){q.target.style.background="#ddd"},50);setTimeout(function(){q.target.style.background="#fff"},150);setTimeout(function(){q.target.style.background=
"#ddd"},200);setTimeout(function(){q.target.style.background=""},200);setTimeout(function(){a("#menu_bar").removeClass("active")},220);return false};a(".menu_item").on("mousedown touchstart",function(q){kb(q)});a("svg, body").on("mousedown  touchstart",function(q){if(!(q.target.nodeName&&q.target.nodeName.toLowerCase()==="input"))if(!a(q.target).hasClass("menu_title")&&!a(q.target).parent().hasClass("menu_title"))!a(q.target).hasClass("disabled")&&a(q.target).hasClass("menu_item")?kb(q):a("#menu_bar").removeClass("active")});
a("#workarea").on("mousewheel",function(q,v,w,z){if(q.altKey||q.ctrlKey){q.preventDefault();zoom=parseInt(a("#zoom").val());a("#zoom").val(parseInt(zoom+z*(q.altKey?10:5))).change()}});a(".menu_title").on("mousedown",function(){a("#tools_shapelib").hide();a("#menu_bar").toggleClass("active");Ba.removeClass("open");a(this).parent().addClass("open")}).on("mouseover",function(){Ba.removeClass("open");a(this).parent().addClass("open")});b.addDropDown=function(q,v,w){if(a(q).length!=0){var z=a(q).find("button"),
F=a(q).find("ul").attr("id",a(q)[0].id+"-list");w||a("#option_lists").append(F);var L=false;w&&a(q).addClass("dropup");F.find("li").bind("mouseup",v);a(window).mouseup(function(){if(!L){z.removeClass("down");F.hide()}L=false});z.bind("mousedown",function(){if(z.hasClass("down")){z.removeClass("down");F.hide()}else{z.addClass("down");if(!w){var M=a(q).offset();F.css({top:M.top,left:M.left-110})}F.show();L=true}}).hover(function(){L=true}).mouseout(function(){L=false})}};var vb=function(q,v,w,z){var F=
a(q);v=a(v);var L=false,M=z.dropUp;M&&a(q).addClass("dropup");v.find("li").bind("mouseup",function(){if(z.seticon){zb("#cur_"+F[0].id,a(this).children());a(this).addClass("current").siblings().removeClass("current")}w.apply(this,arguments)});a(window).mouseup(function(){if(!L){F.removeClass("down");v.hide();v.css({top:0,left:0})}L=false});v.height();a(q).bind("mousedown",function(){var R=a(q).offset();if(M){R.top-=v.height();R.left+=8}else R.top+=a(q).height();a(v).offset(R);if(F.hasClass("down")){F.removeClass("down");
v.hide();v.css({top:0,left:0})}else{F.addClass("down");v.show();L=true;return false}}).hover(function(){L=true}).mouseout(function(){L=false});z.multiclick&&v.mousedown(function(){L=true})};a("#font_family_dropdown").change(function(){var q=this.options[this.selectedIndex].value,v=this.options[this.selectedIndex].text;a("#preview_font").html(v).css("font-family",q);a("#font_family").val(q).change()});a("div","#position_opts").each(function(){this.addEventListener("mouseup",function(){var q=this.id.replace("tool_pos",
"").charAt(0);e.alignSelectedElements(q,"page")})});(function(){var q,v=function(){a(q).blur()};a("#svg_editor").find("button, select, input:not(#text)").focus(function(){q=this;N="toolbars";H.mousedown(v)}).blur(function(){N="canvas";H.unbind("mousedown",v);e.getMode()=="textedit"&&a("#text").focus()})})();var cb=function(){ua("#tool_select")&&e.setMode("select")},Ta=function(){ua("#tool_fhpath")&&e.setMode("fhpath")},Va=function(){ua("#tool_line")&&e.setMode("line")},Ia=function(){ua("#tool_rect")&&
e.setMode("rect")},ya=function(){ua("#tool_ellipse")&&e.setMode("ellipse")},$a=function(){ua("#tool_image")&&e.setMode("image")},La=function(){ua("#tool_zoom")&&e.setMode("zoom")},Sa=function(){if(ua("#tool_zoom")){yb();ja()}},Ja=function(){ua("#tool_text")&&e.setMode("text")},db=function(){ua("#tool_path")&&e.setMode("path")},lb=function(){if(V!=null||T)e.deleteSelectedElements();n.getNodePoint()&&n.deletePathNode()},Ua=function(){if(V!=null||T){Ca(a("#edit_menu"));e.cutSelectedElements()}},Xa=function(){if(V!=
null||T){Ca(a("#edit_menu"));e.copySelectedElements()}},wb=function(){Ca(a("#edit_menu"));var q=e.getZoom(),v=(H[0].scrollLeft+H.width()/2)/q-e.contentW;q=(H[0].scrollTop+H.height()/2)/q-e.contentH;e.pasteElements("point",v,q)},va=function(){if(V!=null){Ca(a("#object_menu"));e.moveToTopSelectedElement()}},hb=function(){if(V!=null){Ca(a("#object_menu"));e.moveToBottomSelectedElement()}},eb=function(){if(V!=null){Ca(a("#object_menu"));e.moveUpDownSelected("Up")}},sb=function(){if(V!=null){Ca(a("#object_menu"));
e.moveUpDownSelected("Down")}},ib=function(q){if(V!=null){Ca(a("#object_menu"));e.moveUpDownSelected(q)}},ab=function(){if(V!=null){e.convertToPath();var q=e.getSelectedElems();e.selectorManager.requestSelector(q[0]).reset(q[0]);e.selectorManager.requestSelector(q[0]).selectorRect.setAttribute("display","none");e.setMode("pathedit");n.toEditMode(q[0]);e.clearSelection();Da()}},ob=function(){V!=null&&n.reorient()},pb=function(){if(V!=null||T)a.prompt(uiStrings.notification.enterNewLinkURL,"http://",
function(q){q&&e.makeHyperlink(q)})},fb=function(q,v){if(V!=null||T){if(curConfig.gridSnapping){var w=e.getZoom()*curConfig.snappingStep;q*=w;v*=w}a("input").blur();e.moveSelectedElements(q,v)}},tb=function(){},la=function(){n.getNodePoint()&&n.clonePathNode()},ca=function(){n.getNodePoint()&&n.deletePathNode()},ma=function(){var q=a("#tool_add_subpath"),v=!q.hasClass("push_button_pressed");v?q.addClass("push_button_pressed").removeClass("tool_button"):q.removeClass("push_button_pressed").addClass("tool_button");
n.addSubPath(v)},O=function(){n.opencloseSubPath()},S=function(){e.cycleElement(1)},fa=function(){e.cycleElement(0)},Ga=function(q,v){if(!(V==null||T)){q||(v*=-1);var w=a("#angle").val()*1+v;e.setRotationAngle(w);Da()}},Oa=function(){var q=curConfig.dimensions;a.confirm(uiStrings.notification.QwantToClear,function(v){if(v){ja();e.clear();e.setResolution(q[0],q[1]);K(true);yb();Da();ea();e.runExtensions("onNewDocument")}})},Wa=function(){e.setBold(!e.getBold());Da()},Za=function(){e.setItalic(!e.getItalic());
Da()},nb=function(){if(!c.pngsave){var q=uiStrings.notification.loadingImage;P=window.open("data:text/html;charset=utf-8,<title>"+q+"</title><h1>"+q+"</h1>")}window.canvg?e.rasterExport():a.getScript("canvg/rgbcolor.js",function(){a.getScript("canvg/canvg.js",function(){e.rasterExport()})})},Ra=function(){e.open()},mb=function(){},Ca=function(q){var v=q.prev();v.css({background:"white",color:"black"});setTimeout(function(){v.removeAttr("style")},200)},qb=function(){if(m.getUndoStackSize()>0){Ca(a("#edit_menu"));
m.undo()}},rb=function(){if(m.getRedoStackSize()>0){Ca(a("#edit_menu"));m.redo()}},Bb=function(){if(T){Ca(a("#object_menu"));e.groupSelectedElements()}else if(V){Ca(a("#object_menu"));e.ungroupSelectedElement()}},Fb=function(){Ca(a("#edit_menu"));e.cloneSelectedElements(20,20)},bb=function(){var q=this.id.replace("tool_align","").charAt(0);e.alignSelectedElements(q,a("#align_relative_to").val())},Ma=function(){var q=document.querySelector("#tool_stroke rect");a("#tool_stroke").toggleClass("active");
a("#tool_fill").toggleClass("active");var v=document.querySelector("#tool_fill rect"),w=v.getAttribute("fill"),z=q.getAttribute("fill");q=parseFloat(q.getAttribute("stroke-opacity"));if(isNaN(q))q=100;v=parseFloat(v.getAttribute("fill-opacity"));if(isNaN(v))v=100;z=ta(z,q,"stroke");w=ta(w,v,"fill");b.paintBox.fill.setPaint(z,true);b.paintBox.stroke.setPaint(w,true)},yb=function(q){var v=e.getResolution();q=q?v.zoom*q:1;a("#zoom").val(q*100);e.setZoom(q);xb();K(true)},Hb=function(){Ca(a("#view_menu"));
!a("#tool_wireframe").hasClass("push_button_pressed")?a("#tool_wireframe").addClass("push_button_pressed"):a("#tool_wireframe").removeClass("push_button_pressed");H.toggleClass("wireframe");if(!s){var q=a("#wireframe_rules");q.length?q.empty():a('<style id="wireframe_rules"></style>').appendTo("head");xb()}},Gb=function(){Ca(a("#view_menu"));var q=!a("#tool_snap").hasClass("push_button_pressed");q?a("#tool_snap").addClass("push_button_pressed"):a("#tool_snap").removeClass("push_button_pressed");curConfig.gridSnapping=
q},Ib=function(){window.self!=window.top&&top.exit_fullscreen()},Lb=function(){Ca(a("#view_menu"));if(a("#tool_rulers").hasClass("push_button_pressed")){a("#tool_rulers").removeClass("push_button_pressed");a("#show_rulers").attr("checked",false);curConfig.showRulers=false}else{a("#tool_rulers").addClass("push_button_pressed");a("#show_rulers").attr("checked",true);curConfig.showRulers=true}a("#rulers").toggle(!!curConfig.showRulers)},xb=function(){if(!s){var q="#workarea.wireframe #svgcontent * { stroke-width: "+
1/e.getZoom()+"px; }";a("#wireframe_rules").text(H.hasClass("wireframe")?q:"")}},Eb=function(q,v){if(!aa){Ca(a("#view_menu"));aa=true;a("#save_output_btns").toggle(!!v);a("#tool_source_back").toggle(!v);var w=ba=e.getSvgString();a("#svg_source_textarea").val(w);a("#svg_source_editor").fadeIn();a("#svg_source_textarea").focus().select()}},Kb=function(){if(aa){if(e.setSvgString(a("#svg_source_textarea").val())){e.clearSelection();Ya();yb();ea()}else a.confirm(uiStrings.notification.QerrorsRevertToSource,
function(q){if(!q)return false;e.clearSelection();Ya();yb();ea()});ja()}},zb=b.setIcon=function(q,v){var w=typeof v==="string"?a.getSvgIcon(v,true):v.clone();w?a(q).find("img").replaceWith(w):console.log("NOTE: Icon image missing: "+v)},gb;gb=function(){var q=/^(Moz|Webkit|Khtml|O|ms|Icab)(?=[A-Z])/,v=document.getElementsByTagName("script")[0],w;for(w in v.style)if(q.test(w))return w.match(q)[0];if("WebkitOpacity"in v.style)return"Webkit";if("KhtmlOpacity"in v.style)return"Khtml";return""}();var Nb=
function(q,v){gb.toLowerCase();var w=["top","left","bottom","right"];q.each(function(){for(var z=a(this),F=z.outerWidth()*(v-1),L=z.outerHeight()*(v-1),M=0;M<4;M++){var R=w[M],Z=z.data("orig_margin-"+R);if(Z==null){Z=parseInt(z.css("margin-"+R));z.data("orig_margin-"+R,Z)}Z=Z*v;if(R==="right")Z+=F;else if(R==="bottom")Z+=L;z.css("margin-"+R,Z)}})},Mb=b.setIconSize=function(q,v){if(!(q==d.size&&!v)){var w=a("#tools_top .toolset, #editor_panel > *, #history_panel > *,        #main_button, #tools_left > *, #path_node_panel > *, #multiselected_panel > *,        #g_panel > *, #tool_font_size > *, .tools_flyout"),
z=1;z=typeof q=="number"?q:{s:0.75,m:1,l:1.25,xl:1.5}[q];b.tool_scale=Q=z;pa();var F=w.parents(":hidden");F.css("visibility","hidden").show();Nb(w,z);F.css("visibility","visible").hide();w=a("#tool_size_rules");if(w.length)w.empty();else w=a('<style id="tool_size_rules"></style>').appendTo("head");if(q!="m"){var L="";a.each(cssResizeRules,function(M,R){M="#svg_editor "+M.replace(/,/g,", #svg_editor");L+=M+"{";a.each(R,function(Z,da){if(typeof da==="number")var W=da*z+"px";else if(da[q]||da.all)W=
da[q]||da.all;L+=Z+":"+W+";"});L+="}"});F="-"+gb.toLowerCase()+"-";L+="#tools_top .toolset, #editor_panel > *, #history_panel > *,        #main_button, #tools_left > *, #path_node_panel > *, #multiselected_panel > *,        #g_panel > *, #tool_font_size > *, .tools_flyout{"+F+"transform: scale("+z+");} #svg_editor div.toolset .toolset {"+F+"transform: scale(1); margin: 1px !important;} #svg_editor .ui-slider {"+F+"transform: scale("+1/z+");}";w.text(L)}pa()}},Ab=function(){a("#dialog_box").hide();
if(aa){if(aa)ba!==a("#svg_source_textarea").val()?a.confirm(uiStrings.notification.QignoreSourceChanges,function(q){q&&Ya()}):Ya();Db()}else sa&&e.leaveContext()},Ya=function(){a("#svg_source_editor").hide();aa=false;a("#svg_source_textarea").blur()};a(window).width();a(window).height();var Db=a.noop;a(window).resize(function(){K()});(function(){H.scroll(function(){if(a("#ruler_x").length!=0)a("#ruler_x")[0].scrollLeft=H[0].scrollLeft;if(a("#ruler_y").length!=0)a("#ruler_y")[0].scrollTop=H[0].scrollTop})})();
a("#url_notice").click(function(){a.alert(this.title)});a("#change_image_url").click(function(){var q=e.getHref(V);q=q.indexOf("data:")===0?"":q;a.prompt(uiStrings.notification.enterNewImgURL,q,function(v){v&&Ha(v)})});var p=function(q){var v=q[0].id=="stroke_color"?"stroke":"fill",w=q[0].id=="canvas_color";if(w)v="canvas";var z=b.paintBox[v].paint;q=v=="stroke"?"Pick a Stroke Paint and Opacity":"Pick a Fill Paint and Opacity";w=w?{right:175,top:50}:{left:50,bottom:50};a("#color_picker").draggable({cancel:".jGraduate_tabs, .jGraduate_colPick, .jGraduate_gradPick, .jPicker",
containment:"window"}).removeAttr("style").css(w).jGraduate({paint:z,window:{pickerTitle:q},images:{clientPath:curConfig.jGraduatePath},newstop:"inverse"},function(F){z=new a.jGraduate.Paint(F);b.paintBox[v].setPaint(z);e.setPaint(v,z);a("#color_picker").hide()},function(){a("#color_picker").hide()})};k=function(q,v){var w=document.getElementById("canvas_background"),z={color:"fff",opacity:1};if(v=="stroke")z=curConfig.initStroke;if(v=="fill")z=curConfig.initFill;if(v=="canvas"&&w)if(w=w.getAttribute("fill").match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/))z=
{color:("0"+parseInt(w[1],10).toString(16)).slice(-2)+("0"+parseInt(w[2],10).toString(16)).slice(-2)+("0"+parseInt(w[3],10).toString(16)).slice(-2),opacity:1};w=(new DOMParser).parseFromString('<svg xmlns="http://www.w3.org/2000/svg"><rect width="100%" height="100%"          fill="#'+z.color+'" opacity="'+z.opacity+'"/>          <defs><linearGradient id="gradbox_"/></defs></svg>',"text/xml").documentElement;w=a(q)[0].appendChild(document.importNode(w,true));v==="canvas"?w.setAttribute("width",60.5):
w.setAttribute("width","100%");this.rect=w.firstChild;this.defs=w.getElementsByTagName("defs")[0];this.grad=this.defs.firstChild;this.paint=new a.jGraduate.Paint({solidColor:z.color});this.type=v;this.setPaint=function(F,L){this.paint=F;var M="none",R=F.type,Z=F.alpha/100;switch(R){case "solidColor":M=F[R]=="none"||F[R]=="one"?"none":"#"+F[R];break;case "linearGradient":case "radialGradient":this.defs.removeChild(this.grad);this.grad=this.defs.appendChild(F[R]);M="url(#"+(this.grad.id="gradbox_"+
this.type)+")"}this.rect.setAttribute("fill",M);this.rect.setAttribute("opacity",Z);if(this.type=="canvas")if(R=document.getElementById("canvas_background")){wa=e.getResolution();R.setAttribute("x",-1);R.setAttribute("y",-1);R.setAttribute("width",wa.w+2);R.setAttribute("height",wa.h+2);M.indexOf("url")==-1&&R.setAttribute("fill",M)}else ra(M);if(L){e.setColor(this.type,M,true);e.setPaintOpacity(this.type,Z,true)}};this.update=function(F){if(V){var L=this.type;switch(V.tagName){case "use":case "image":case "foreignObject":return;
case "g":case "a":for(var M=null,R=V.getElementsByTagName("*"),Z=0,da=R.length;Z<da;Z++){var W=R[Z].getAttribute(L);if(Z===0)M=W;else if(M!==W){M=null;break}}if(M===null){R=null;return}R=M;M=1;break;default:M=parseFloat(V.getAttribute(L+"-opacity"));if(isNaN(M))M=1;R=L==="fill"?"black":"none";R=V.getAttribute(L)||R}if(F){e.setColor(L,R,true);e.setPaintOpacity(L,M,true)}M*=100;this.setPaint(ta(R,M,L))}};this.prep=function(){switch(this.paint.type){case "linearGradient":case "radialGradient":var F=
new a.jGraduate.Paint({copy:this.paint});e.setPaint(v,F)}}};b.paintBox.fill=new k("#fill_color","fill");b.paintBox.stroke=new k("#stroke_color","stroke");b.paintBox.canvas=new k("#canvas_color","canvas");a("#stroke_width").val(curConfig.initStroke.width);a("#group_opacity").val(curConfig.initOpacity*100);k=b.paintBox.fill.rect.cloneNode(false);k.setAttribute("style","vector-effect:non-scaling-stroke");var s=k.style.vectorEffect==="non-scaling-stroke";k.removeAttribute("style");k=b.paintBox.fill.rect.ownerDocument.createElementNS("http://www.w3.org/2000/svg",
"feGaussianBlur");typeof k.stdDeviationX==="undefined"&&a("#tool_blur").hide();a(k).remove();setTimeout(function(){e.embedImage("images/placeholder.svg",function(q){if(!q){a("#image_save_opts [value=embed]").attr("disabled","disabled");a("#image_save_opts input").val(["ref"]);d.img_save="ref";a("#image_opt_embed").css("color","#666").attr("title",uiStrings.notification.featNotSupported)}})},1E3);a("#tool_fill").click(function(){if(a("#tool_fill").hasClass("active"))p(a("#fill_color"));else{a("#tool_fill").addClass("active");
a("#tool_stroke").removeClass("active")}});a("#tool_stroke").on("click",function(){if(a("#tool_stroke").hasClass("active"))p(a("#stroke_color"));else{a("#tool_stroke").addClass("active");a("#tool_fill").removeClass("active")}});a("#tool_canvas").on("click touchstart",function(){p(a("#canvas_color"))});a("#tool_stroke").on("touchstart",function(){a("#tool_stroke").addClass("active");a("#tool_fill").removeClass("active");p(a("#stroke_color"))});a("#tool_fill").on("touchstart",function(){a("#tool_fill").addClass("active");
a("#tool_stroke").removeClass("active");p(a("#fill_color"))});a("#zoom_select").on("change",function(){var q=this.options[this.selectedIndex].text;q=q.split("%")[0];a("#zoom").val(q).trigger("change")});a(".push_button").mousedown(function(){a(this).hasClass("disabled")||a(this).addClass("push_button_pressed").removeClass("push_button")}).mouseout(function(){a(this).removeClass("push_button_pressed").addClass("push_button")}).mouseup(function(){a(this).removeClass("push_button_pressed").addClass("push_button")});
a(window).bind("load resize",function(){H.css("line-height",H.height()+"px")});var u=function(){var q=a("#canvas_width"),v=a("#canvas_height"),w=q.val(),z=v.val();if(w!="fit"&&!svgedit.units.isValidUnit("width",w)){a.alert(uiStrings.notification.invalidAttrValGiven);q.parent().addClass("error");return false}q.parent().removeClass("error");if(z!="fit"&&!svgedit.units.isValidUnit("height",z)){a.alert(uiStrings.notification.invalidAttrValGiven);v.parent().addClass("error");return false}v.parent().removeClass("error");
if(!e.setResolution(w,z)){a.alert(uiStrings.notification.noContentToFitTo);w=e.getResolution();q.val(w.w);v.val(w.h);return false}K()};a("#resolution").change(function(){var q=a("#canvas_width")[0],v=a("#canvas_height")[0];if(this.selectedIndex)if(this.value=="content"){q.value="fit";v.value="fit";u();var w=e.getResolution();q.value=w.w;v.value=w.h}else{var z=this.value.split("x");z[0]=parseInt(z[0]);z[1]=parseInt(z[1]);var F=z[0]-q.value,L=z[1]-v.value,M=Date.now(),R=function(){var Z=(Date.now()-
M)/1E3;Z=Math.pow(Z-1,3)+1;q.value=(z[0]-F+Z*F).toFixed(0);v.value=(z[1]-L+Z*L).toFixed(0);u();if(Z>=1){Z=e.getResolution();a("#canvas_width").val(Z.w.toFixed());a("#canvas_height").val(Z.h.toFixed());a("#resolution_label").html("<div class='pull'>"+Z.w+"<span>\u00d7</span></br>"+Z.h+"</div>")}else requestAnimationFrame(R)};R()}else{a("#resolution_label").html("Custom");q.removeAttribute("readonly");q.focus();q.select();if(q.value=="fit"){q.value=100;v.value=100}}});a("#zoom").change(function(){xa(this)});
a("input,select").attr("autocomplete","off");var D=function(){var q=[{sel:"#tool_select",fn:cb,evt:"click",key:["V",true]},{sel:"#tool_fhpath",fn:Ta,evt:"click",key:["Q",true]},{sel:"#tool_line",fn:Va,evt:"click",key:["L",true]},{sel:"#tool_rect",fn:Ia,evt:"click",key:["R",true],icon:"rect"},{sel:"#tool_ellipse",fn:ya,evt:"mouseup",key:["C",true],icon:"ellipse"},{sel:"#tool_path",fn:db,evt:"click",key:["P",true]},{sel:"#tool_text",fn:Ja,evt:"click",key:["T",true]},{sel:"#tool_image",fn:$a,evt:"mouseup"},
{sel:"#tool_zoom",fn:La,evt:"mouseup",key:["Z",true]},{sel:"#tool_clear",fn:Oa,evt:"mouseup",key:[o+"N",true]},{sel:"#tool_save",fn:function(){if(aa)Kb();else{Ca(a("#file_menu"));e.save({images:d.img_save,round_digits:6})}},evt:"mouseup",key:[o+"S",true]},{sel:"#tool_export",fn:nb,evt:"mouseup"},{sel:"#tool_open",fn:Ra,evt:"mouseup"},{sel:"#tool_import",fn:mb,evt:"mouseup"},{sel:"#tool_source",fn:Eb,evt:"click",key:[o+"U",true]},{sel:"#tool_wireframe",fn:Hb,evt:"click"},{sel:"#tool_snap",fn:Gb,evt:"click"},
{sel:"#tool_rulers",fn:Lb,evt:"click"},{sel:"#tool_source_cancel,#svg_source_overlay,#tool_docprops_cancel,#tool_prefs_cancel",fn:Ab,evt:"click",key:["esc",false,false],hidekey:true},{sel:"#tool_source_save",fn:Kb,evt:"click"},{sel:"#tool_delete,#tool_delete_multi",fn:lb,evt:"click",key:["del/backspace",true]},{sel:"#tool_reorient",fn:ob,evt:"click"},{sel:"#tool_node_link",fn:tb,evt:"change"},{sel:"#tool_node_clone",fn:la,evt:"click"},{sel:"#tool_node_delete",fn:ca,evt:"click"},{sel:"#tool_openclose_path",
fn:O,evt:"click"},{sel:"#tool_add_subpath",fn:ma,evt:"click"},{sel:"#tool_move_top",fn:va,evt:"click",key:o+"shift+up"},{sel:"#tool_move_bottom",fn:hb,evt:"click",key:o+"shift+down"},{sel:"#tool_move_up",fn:eb,evt:"click",key:[o+"up",true]},{sel:"#tool_move_down",fn:sb,evt:"click",key:[o+"down",true]},{sel:"#tool_topath",fn:ab,evt:"click"},{sel:"#tool_make_link,#tool_make_link_multi",fn:pb,evt:"click"},{sel:"#tool_clone,#tool_clone_multi",fn:Fb,evt:"click",key:[o+"D",true]},{sel:"#tool_group",fn:Bb,
evt:"click",key:[o+"G",true]},{sel:"#tool_ungroup",fn:Bb,evt:"click",key:o+"shift+G"},{sel:"#tool_unlink_use",fn:Bb,evt:"click"},{sel:"[id^=tool_align]",fn:bb,evt:"click"},{sel:"#tool_undo",fn:qb,evt:"click",key:o+"z"},{sel:"#tool_redo",fn:rb,evt:"click",key:["y",true]},{sel:"#tool_cut",fn:Ua,evt:"click",key:[o+"x",true]},{sel:"#tool_copy",fn:Xa,evt:"click",key:o+"c"},{sel:"#tool_paste",fn:wb,evt:"click",key:o+"v"},{sel:"#tool_switch",fn:Ma,evt:"click",key:["x",true]},{sel:"#tool_bold",fn:Wa,evt:"mousedown",
key:[o+"B",true]},{sel:"#tool_italic",fn:Za,evt:"mousedown",key:[o+"I",true]},{sel:"#copy_save_done",fn:Ab,evt:"click"},{key:"ctrl+left",fn:function(){Ga(0,1)}},{key:"ctrl+right",fn:function(){Ga(1,1)}},{key:"ctrl+shift+left",fn:function(){Ga(0,5)}},{key:"ctrl+shift+right",fn:function(){Ga(1,5)}},{key:"shift+O",fn:fa},{key:"shift+P",fn:S},{key:[o+"+",true],fn:function(){yb(2)}},{key:[o+"-",true],fn:function(){yb(0.5)}},{key:["up",true],fn:function(){fb(0,-1)}},{key:["down",true],fn:function(){fb(0,
1)}},{key:["left",true],fn:function(){fb(-1,0)}},{key:["right",true],fn:function(){fb(1,0)}},{key:"shift+up",fn:function(){fb(0,-10)}},{key:"shift+down",fn:function(){fb(0,10)}},{key:"shift+left",fn:function(){fb(-10,0)}},{key:"shift+right",fn:function(){fb(10,0)}},{key:["alt+up",true],fn:function(){e.cloneSelectedElements(0,-1)}},{key:["alt+down",true],fn:function(){e.cloneSelectedElements(0,1)}},{key:["alt+left",true],fn:function(){e.cloneSelectedElements(-1,0)}},{key:["alt+right",true],fn:function(){e.cloneSelectedElements(1,
0)}},{key:["alt+shift+up",true],fn:function(){e.cloneSelectedElements(0,-10)}},{key:["alt+shift+down",true],fn:function(){e.cloneSelectedElements(0,10)}},{key:["alt+shift+left",true],fn:function(){e.cloneSelectedElements(-10,0)}},{key:["alt+shift+right",true],fn:function(){e.cloneSelectedElements(10,0)}},{key:o+"A",fn:function(){e.selectAllInCurrentLayer()}},{key:"I",fn:function(){var w=a(".tool_button_current");if(w.length&&w[0].id!=="tool_eyedropper"){w.removeClass("tool_button_current").addClass("tool_button");
a("#tool_eyedropper").addClass("tool_button_current").removeClass("tool_button")}e.setMode("eyedropper")}},{key:o+"shift+z",fn:rb},{key:"esc",fn:Ib}],v={"4/Shift+4":"#tools_rect_show","5/Shift+5":"#tools_ellipse_show"};return{setAll:function(){var w={};a.each(q,function(z,F){if(F.sel){var L=a(F.sel);if(L.length==0)return true;if(F.evt){if(svgedit.browser.isTouch()&&F.evt==="click")F.evt="mousedown";L[F.evt](F.fn)}if(F.parent&&a(F.parent+"_show").length!=0){var M=a(F.parent);M.length||(M=oa(F.parent.substr(1)));
M.append(L);a.isArray(w[F.parent])||(w[F.parent]=[]);w[F.parent].push(F)}}if(F.key){var R=F.fn,Z=false;if(a.isArray(F.key)){M=F.key[0];if(F.key.length>1)Z=F.key[1]}else M=F.key;M+="";svgedit.browser.isMac&&M.indexOf("+")!=-1&&M.split("+")[0]=="ctrl"&&M.replace("ctrl","cmd");a.each(M.split("/"),function(W,ga){a(document).bind("keydown",ga,function(ha){R();Z&&ha.preventDefault();return false})});if(F.sel&&!F.hidekey&&L.attr("title")){var da=L.attr("title").split("[")[0]+" ("+M+")";v[M]=F.sel;L.parents("#main_menu").length||
L.attr("title",da)}}});Y(w);a(window).bind("keydown","tab",function(z){if(N==="canvas"){z.preventDefault();S()}}).bind("keydown","shift+tab",function(z){if(N==="canvas"){z.preventDefault();fa()}});a("#tool_zoom").dblclick(Sa)},setTitles:function(){a.each(v,function(w,z){var F=a(z).parents("#main_menu").length;a(z).each(function(){var L=F?a(this).text().split(" [")[0]:this.title.split(" [")[0],M="";a.each(w.split("/"),function(R,Z){var da=Z.split("+"),W="";if(da.length>1){W=da[0]+"+";Z=da[1]}M+=(R?
"/":"")+W+(uiStrings["key_"+Z]||Z)});if(F)this.lastChild.textContent=L+" ["+M+"]";else this.title=L+" ["+M+"]"})})},getButtonData:function(w){var z;a.each(q,function(F,L){if(L.sel===w)z=L});return z}}}();D.setAll();b.ready(function(){var q=curConfig.initTool,v=a("#tools_left, #svg_editor .tools_flyout"),w=v.find("#tool_"+q);q=v.find("#"+q);(w.length?w:q.length?q:a("#tool_select")).click().mouseup();curConfig.wireframe&&a("#tool_wireframe").click();curConfig.showlayers&&toggleSidePanel();a("#rulers").toggle(!!curConfig.showRulers)});
a("#canvas_height").dragInput({min:10,max:null,step:10,callback:u,cursor:false,dragAdjust:0.1});a("#canvas_width").dragInput({min:10,max:null,step:10,callback:u,cursor:false,dragAdjust:0.1});a("#rect_width").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});a("#rect_height").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});a("#ellipse_cx").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});a("#ellipse_cy").dragInput({min:1,max:null,
step:1,callback:changeAttribute,cursor:false});a("#ellipse_rx").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});a("#ellipse_ry").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});a("#image_height").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});a("#circle_cx").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});a("#circle_cy").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});a("#circle_r").dragInput({min:1,
max:null,step:1,callback:changeAttribute,cursor:false});a("#image_height").dragInput({min:0,max:null,step:1,callback:changeAttribute,cursor:false});a("#selected_x").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#selected_y").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#path_node_x").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#path_node_y").dragInput({min:null,max:null,step:1,callback:changeAttribute,
cursor:false});a("#image_width").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#line_x1").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#line_x2").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#line_y1").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#line_y2").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#path_x").dragInput({min:null,
max:null,step:1,callback:changeAttribute,cursor:false});a("#path_y").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#rect_x").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#rect_y").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#g_x").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#g_y").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#image_x").dragInput({min:null,
max:null,step:1,callback:changeAttribute,cursor:false});a("#text_y").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#text_x").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#image_y").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#rect_rx").dragInput({min:0,max:100,step:1,callback:changeAttribute,cursor:true});a("#stroke_width").dragInput({min:0,max:99,step:1,callback:function(q){var v=q.value;if(v==0&&
V&&["line","polyline"].indexOf(V.nodeName)>=0)v=q.value=1;e.setStrokeWidth(v)},cursor:true,smallStep:0.1,start:1.5});a("#angle").dragInput({min:-180,max:180,step:1,callback:function(q){e.setRotationAngle(q.value,true);rotateCursor(q.value);a("#tool_reorient").toggleClass("disabled",q.value==0)},cursor:false,dragAdjust:0.5});a("#font_size").dragInput({min:1,max:250,step:1,callback:function(q){e.setFontSize(q.value)},cursor:true,stepfunc:function(q,v){var w=q.value-0,z=w+v,F=z>=w;if(v===0)return w;
return w>=24?F?Math.round(w*1.1):Math.round(w/1.1):w<=1?F?w*2:w/2:z},dragAdjust:0.15});a("#group_opacity").dragInput({min:0,max:100,step:5,callback:changeAttribute,cursor:true,start:100});a("#blur").dragInput({min:0,max:10,step:0.1,callback:function(q,v){val=q.value;a("#blur").val(val);v?e.setBlur(val,true):e.setBlurNoUndo(val)},cursor:true,start:0});a("#zoom").val(e.getZoom()*100);a("#workarea").contextMenu({menu:"cmenu_canvas",inSpeed:0},function(q){switch(q){case "delete":lb();break;case "cut":Ua();
break;case "copy":Xa();break;case "paste":e.pasteElements();break;case "paste_in_place":e.pasteElements("in_place");break;case "group":e.groupSelectedElements();break;case "ungroup":e.ungroupSelectedElement();break;case "move_front":va();break;case "move_up":ib("Up");break;case "move_down":ib("Down");break;case "move_back":hb();break;default:svgedit.contextmenu&&svgedit.contextmenu.hasCustomHandler(q)&&svgedit.contextmenu.getCustomHandler(q).call()}});a(".contextMenu li").mousedown(function(q){q.preventDefault()});
a("#cmenu_canvas li").disableContextMenu();G.enableContextMenuItems("#delete,#cut,#copy");window.onbeforeunload=function(){if(m.getUndoStackSize()===0)b.show_save_warning=false;if(!curConfig.no_save_warning&&b.show_save_warning)return uiStrings.notification.unsavedChanges};b.openPrep=function(q){a("#main_menu").hide();m.getUndoStackSize()===0?q(true):a.confirm(uiStrings.notification.QwantToOpen,q)};if(window.FileReader){k=function(q){q.stopPropagation();q.preventDefault();a("#workarea").removeAttr("style");
a("#main_menu").hide();var v=null;if(v=q.type=="drop"?q.dataTransfer.files[0]:this.files[0])if(v.type.indexOf("image")!=-1)if(v.type.indexOf("svg")!=-1){q=new FileReader;q.onloadend=function(w){e.importSvgString(w.target.result,true);e.ungroupSelectedElement();e.ungroupSelectedElement();e.groupSelectedElements();e.alignSelectedElements("m","page");e.alignSelectedElements("c","page")};q.readAsText(v)}else{q=new FileReader;q.onloadend=function(w){insertNewImage=function(M,R){var Z=e.addSvgElementFromJson({element:"image",
attr:{x:0,y:0,width:M,height:R,id:e.getNextId(),style:"pointer-events:inherit"}});e.setHref(Z,w.target.result);e.selectOnly([Z]);e.alignSelectedElements("m","page");e.alignSelectedElements("c","page");Da()};var z=100,F=100,L=new Image;L.src=w.target.result;document.body.appendChild(L);L.onload=function(){z=L.offsetWidth;F=L.offsetHeight;insertNewImage(z,F);document.body.removeChild(L)}};q.readAsDataURL(v)}};H=a("#workarea");H[0].addEventListener("dragenter",function(q){q.stopPropagation();q.preventDefault();
H.css({"-webkit-transform":"scale3d(1.1,1.1,1)","-moz-transform":"scale3d(1.1,1.1,1)","-o-transform":"scale(1.1)","-ms-transform":"scale3d(1.1,1.1,1)",transform:"scale3d(1.1,1.1,1)"})},false);H[0].addEventListener("dragover",function(q){q.stopPropagation();q.preventDefault()},false);H[0].addEventListener("dragleave",function(q){H.removeAttr("style");q.stopPropagation();q.preventDefault()},false);H[0].addEventListener("drop",k,false);var B=a('<input type="file">').change(function(){var q=this;b.openPrep(function(v){if(v){e.clear();
if(q.files.length==1){v=new FileReader;v.onloadend=function(w){f(w.target.result);K()};v.readAsText(q.files[0])}}})});a("#tool_open").show().prepend(B);k=a('<input type="file">').change(k);a("#tool_import").show().prepend(k)}var K=b.updateCanvas=function(q,v){var w=H.width(),z=H.height(),F=w,L=z,M=e.getZoom(),R=H,Z=a("#svgcanvas"),da={x:R[0].scrollLeft+F/2,y:R[0].scrollTop+L/2},W=curConfig.canvas_expansion;w=Math.max(F,e.contentW*M*W);z=Math.max(L,e.contentH*M*W);w==F&&z==L?H.css("overflow","hidden"):
H.css("overflow","scroll");W=Z.height()/2;var ga=Z.width()/2;Z.width(w).height(z);var ha=z/2,X=w/2,qa=e.updateCanvas(w,z),za=X/ga;w=w/2-F/2;z=z/2-L/2;if(v){v.x+=qa.x;v.y+=qa.y}else v={x:X+(da.x-ga)*za,y:ha+(da.y-W)*za};if(q)if(e.contentW>R.width()){H[0].scrollLeft=qa.x-10;H[0].scrollTop=qa.y-10}else{R[0].scrollLeft=w;R[0].scrollTop=z}else{R[0].scrollLeft=v.x-F/2;R[0].scrollTop=v.y-L/2}if(curConfig.showRulers){F=Z;M=M;document.getElementById("workarea");document.getElementById("title_show");M||(M=
e.getZoom());F||(F=a("#svgcanvas"));L=e.getContentElem();R=svgedit.units.getTypeMap()[curConfig.baseUnit];for(Z=0;Z<2;Z++){ga=(da=Z===0)?"x":"y";za=da?"width":"height";W=L.getAttribute(ga)-0;ga=a("#ruler_"+ga+" canvas:first");$hcanv=ga.clone();ga.replaceWith($hcanv);w=$hcanv[0];ha=ga=F[za]()*2;w.parentNode.style[za]=ha+"px";X=0;var Ea;qa=w.getContext("2d");qa.fillStyle="rgb(200,0,0)";qa.fillRect(0,0,w.width,w.height);$hcanv.siblings().remove();if(ga>=3E4){var Fa=parseInt(ga/3E4)+1;Ea=Array(Fa);Ea[0]=
qa;for(z=1;z<Fa;z++){w[za]=3E4;var Pa=w.cloneNode(true);w.parentNode.appendChild(Pa);Ea[z]=Pa.getContext("2d")}Pa[za]=ga%3E4;ga=3E4}w[za]=ga;za=R*M;var Qa=50/za;w=1;for(z=0;z<E.length;z++){w=Fa=E[z];if(Qa<=Fa)break}Qa=w*za;qa.font="normal 9px 'Lucida Grande', sans-serif";qa.fillStyle="#777";for(var Na=W/za%w*za,jb=Na-Qa;Na<ha;Na+=Qa){jb+=Qa;z=Math.round(Na)+0.5;if(da){qa.moveTo(z,15);qa.lineTo(z,0)}else{qa.moveTo(15,z);qa.lineTo(0,z)}Fa=(jb-W)/za;if(w>=1)z=Math.round(Fa);else{z=(w+"").split(".")[1].length;
z=Fa.toFixed(z)-0}if(z!==0&&z!==1E3&&z%1E3===0)z=z/1E3+"K";if(da){qa.fillText(z,Na+2,8);qa.fillStyle="#777"}else{Fa=(z+"").split("");for(z=0;z<Fa.length;z++){qa.fillText(Fa[z],1,Na+9+z*9);qa.fillStyle="#777"}}Fa=Qa/10;for(z=1;z<10;z++){var ub=Math.round(Na+Fa*z)+0.5;if(Ea&&ub>ga){X++;qa.stroke();if(X>=Ea.length){z=10;Na=ha;continue}qa=Ea[X];Na-=3E4;ub=Math.round(Na+Fa*z)+0.5}var Cb=z%2?12:10;if(da){qa.moveTo(ub,15);qa.lineTo(ub,Cb)}else{qa.moveTo(15,ub);qa.lineTo(Cb,ub)}}}qa.strokeStyle="#666";qa.stroke()}H.scroll()}},
E=[];for(k=0.1;k<1E5;k*=10){E.push(1*k);E.push(2*k);E.push(5*k)}K(true);try{var A=function(q){if(window.JSON&&JSON.stringify)return JSON.stringify(q);var v=arguments.callee;if(typeof q=="boolean"||typeof q=="number")return q+"";else if(typeof q=="string")return'"'+q.replace(/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,function(F){return"\\u"+("0000"+F.charCodeAt(0).toString(16)).slice(-4)})+'"';else if(q.length){for(var w=
0;w<q.length;w++)q[w]=v(q[w]);return"["+q.join(",")+"]"}else{w=[];for(var z in q)w.push(v(z)+":"+v(q[z]));return"{"+w.join(",")+"}"}};window.addEventListener("message",function(q){var v=parseInt(q.data.substr(0,q.data.indexOf(";")));try{q.source.postMessage("SVGe"+v+";"+A(eval(q.data)),"*")}catch(w){q.source.postMessage("SVGe"+v+";error:"+w.message,"*")}},false)}catch(J){window.embed_error=J}a(function(){window.svgCanvas=e;e.ready=methodDraw.ready});b.setLang=function(q,v){a.pref("lang",q);a("#lang_select").val(q);
if(v){e.runExtensions("langChanged",q);na();a.each({"#stroke_color":"#tool_stroke .icon_label, #tool_stroke .color_block","#fill_color":"#tool_fill label, #tool_fill .color_block","#linejoin_miter":"#cur_linejoin","#linecap_butt":"#cur_linecap"},function(w,z){a(z).attr("title",a(w)[0].title)});a("#multiselected_panel div[id^=tool_align]").each(function(){a("#tool_pos"+this.id.substr(10))[0].title=this.title})}}};var h=[];b.ready=function(k){g?k():h.push(k)};b.runCallbacks=function(){a.each(h,function(){this()});
g=true};b.loadFromString=function(k){b.ready(function(){f(k)})};b.loadFromURL=function(k,l){l||(l={});var o=l.cache,n=l.callback;b.ready(function(){a.ajax({url:k,dataType:"text",cache:!!o,success:function(m){f(m,n)},error:function(m,C,I){m.status!=404&&m.responseText?f(m.responseText,n):a.alert(uiStrings.notification.URLloadFail+": \n"+I+"",n)}})})};b.loadFromDataURI=function(k){b.ready(function(){var l=k.substring(26);f(svgedit.utilities.decode64(l))})};b.addExtension=function(){var k=arguments;
a(function(){e&&e.addExtension.apply(this,k)})};return b}(jQuery);$(methodDraw.init)})();$.fn.dragInput=function(a){return this.each(function(){this.repeating=false;this.dragCfg={min:a&&!isNaN(parseFloat(a.min))?Number(a.min):null,max:a&&!isNaN(parseFloat(a.max))?Number(a.max):null,step:a&&Number(a.step)?a.step:1,stepfunc:a&&a.stepfunc?a.stepfunc:false,dragAdjust:a&&a.dragAdjust?a.dragAdjust:1,height:70,cursor:a&&a.cursor?Boolean(a.cursor):false,start:a&&a.start?Number(a.start):0,_btn_width:20,_direction:null,_delay:null,_repeat:null,callback:a&&a.callback?a.callback:null};this.dragCfg.smallStep=
a&&a.smallStep?a.smallStep:this.dragCfg.step/2;var f=this.dragCfg.dragAdjust,e=$(this).parent(),b=$(this),g=this.dragCfg.height,d=this.dragCfg.min,c=this.dragCfg.max,h=this.dragCfg.step,k=c-d>0?(c-d)/h:200,l=k/g*h,o=0,n=this.getAttribute("data-attr"),m=methodDraw.canvas,C=svgedit.browser.isTouch(),I=true,H=k&&this.dragCfg.cursor?$("<div class='draginput_cursor' />").appendTo(e):false;b.attr("readonly","readonly");H&&!isNaN(this.dragCfg.start)&&H.css("top",this.dragCfg.start*-1/l+g);this.adjustValue=
function(G,P){var Q;G=parseFloat(G);Q=isNaN(this.value)?this.dragCfg.reset:$.isFunction(this.dragCfg.stepfunc)?this.dragCfg.stepfunc(this,G):Number((Number(this.value)+Number(G)).toFixed(5));if(c!==null)Q=Math.min(Q,c);if(d!==null)Q=Math.max(Q,d);H&&this.updateCursor(Q);this.value=Q;e.attr("data-value",Q);$.isFunction(this.dragCfg.callback)&&this.dragCfg.callback(this,P)};e.toggleClass("draginput",e.is("label"));this.move=function(G,P,Q){if(C)G=G.originalEvent.touches[0];if(o===0)o=P;P=(G.pageY-o)*
-1;o=G.pageY;Q=P*l*f;this.adjustValue(Q.toFixed(h<1?1:0))};this.stop=function(){var G=m.getSelectedElems();$("body").removeClass("dragging");e.removeClass("active");I=true;$(window).unbind("mousemove.draginput touchmove.draginput mouseup.draginput touchend.draginput");o=0;if(G[0]){G=m.undoMgr.finishUndoableChange();G.isEmpty()||m.undoMgr.addCommandToHistory(G)}this.adjustValue(0,I)};this.updateCursor=function(){var G=parseFloat(this.value)*-1/l+g;H.css("top",G)};this.launch=function(G){var P=m.getSelectedElems();
if(C)G=G.originalEvent.touches[0];var Q=G.pageY,N=this.value,ba=this;m.undoMgr.beginUndoableChange(n,P);$("body").addClass("dragging");e.addClass("active");$(window).bind("mousemove.draginput touchmove.draginput",function(ja){ba.move(ja,Q,parseFloat(N))});$(window).bind("mouseup.draginput touchend.draginput",function(){ba.stop()})};$(this).attr("readonly","readonly").attr("data-scale",l).attr("data-domain",g).attr("data-cursor",H!=false).bind("mousedown touchstart",function(G){this.blur();this.launch(G)}).bind("dblclick taphold",
function(){this.removeAttribute("readonly","readonly");this.focus();this.select()}).keydown(function(G){switch(G.keyCode){case 13:this.adjustValue(0);this.blur()}}).focus(function(){this.getAttribute("readonly")==="readonly"&&this.blur()}).blur(function(){this.setAttribute("readonly","readonly")}).bind("mousewheel",function(G,P,Q,N){P=m.getSelectedElems();I&&m.undoMgr.beginUndoableChange(n,P);I=false;clearTimeout(window.undoTimeout);window.undoTimeout=setTimeout(function(){ba.stop()},200);var ba=
this;if(N>0)this.adjustValue(this.dragCfg.step);else N<0&&this.adjustValue(-this.dragCfg.step);G.preventDefault()})})};$.fn.dragInput.updateCursor=function(a){var f=parseFloat(a.value),e=parseFloat(a.getAttribute("data-scale")),b=parseFloat(a.getAttribute("data-domain"));f=f*-1/e+b+"px";a=a.parentNode.lastChild;if(a.className=="draginput_cursor")a.style.top=f};svgedit=svgedit||{};
(function(){var a=this;if(!svgedit.contextmenu)svgedit.contextmenu={};a.contextMenuExtensions={};methodDraw.ready(function(){for(menuItem in contextMenuExtensions){var f=contextMenuExtensions[menuItem];Object.keys(a.contextMenuExtensions).length==0&&$("#cmenu_canvas").append("<li class='separator'>");var e=f.shortcut||"";$("#cmenu_canvas").append("<li class='disabled'><a href='#"+f.id+"'>"+f.label+"<span class='shortcut'>"+e+"</span></a></li>")}});svgedit.contextmenu.resetCustomMenus=function(){a.contextMenuExtensions=
{}};svgedit.contextmenu.add=function(f){if(f&&f.id&&f.label&&f.action&&typeof f.action=="function")if(f.id in a.contextMenuExtensions)console.error('Cannot add extension "'+f.id+'", an extension by that name already exists"');else{console.log("Registed contextmenu item: {id:"+f.id+", label:"+f.label+"}");a.contextMenuExtensions[f.id]=f}else console.error("Menu items must be defined and have at least properties: id, label, action, where action must be a function")};svgedit.contextmenu.hasCustomHandler=
function(f){return a.contextMenuExtensions[f]&&true};svgedit.contextmenu.getCustomHandler=function(f){return a.contextMenuExtensions[f].action}})();(function(a,f){function e(b){return!a(b).parents().andSelf().filter(function(){return a.curCSS(this,"visibility")==="hidden"||a.expr.filters.hidden(this)}).length}a.ui=a.ui||{};if(!a.ui.version){a.extend(a.ui,{version:"1.8.3",plugin:{add:function(b,g,d){b=a.ui[b].prototype;for(var c in d){b.plugins[c]=b.plugins[c]||[];b.plugins[c].push([g,d[c]])}},call:function(b,g,d){if((g=b.plugins[g])&&b.element[0].parentNode)for(var c=0;c<g.length;c++)b.options[g[c][0]]&&g[c][1].apply(b.element,d)}},contains:function(b,
g){return document.compareDocumentPosition?b.compareDocumentPosition(g)&16:b!==g&&b.contains(g)},hasScroll:function(b,g){if(a(b).css("overflow")==="hidden")return false;g=g&&g==="left"?"scrollLeft":"scrollTop";var d=false;if(b[g]>0)return true;b[g]=1;d=b[g]>0;b[g]=0;return d},isOverAxis:function(b,g,d){return b>g&&b<g+d},isOver:function(b,g,d,c,h,k){return a.ui.isOverAxis(b,d,h)&&a.ui.isOverAxis(g,c,k)},keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,
CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}});a.fn.extend({_focus:a.fn.focus,focus:function(b,g){return typeof b==="number"?this.each(function(){var d=this;setTimeout(function(){a(d).focus();g&&g.call(d)},b)}):this._focus.apply(this,arguments)},enableSelection:function(){return this.attr("unselectable",
"off").css("MozUserSelect","")},disableSelection:function(){return this.attr("unselectable","on").css("MozUserSelect","none")},scrollParent:function(){var b;b=a.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(a.curCSS(this,"position",1))&&/(auto|scroll)/.test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(a.curCSS(this,
"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0);return/fixed/.test(this.css("position"))||!b.length?a(document):b},zIndex:function(b){if(b!==f)return this.css("zIndex",b);if(this.length){b=a(this[0]);for(var g;b.length&&b[0]!==document;){g=b.css("position");if(g==="absolute"||g==="relative"||g==="fixed"){g=parseInt(b.css("zIndex"));if(!isNaN(g)&&g!=0)return g}b=b.parent()}}return 0}});a.each(["Width","Height"],function(b,g){function d(l,o,n,m){a.each(c,function(){o-=
parseFloat(a.curCSS(l,"padding"+this,true))||0;if(n)o-=parseFloat(a.curCSS(l,"border"+this+"Width",true))||0;if(m)o-=parseFloat(a.curCSS(l,"margin"+this,true))||0});return o}var c=g==="Width"?["Left","Right"]:["Top","Bottom"],h=g.toLowerCase(),k={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+g]=function(l){if(l===f)return k["inner"+g].call(this);return this.each(function(){a.style(this,h,d(this,l)+"px")})};a.fn["outer"+
g]=function(l,o){if(typeof l!=="number")return k["outer"+g].call(this,l);return this.each(function(){a.style(this,h,d(this,l,true,o)+"px")})}});a.extend(a.expr[":"],{data:function(b,g,d){return!!a.data(b,d[3])},focusable:function(b){var g=b.nodeName.toLowerCase(),d=a.attr(b,"tabindex");if("area"===g){g=b.parentNode;d=g.name;if(!b.href||!d||g.nodeName.toLowerCase()!=="map")return false;b=a("img[usemap=#"+d+"]")[0];return!!b&&e(b)}return(/input|select|textarea|button|object/.test(g)?!b.disabled:"a"==
g?b.href||!isNaN(d):!isNaN(d))&&e(b)},tabbable:function(b){var g=a.attr(b,"tabindex");return(isNaN(g)||g>=0)&&a(b).is(":focusable")}})}})(jQuery);
(function(a,f){var e=a.fn.remove;a.fn.remove=function(b,g){return this.each(function(){if(!g)if(!b||a.filter(b,[this]).length)a("*",this).add([this]).each(function(){a(this).triggerHandler("remove")});return e.call(a(this),b,g)})};a.widget=function(b,g,d){var c=b.split(".")[0],h;b=b.split(".")[1];h=c+"-"+b;if(!d){d=g;g=a.Widget}a.expr[":"][h]=function(k){return!!a.data(k,b)};a[c]=a[c]||{};a[c][b]=function(k,l){arguments.length&&this._createWidget(k,l)};g=new g;g.options=a.extend(true,{},g.options);
a[c][b].prototype=a.extend(true,g,{namespace:c,widgetName:b,widgetEventPrefix:a[c][b].prototype.widgetEventPrefix||b,widgetBaseClass:h},d);a.widget.bridge(b,a[c][b])};a.widget.bridge=function(b,g){a.fn[b]=function(d){var c=typeof d==="string",h=Array.prototype.slice.call(arguments,1),k=this;d=!c&&h.length?a.extend.apply(null,[true,d].concat(h)):d;if(c&&d.substring(0,1)==="_")return k;c?this.each(function(){var l=a.data(this,b),o=l&&a.isFunction(l[d])?l[d].apply(l,h):l;if(o!==l&&o!==f){k=o;return false}}):
this.each(function(){var l=a.data(this,b);if(l){d&&l.option(d);l._init()}else a.data(this,b,new g(d,this))});return k}};a.Widget=function(b,g){arguments.length&&this._createWidget(b,g)};a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:false},_createWidget:function(b,g){a.data(g,this.widgetName,this);this.element=a(g);this.options=a.extend(true,{},this.options,a.metadata&&a.metadata.get(g)[this.widgetName],b);var d=this;this.element.bind("remove."+this.widgetName,function(){d.destroy()});
this._create();this._init()},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName);this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled ui-state-disabled")},widget:function(){return this.element},option:function(b,g){var d=b,c=this;if(arguments.length===0)return a.extend({},c.options);if(typeof b==="string"){if(g===f)return this.options[b];d={};d[b]=g}a.each(d,function(h,
k){c._setOption(h,k)});return c},_setOption:function(b,g){this.options[b]=g;if(b==="disabled")this.widget()[g?"addClass":"removeClass"](this.widgetBaseClass+"-disabled ui-state-disabled").attr("aria-disabled",g);return this},enable:function(){return this._setOption("disabled",false)},disable:function(){return this._setOption("disabled",true)},_trigger:function(b,g,d){var c=this.options[b];g=a.Event(g);g.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase();d=d||{};if(g.originalEvent){b=
a.event.props.length;for(var h;b;){h=a.event.props[--b];g[h]=g.originalEvent[h]}}this.element.trigger(g,d);return!(a.isFunction(c)&&c.call(this.element[0],g,d)===false||g.isDefaultPrevented())}}})(jQuery);
(function(a){a.widget("ui.mouse",{options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var f=this;this.element.bind("mousedown."+this.widgetName,function(e){return f._mouseDown(e)}).bind("click."+this.widgetName,function(e){if(f._preventClickEvent){f._preventClickEvent=false;e.stopImmediatePropagation();return false}});this.started=false},_mouseDestroy:function(){this.element.unbind("."+this.widgetName)},_mouseDown:function(f){f.originalEvent=f.originalEvent||{};if(!f.originalEvent.mouseHandled){this._mouseStarted&&
this._mouseUp(f);this._mouseDownEvent=f;var e=this,b=f.which==1,g=typeof this.options.cancel=="string"?a(f.target).parents().add(f.target).filter(this.options.cancel).length:false;if(!b||g||!this._mouseCapture(f))return true;this.mouseDelayMet=!this.options.delay;if(!this.mouseDelayMet)this._mouseDelayTimer=setTimeout(function(){e.mouseDelayMet=true},this.options.delay);if(this._mouseDistanceMet(f)&&this._mouseDelayMet(f)){this._mouseStarted=this._mouseStart(f)!==false;if(!this._mouseStarted){f.preventDefault();
return true}}this._mouseMoveDelegate=function(d){return e._mouseMove(d)};this._mouseUpDelegate=function(d){return e._mouseUp(d)};a(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);a.browser.safari||f.preventDefault();return f.originalEvent.mouseHandled=true}},_mouseMove:function(f){if(a.browser.msie&&!f.button)return this._mouseUp(f);if(this._mouseStarted){this._mouseDrag(f);return f.preventDefault()}if(this._mouseDistanceMet(f)&&
this._mouseDelayMet(f))(this._mouseStarted=this._mouseStart(this._mouseDownEvent,f)!==false)?this._mouseDrag(f):this._mouseUp(f);return!this._mouseStarted},_mouseUp:function(f){a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);if(this._mouseStarted){this._mouseStarted=false;this._preventClickEvent=f.target==this._mouseDownEvent.target;this._mouseStop(f)}return false},_mouseDistanceMet:function(f){return Math.max(Math.abs(this._mouseDownEvent.pageX-
f.pageX),Math.abs(this._mouseDownEvent.pageY-f.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return true}})})(jQuery);
(function(a){a.widget("ui.draggable",a.ui.mouse,{widgetEventPrefix:"drag",options:{addClasses:true,appendTo:"parent",axis:false,connectToSortable:false,containment:false,cursor:"auto",cursorAt:false,grid:false,handle:false,helper:"original",iframeFix:false,opacity:false,refreshPositions:false,revert:false,revertDuration:500,scope:"default",scroll:true,scrollSensitivity:20,scrollSpeed:20,snap:false,snapMode:"both",snapTolerance:20,stack:false,zIndex:false},_create:function(){if(this.options.helper==
"original"&&!/^(?:r|a|f)/.test(this.element.css("position")))this.element[0].style.position="relative";this.options.addClasses&&this.element.addClass("ui-draggable");this.options.disabled&&this.element.addClass("ui-draggable-disabled");this._mouseInit()},destroy:function(){if(this.element.data("draggable")){this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled");this._mouseDestroy();return this}},_mouseCapture:function(f){var e=
this.options;if(this.helper||e.disabled||a(f.target).is(".ui-resizable-handle"))return false;this.handle=this._getHandle(f);if(!this.handle)return false;return true},_mouseStart:function(f){var e=this.options;this.helper=this._createHelper(f);this._cacheHelperProportions();if(a.ui.ddmanager)a.ui.ddmanager.current=this;this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent();this.offset=this.positionAbs=this.element.offset();this.offset={top:this.offset.top-
this.margins.top,left:this.offset.left-this.margins.left};a.extend(this.offset,{click:{left:f.pageX-this.offset.left,top:f.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this.position=this._generatePosition(f);this.originalPageX=f.pageX;this.originalPageY=f.pageY;e.cursorAt&&this._adjustOffsetFromHelper(e.cursorAt);e.containment&&this._setContainment();if(this._trigger("start",f)===false){this._clear();return false}this._cacheHelperProportions();
a.ui.ddmanager&&!e.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,f);this.helper.addClass("ui-draggable-dragging");this._mouseDrag(f,true);return true},_mouseDrag:function(f,e){this.position=this._generatePosition(f);this.positionAbs=this._convertPositionTo("absolute");if(!e){e=this._uiHash();if(this._trigger("drag",f,e)===false){this._mouseUp({});return false}this.position=e.position}if(!this.options.axis||this.options.axis!="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||
this.options.axis!="x")this.helper[0].style.top=this.position.top+"px";a.ui.ddmanager&&a.ui.ddmanager.drag(this,f);return false},_mouseStop:function(f){var e=false;if(a.ui.ddmanager&&!this.options.dropBehaviour)e=a.ui.ddmanager.drop(this,f);if(this.dropped){e=this.dropped;this.dropped=false}if(!this.element[0]||!this.element[0].parentNode)return false;if(this.options.revert=="invalid"&&!e||this.options.revert=="valid"&&e||this.options.revert===true||a.isFunction(this.options.revert)&&this.options.revert.call(this.element,
e)){var b=this;a(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){b._trigger("stop",f)!==false&&b._clear()})}else this._trigger("stop",f)!==false&&this._clear();return false},cancel:function(){this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear();return this},_getHandle:function(f){var e=!this.options.handle||!a(this.options.handle,this.element).length?true:false;a(this.options.handle,this.element).find("*").andSelf().each(function(){if(this==
f.target)e=true});return e},_createHelper:function(f){var e=this.options;f=a.isFunction(e.helper)?a(e.helper.apply(this.element[0],[f])):e.helper=="clone"?this.element.clone():this.element;f.parents("body").length||f.appendTo(e.appendTo=="parent"?this.element[0].parentNode:e.appendTo);f[0]!=this.element[0]&&!/(fixed|absolute)/.test(f.css("position"))&&f.css("position","absolute");return f},_adjustOffsetFromHelper:function(f){if(typeof f=="string")f=f.split(" ");if(a.isArray(f))f={left:+f[0],top:+f[1]||
0};if("left"in f)this.offset.click.left=f.left+this.margins.left;if("right"in f)this.offset.click.left=this.helperProportions.width-f.right+this.margins.left;if("top"in f)this.offset.click.top=f.top+this.margins.top;if("bottom"in f)this.offset.click.top=this.helperProportions.height-f.bottom+this.margins.top},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var f=this.offsetParent.offset();if(this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],
this.offsetParent[0])){f.left+=this.scrollParent.scrollLeft();f.top+=this.scrollParent.scrollTop()}if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&a.browser.msie)f={top:0,left:0};return{top:f.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:f.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var f=this.element.position();return{top:f.top-
(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:f.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}else return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var f=this.options;if(f.containment==
"parent")f.containment=this.helper[0].parentNode;if(f.containment=="document"||f.containment=="window")this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,a(f.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(a(f.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(f.containment)&&
f.containment.constructor!=Array){var e=a(f.containment)[0];if(e){f=a(f.containment).offset();var b=a(e).css("overflow")!="hidden";this.containment=[f.left+(parseInt(a(e).css("borderLeftWidth"),10)||0)+(parseInt(a(e).css("paddingLeft"),10)||0)-this.margins.left,f.top+(parseInt(a(e).css("borderTopWidth"),10)||0)+(parseInt(a(e).css("paddingTop"),10)||0)-this.margins.top,f.left+(b?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(parseInt(a(e).css("borderLeftWidth"),10)||0)-(parseInt(a(e).css("paddingRight"),
10)||0)-this.helperProportions.width-this.margins.left,f.top+(b?Math.max(e.scrollHeight,e.offsetHeight):e.offsetHeight)-(parseInt(a(e).css("borderTopWidth"),10)||0)-(parseInt(a(e).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}}else if(f.containment.constructor==Array)this.containment=f.containment},_convertPositionTo:function(f,e){if(!e)e=this.position;f=f=="absolute"?1:-1;var b=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],
this.offsetParent[0]))?this.offsetParent:this.scrollParent,g=/(html|body)/i.test(b[0].tagName);return{top:e.top+this.offset.relative.top*f+this.offset.parent.top*f-(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():g?0:b.scrollTop())*f),left:e.left+this.offset.relative.left*f+this.offset.parent.left*f-(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():
g?0:b.scrollLeft())*f)}},_generatePosition:function(f){var e=this.options,b=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,g=/(html|body)/i.test(b[0].tagName),d=f.pageX,c=f.pageY;if(this.originalPosition){if(this.containment){if(f.pageX-this.offset.click.left<this.containment[0])d=this.containment[0]+this.offset.click.left;if(f.pageY-this.offset.click.top<this.containment[1])c=this.containment[1]+
this.offset.click.top;if(f.pageX-this.offset.click.left>this.containment[2])d=this.containment[2]+this.offset.click.left;if(f.pageY-this.offset.click.top>this.containment[3])c=this.containment[3]+this.offset.click.top}if(e.grid){c=this.originalPageY+Math.round((c-this.originalPageY)/e.grid[1])*e.grid[1];c=this.containment?!(c-this.offset.click.top<this.containment[1]||c-this.offset.click.top>this.containment[3])?c:!(c-this.offset.click.top<this.containment[1])?c-e.grid[1]:c+e.grid[1]:c;d=this.originalPageX+
Math.round((d-this.originalPageX)/e.grid[0])*e.grid[0];d=this.containment?!(d-this.offset.click.left<this.containment[0]||d-this.offset.click.left>this.containment[2])?d:!(d-this.offset.click.left<this.containment[0])?d-e.grid[0]:d+e.grid[0]:d}}return{top:c-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollTop():g?0:b.scrollTop()),left:d-this.offset.click.left-
this.offset.relative.left-this.offset.parent.left+(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():g?0:b.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove();this.helper=null;this.cancelHelperRemoval=false},_trigger:function(f,e,b){b=b||this._uiHash();a.ui.plugin.call(this,f,[e,b]);if(f=="drag")this.positionAbs=
this._convertPositionTo("absolute");return a.Widget.prototype._trigger.call(this,f,e,b)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});a.extend(a.ui.draggable,{version:"1.8.3"});a.ui.plugin.add("draggable","connectToSortable",{start:function(f,e){var b=a(this).data("draggable"),g=b.options,d=a.extend({},e,{item:b.element});b.sortables=[];a(g.connectToSortable).each(function(){var c=a.data(this,"sortable");
if(c&&!c.options.disabled){b.sortables.push({instance:c,shouldRevert:c.options.revert});c._refreshItems();c._trigger("activate",f,d)}})},stop:function(f,e){var b=a(this).data("draggable"),g=a.extend({},e,{item:b.element});a.each(b.sortables,function(){if(this.instance.isOver){this.instance.isOver=0;b.cancelHelperRemoval=true;this.instance.cancelHelperRemoval=false;if(this.shouldRevert)this.instance.options.revert=true;this.instance._mouseStop(f);this.instance.options.helper=this.instance.options._helper;
b.options.helper=="original"&&this.instance.currentItem.css({top:"auto",left:"auto"})}else{this.instance.cancelHelperRemoval=false;this.instance._trigger("deactivate",f,g)}})},drag:function(f,e){var b=a(this).data("draggable"),g=this;a.each(b.sortables,function(){this.instance.positionAbs=b.positionAbs;this.instance.helperProportions=b.helperProportions;this.instance.offset.click=b.offset.click;if(this.instance._intersectsWith(this.instance.containerCache)){if(!this.instance.isOver){this.instance.isOver=
1;this.instance.currentItem=a(g).clone().appendTo(this.instance.element).data("sortable-item",true);this.instance.options._helper=this.instance.options.helper;this.instance.options.helper=function(){return e.helper[0]};f.target=this.instance.currentItem[0];this.instance._mouseCapture(f,true);this.instance._mouseStart(f,true,true);this.instance.offset.click.top=b.offset.click.top;this.instance.offset.click.left=b.offset.click.left;this.instance.offset.parent.left-=b.offset.parent.left-this.instance.offset.parent.left;
this.instance.offset.parent.top-=b.offset.parent.top-this.instance.offset.parent.top;b._trigger("toSortable",f);b.dropped=this.instance.element;b.currentItem=b.element;this.instance.fromOutside=b}this.instance.currentItem&&this.instance._mouseDrag(f)}else if(this.instance.isOver){this.instance.isOver=0;this.instance.cancelHelperRemoval=true;this.instance.options.revert=false;this.instance._trigger("out",f,this.instance._uiHash(this.instance));this.instance._mouseStop(f,true);this.instance.options.helper=
this.instance.options._helper;this.instance.currentItem.remove();this.instance.placeholder&&this.instance.placeholder.remove();b._trigger("fromSortable",f);b.dropped=false}})}});a.ui.plugin.add("draggable","cursor",{start:function(){var f=a("body"),e=a(this).data("draggable").options;if(f.css("cursor"))e._cursor=f.css("cursor");f.css("cursor",e.cursor)},stop:function(){var f=a(this).data("draggable").options;f._cursor&&a("body").css("cursor",f._cursor)}});a.ui.plugin.add("draggable","iframeFix",{start:function(){var f=
a(this).data("draggable").options;a(f.iframeFix===true?"iframe":f.iframeFix).each(function(){a('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1E3}).css(a(this).offset()).appendTo("body")})},stop:function(){a("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)})}});a.ui.plugin.add("draggable","opacity",{start:function(f,e){f=a(e.helper);e=a(this).data("draggable").options;
if(f.css("opacity"))e._opacity=f.css("opacity");f.css("opacity",e.opacity)},stop:function(f,e){f=a(this).data("draggable").options;f._opacity&&a(e.helper).css("opacity",f._opacity)}});a.ui.plugin.add("draggable","scroll",{start:function(){var f=a(this).data("draggable");if(f.scrollParent[0]!=document&&f.scrollParent[0].tagName!="HTML")f.overflowOffset=f.scrollParent.offset()},drag:function(f){var e=a(this).data("draggable"),b=e.options,g=false;if(e.scrollParent[0]!=document&&e.scrollParent[0].tagName!=
"HTML"){if(!b.axis||b.axis!="x")if(e.overflowOffset.top+e.scrollParent[0].offsetHeight-f.pageY<b.scrollSensitivity)e.scrollParent[0].scrollTop=g=e.scrollParent[0].scrollTop+b.scrollSpeed;else if(f.pageY-e.overflowOffset.top<b.scrollSensitivity)e.scrollParent[0].scrollTop=g=e.scrollParent[0].scrollTop-b.scrollSpeed;if(!b.axis||b.axis!="y")if(e.overflowOffset.left+e.scrollParent[0].offsetWidth-f.pageX<b.scrollSensitivity)e.scrollParent[0].scrollLeft=g=e.scrollParent[0].scrollLeft+b.scrollSpeed;else if(f.pageX-
e.overflowOffset.left<b.scrollSensitivity)e.scrollParent[0].scrollLeft=g=e.scrollParent[0].scrollLeft-b.scrollSpeed}else{if(!b.axis||b.axis!="x")if(f.pageY-a(document).scrollTop()<b.scrollSensitivity)g=a(document).scrollTop(a(document).scrollTop()-b.scrollSpeed);else if(a(window).height()-(f.pageY-a(document).scrollTop())<b.scrollSensitivity)g=a(document).scrollTop(a(document).scrollTop()+b.scrollSpeed);if(!b.axis||b.axis!="y")if(f.pageX-a(document).scrollLeft()<b.scrollSensitivity)g=a(document).scrollLeft(a(document).scrollLeft()-
b.scrollSpeed);else if(a(window).width()-(f.pageX-a(document).scrollLeft())<b.scrollSensitivity)g=a(document).scrollLeft(a(document).scrollLeft()+b.scrollSpeed)}g!==false&&a.ui.ddmanager&&!b.dropBehaviour&&a.ui.ddmanager.prepareOffsets(e,f)}});a.ui.plugin.add("draggable","snap",{start:function(){var f=a(this).data("draggable"),e=f.options;f.snapElements=[];a(e.snap.constructor!=String?e.snap.items||":data(draggable)":e.snap).each(function(){var b=a(this),g=b.offset();this!=f.element[0]&&f.snapElements.push({item:this,
width:b.outerWidth(),height:b.outerHeight(),top:g.top,left:g.left})})},drag:function(f,e){for(var b=a(this).data("draggable"),g=b.options,d=g.snapTolerance,c=e.offset.left,h=c+b.helperProportions.width,k=e.offset.top,l=k+b.helperProportions.height,o=b.snapElements.length-1;o>=0;o--){var n=b.snapElements[o].left,m=n+b.snapElements[o].width,C=b.snapElements[o].top,I=C+b.snapElements[o].height;if(n-d<c&&c<m+d&&C-d<k&&k<I+d||n-d<c&&c<m+d&&C-d<l&&l<I+d||n-d<h&&h<m+d&&C-d<k&&k<I+d||n-d<h&&h<m+d&&C-d<l&&
l<I+d){if(g.snapMode!="inner"){var H=Math.abs(C-l)<=d,G=Math.abs(I-k)<=d,P=Math.abs(n-h)<=d,Q=Math.abs(m-c)<=d;if(H)e.position.top=b._convertPositionTo("relative",{top:C-b.helperProportions.height,left:0}).top-b.margins.top;if(G)e.position.top=b._convertPositionTo("relative",{top:I,left:0}).top-b.margins.top;if(P)e.position.left=b._convertPositionTo("relative",{top:0,left:n-b.helperProportions.width}).left-b.margins.left;if(Q)e.position.left=b._convertPositionTo("relative",{top:0,left:m}).left-b.margins.left}var N=
H||G||P||Q;if(g.snapMode!="outer"){H=Math.abs(C-k)<=d;G=Math.abs(I-l)<=d;P=Math.abs(n-c)<=d;Q=Math.abs(m-h)<=d;if(H)e.position.top=b._convertPositionTo("relative",{top:C,left:0}).top-b.margins.top;if(G)e.position.top=b._convertPositionTo("relative",{top:I-b.helperProportions.height,left:0}).top-b.margins.top;if(P)e.position.left=b._convertPositionTo("relative",{top:0,left:n}).left-b.margins.left;if(Q)e.position.left=b._convertPositionTo("relative",{top:0,left:m-b.helperProportions.width}).left-b.margins.left}if(!b.snapElements[o].snapping&&
(H||G||P||Q||N))b.options.snap.snap&&b.options.snap.snap.call(b.element,f,a.extend(b._uiHash(),{snapItem:b.snapElements[o].item}));b.snapElements[o].snapping=H||G||P||Q||N}else{b.snapElements[o].snapping&&b.options.snap.release&&b.options.snap.release.call(b.element,f,a.extend(b._uiHash(),{snapItem:b.snapElements[o].item}));b.snapElements[o].snapping=false}}}});a.ui.plugin.add("draggable","stack",{start:function(){var f=a(this).data("draggable").options;f=a.makeArray(a(f.stack)).sort(function(b,g){return(parseInt(a(b).css("zIndex"),
10)||0)-(parseInt(a(g).css("zIndex"),10)||0)});if(f.length){var e=parseInt(f[0].style.zIndex)||0;a(f).each(function(b){this.style.zIndex=e+b});this[0].style.zIndex=e+f.length}}});a.ui.plugin.add("draggable","zIndex",{start:function(f,e){f=a(e.helper);e=a(this).data("draggable").options;if(f.css("zIndex"))e._zIndex=f.css("zIndex");f.css("zIndex",e.zIndex)},stop:function(f,e){f=a(this).data("draggable").options;f._zIndex&&a(e.helper).css("zIndex",f._zIndex)}})})(jQuery);
(function(a){a.widget("ui.droppable",{widgetEventPrefix:"drop",options:{accept:"*",activeClass:false,addClasses:true,greedy:false,hoverClass:false,scope:"default",tolerance:"intersect"},_create:function(){var f=this.options,e=f.accept;this.isover=0;this.isout=1;this.accept=a.isFunction(e)?e:function(b){return b.is(e)};this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight};a.ui.ddmanager.droppables[f.scope]=a.ui.ddmanager.droppables[f.scope]||[];a.ui.ddmanager.droppables[f.scope].push(this);
f.addClasses&&this.element.addClass("ui-droppable")},destroy:function(){for(var f=a.ui.ddmanager.droppables[this.options.scope],e=0;e<f.length;e++)f[e]==this&&f.splice(e,1);this.element.removeClass("ui-droppable ui-droppable-disabled").removeData("droppable").unbind(".droppable");return this},_setOption:function(f,e){if(f=="accept")this.accept=a.isFunction(e)?e:function(b){return b.is(e)};a.Widget.prototype._setOption.apply(this,arguments)},_activate:function(f){var e=a.ui.ddmanager.current;this.options.activeClass&&
this.element.addClass(this.options.activeClass);e&&this._trigger("activate",f,this.ui(e))},_deactivate:function(f){var e=a.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass);e&&this._trigger("deactivate",f,this.ui(e))},_over:function(f){var e=a.ui.ddmanager.current;if(!(!e||(e.currentItem||e.element)[0]==this.element[0]))if(this.accept.call(this.element[0],e.currentItem||e.element)){this.options.hoverClass&&this.element.addClass(this.options.hoverClass);
this._trigger("over",f,this.ui(e))}},_out:function(f){var e=a.ui.ddmanager.current;if(!(!e||(e.currentItem||e.element)[0]==this.element[0]))if(this.accept.call(this.element[0],e.currentItem||e.element)){this.options.hoverClass&&this.element.removeClass(this.options.hoverClass);this._trigger("out",f,this.ui(e))}},_drop:function(f,e){var b=e||a.ui.ddmanager.current;if(!b||(b.currentItem||b.element)[0]==this.element[0])return false;var g=false;this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function(){var d=
a.data(this,"droppable");if(d.options.greedy&&!d.options.disabled&&d.options.scope==b.options.scope&&d.accept.call(d.element[0],b.currentItem||b.element)&&a.ui.intersect(b,a.extend(d,{offset:d.element.offset()}),d.options.tolerance)){g=true;return false}});if(g)return false;if(this.accept.call(this.element[0],b.currentItem||b.element)){this.options.activeClass&&this.element.removeClass(this.options.activeClass);this.options.hoverClass&&this.element.removeClass(this.options.hoverClass);this._trigger("drop",
f,this.ui(b));return this.element}return false},ui:function(f){return{draggable:f.currentItem||f.element,helper:f.helper,position:f.position,offset:f.positionAbs}}});a.extend(a.ui.droppable,{version:"1.8.3"});a.ui.intersect=function(f,e,b){if(!e.offset)return false;var g=(f.positionAbs||f.position.absolute).left,d=g+f.helperProportions.width,c=(f.positionAbs||f.position.absolute).top,h=c+f.helperProportions.height,k=e.offset.left,l=k+e.proportions.width,o=e.offset.top,n=o+e.proportions.height;switch(b){case "fit":return k<=
g&&d<=l&&o<=c&&h<=n;case "intersect":return k<g+f.helperProportions.width/2&&d-f.helperProportions.width/2<l&&o<c+f.helperProportions.height/2&&h-f.helperProportions.height/2<n;case "pointer":return a.ui.isOver((f.positionAbs||f.position.absolute).top+(f.clickOffset||f.offset.click).top,(f.positionAbs||f.position.absolute).left+(f.clickOffset||f.offset.click).left,o,k,e.proportions.height,e.proportions.width);case "touch":return(c>=o&&c<=n||h>=o&&h<=n||c<o&&h>n)&&(g>=k&&g<=l||d>=k&&d<=l||g<k&&d>l);
default:return false}};a.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(f,e){var b=a.ui.ddmanager.droppables[f.options.scope]||[],g=e?e.type:null,d=(f.currentItem||f.element).find(":data(droppable)").andSelf(),c=0;a:for(;c<b.length;c++)if(!(b[c].options.disabled||f&&!b[c].accept.call(b[c].element[0],f.currentItem||f.element))){for(var h=0;h<d.length;h++)if(d[h]==b[c].element[0]){b[c].proportions.height=0;continue a}b[c].visible=b[c].element.css("display")!="none";if(b[c].visible){b[c].offset=
b[c].element.offset();b[c].proportions={width:b[c].element[0].offsetWidth,height:b[c].element[0].offsetHeight};g=="mousedown"&&b[c]._activate.call(b[c],e)}}},drop:function(f,e){var b=false;a.each(a.ui.ddmanager.droppables[f.options.scope]||[],function(){if(this.options){if(!this.options.disabled&&this.visible&&a.ui.intersect(f,this,this.options.tolerance))b=b||this._drop.call(this,e);if(!this.options.disabled&&this.visible&&this.accept.call(this.element[0],f.currentItem||f.element)){this.isout=1;
this.isover=0;this._deactivate.call(this,e)}}});return b},drag:function(f,e){f.options.refreshPositions&&a.ui.ddmanager.prepareOffsets(f,e);a.each(a.ui.ddmanager.droppables[f.options.scope]||[],function(){if(!(this.options.disabled||this.greedyChild||!this.visible)){var b=a.ui.intersect(f,this,this.options.tolerance);if(b=!b&&this.isover==1?"isout":b&&this.isover==0?"isover":null){var g;if(this.options.greedy){var d=this.element.parents(":data(droppable):eq(0)");if(d.length){g=a.data(d[0],"droppable");
g.greedyChild=b=="isover"?1:0}}if(g&&b=="isover"){g.isover=0;g.isout=1;g._out.call(g,e)}this[b]=1;this[b=="isout"?"isover":"isout"]=0;this[b=="isover"?"_over":"_out"].call(this,e);if(g&&b=="isout"){g.isout=0;g.isover=1;g._over.call(g,e)}}}})}}})(jQuery);
(function(a){a.widget("ui.resizable",a.ui.mouse,{widgetEventPrefix:"resize",options:{alsoResize:false,animate:false,animateDuration:"slow",animateEasing:"swing",aspectRatio:false,autoHide:false,containment:false,ghost:false,grid:false,handles:"e,s,se",helper:false,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:1E3},_create:function(){var b=this,g=this.options;this.element.addClass("ui-resizable");a.extend(this,{_aspectRatio:!!g.aspectRatio,aspectRatio:g.aspectRatio,originalElement:this.element,
_proportionallyResizeElements:[],_helper:g.helper||g.ghost||g.animate?g.helper||"ui-resizable-helper":null});if(this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)){/relative/.test(this.element.css("position"))&&a.browser.opera&&this.element.css({position:"relative",top:"auto",left:"auto"});this.element.wrap(a('<div class="ui-wrapper" style="overflow: hidden;"></div>').css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),
top:this.element.css("top"),left:this.element.css("left")}));this.element=this.element.parent().data("resizable",this.element.data("resizable"));this.elementIsWrapper=true;this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")});this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0});this.originalResizeStyle=
this.originalElement.css("resize");this.originalElement.css("resize","none");this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"}));this.originalElement.css({margin:this.originalElement.css("margin")});this._proportionallyResize()}this.handles=g.handles||(!a(".ui-resizable-handle",this.element).length?"e,s,se":{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",
nw:".ui-resizable-nw"});if(this.handles.constructor==String){if(this.handles=="all")this.handles="n,e,s,w,se,sw,ne,nw";var d=this.handles.split(",");this.handles={};for(var c=0;c<d.length;c++){var h=a.trim(d[c]),k=a('<div class="ui-resizable-handle '+("ui-resizable-"+h)+'"></div>');/sw|se|ne|nw/.test(h)&&k.css({zIndex:++g.zIndex});"se"==h&&k.addClass("ui-icon ui-icon-gripsmall-diagonal-se");this.handles[h]=".ui-resizable-"+h;this.element.append(k)}}this._renderAxis=function(l){l=l||this.element;for(var o in this.handles){if(this.handles[o].constructor==
String)this.handles[o]=a(this.handles[o],this.element).show();if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){var n=a(this.handles[o],this.element),m=0;m=/sw|ne|nw|se|n|s/.test(o)?n.outerHeight():n.outerWidth();n=["padding",/ne|nw|n/.test(o)?"Top":/se|sw|s/.test(o)?"Bottom":/^e$/.test(o)?"Right":"Left"].join("");l.css(n,m);this._proportionallyResize()}a(this.handles[o])}};this._renderAxis(this.element);this._handles=a(".ui-resizable-handle",this.element).disableSelection();
this._handles.mouseover(function(){if(!b.resizing){if(this.className)var l=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i);b.axis=l&&l[1]?l[1]:"se"}});if(g.autoHide){this._handles.hide();a(this.element).addClass("ui-resizable-autohide").hover(function(){a(this).removeClass("ui-resizable-autohide");b._handles.show()},function(){if(!b.resizing){a(this).addClass("ui-resizable-autohide");b._handles.hide()}})}this._mouseInit()},destroy:function(){this._mouseDestroy();var b=function(d){a(d).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};
if(this.elementIsWrapper){b(this.element);var g=this.element;g.after(this.originalElement.css({position:g.css("position"),width:g.outerWidth(),height:g.outerHeight(),top:g.css("top"),left:g.css("left")})).remove()}this.originalElement.css("resize",this.originalResizeStyle);b(this.originalElement);return this},_mouseCapture:function(b){var g=false,d;for(d in this.handles)if(a(this.handles[d])[0]==b.target)g=true;return!this.options.disabled&&g},_mouseStart:function(b){var g=this.options,d=this.element.position(),
c=this.element;this.resizing=true;this.documentScroll={top:a(document).scrollTop(),left:a(document).scrollLeft()};if(c.is(".ui-draggable")||/absolute/.test(c.css("position")))c.css({position:"absolute",top:d.top,left:d.left});a.browser.opera&&/relative/.test(c.css("position"))&&c.css({position:"relative",top:"auto",left:"auto"});this._renderProxy();d=f(this.helper.css("left"));var h=f(this.helper.css("top"));if(g.containment){d+=a(g.containment).scrollLeft()||0;h+=a(g.containment).scrollTop()||0}this.offset=
this.helper.offset();this.position={left:d,top:h};this.size=this._helper?{width:c.outerWidth(),height:c.outerHeight()}:{width:c.width(),height:c.height()};this.originalSize=this._helper?{width:c.outerWidth(),height:c.outerHeight()}:{width:c.width(),height:c.height()};this.originalPosition={left:d,top:h};this.sizeDiff={width:c.outerWidth()-c.width(),height:c.outerHeight()-c.height()};this.originalMousePosition={left:b.pageX,top:b.pageY};this.aspectRatio=typeof g.aspectRatio=="number"?g.aspectRatio:
this.originalSize.width/this.originalSize.height||1;g=a(".ui-resizable-"+this.axis).css("cursor");a("body").css("cursor",g=="auto"?this.axis+"-resize":g);c.addClass("ui-resizable-resizing");this._propagate("start",b);return true},_mouseDrag:function(b){var g=this.helper,d=this.originalMousePosition,c=this._change[this.axis];if(!c)return false;d=c.apply(this,[b,b.pageX-d.left||0,b.pageY-d.top||0]);if(this._aspectRatio||b.shiftKey)d=this._updateRatio(d,b);d=this._respectSize(d,b);this._propagate("resize",
b);g.css({top:this.position.top+"px",left:this.position.left+"px",width:this.size.width+"px",height:this.size.height+"px"});!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize();this._updateCache(d);this._trigger("resize",b,this.ui());return false},_mouseStop:function(b){this.resizing=false;var g=this.options;if(this._helper){var d=this._proportionallyResizeElements,c=d.length&&/textarea/i.test(d[0].nodeName);d=c&&a.ui.hasScroll(d[0],"left")?0:this.sizeDiff.height;
c={width:this.size.width-(c?0:this.sizeDiff.width),height:this.size.height-d};d=parseInt(this.element.css("left"),10)+(this.position.left-this.originalPosition.left)||null;var h=parseInt(this.element.css("top"),10)+(this.position.top-this.originalPosition.top)||null;g.animate||this.element.css(a.extend(c,{top:h,left:d}));this.helper.height(this.size.height);this.helper.width(this.size.width);this._helper&&!g.animate&&this._proportionallyResize()}a("body").css("cursor","auto");this.element.removeClass("ui-resizable-resizing");
this._propagate("stop",b);this._helper&&this.helper.remove();return false},_updateCache:function(b){this.offset=this.helper.offset();if(e(b.left))this.position.left=b.left;if(e(b.top))this.position.top=b.top;if(e(b.height))this.size.height=b.height;if(e(b.width))this.size.width=b.width},_updateRatio:function(b){var g=this.position,d=this.size,c=this.axis;if(b.height)b.width=d.height*this.aspectRatio;else if(b.width)b.height=d.width/this.aspectRatio;if(c=="sw"){b.left=g.left+(d.width-b.width);b.top=
null}if(c=="nw"){b.top=g.top+(d.height-b.height);b.left=g.left+(d.width-b.width)}return b},_respectSize:function(b){var g=this.options,d=this.axis,c=e(b.width)&&g.maxWidth&&g.maxWidth<b.width,h=e(b.height)&&g.maxHeight&&g.maxHeight<b.height,k=e(b.width)&&g.minWidth&&g.minWidth>b.width,l=e(b.height)&&g.minHeight&&g.minHeight>b.height;if(k)b.width=g.minWidth;if(l)b.height=g.minHeight;if(c)b.width=g.maxWidth;if(h)b.height=g.maxHeight;var o=this.originalPosition.left+this.originalSize.width,n=this.position.top+
this.size.height,m=/sw|nw|w/.test(d);d=/nw|ne|n/.test(d);if(k&&m)b.left=o-g.minWidth;if(c&&m)b.left=o-g.maxWidth;if(l&&d)b.top=n-g.minHeight;if(h&&d)b.top=n-g.maxHeight;if((g=!b.width&&!b.height)&&!b.left&&b.top)b.top=null;else if(g&&!b.top&&b.left)b.left=null;return b},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var b=this.helper||this.element,g=0;g<this._proportionallyResizeElements.length;g++){var d=this._proportionallyResizeElements[g];if(!this.borderDif){var c=
[d.css("borderTopWidth"),d.css("borderRightWidth"),d.css("borderBottomWidth"),d.css("borderLeftWidth")],h=[d.css("paddingTop"),d.css("paddingRight"),d.css("paddingBottom"),d.css("paddingLeft")];this.borderDif=a.map(c,function(k,l){k=parseInt(k,10)||0;l=parseInt(h[l],10)||0;return k+l})}a.browser.msie&&(a(b).is(":hidden")||a(b).parents(":hidden").length)||d.css({height:b.height()-this.borderDif[0]-this.borderDif[2]||0,width:b.width()-this.borderDif[1]-this.borderDif[3]||0})}},_renderProxy:function(){var b=
this.options;this.elementOffset=this.element.offset();if(this._helper){this.helper=this.helper||a('<div style="overflow:hidden;"></div>');var g=a.browser.msie&&a.browser.version<7,d=g?1:0;g=g?2:-1;this.helper.addClass(this._helper).css({width:this.element.outerWidth()+g,height:this.element.outerHeight()+g,position:"absolute",left:this.elementOffset.left-d+"px",top:this.elementOffset.top-d+"px",zIndex:++b.zIndex});this.helper.appendTo("body").disableSelection()}else this.helper=this.element},_change:{e:function(b,
g){return{width:this.originalSize.width+g}},w:function(b,g){return{left:this.originalPosition.left+g,width:this.originalSize.width-g}},n:function(b,g,d){return{top:this.originalPosition.top+d,height:this.originalSize.height-d}},s:function(b,g,d){return{height:this.originalSize.height+d}},se:function(b,g,d){return a.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[b,g,d]))},sw:function(b,g,d){return a.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[b,g,
d]))},ne:function(b,g,d){return a.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[b,g,d]))},nw:function(b,g,d){return a.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[b,g,d]))}},_propagate:function(b,g){a.ui.plugin.call(this,b,[g,this.ui()]);b!="resize"&&this._trigger(b,g,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,
originalPosition:this.originalPosition}}});a.extend(a.ui.resizable,{version:"1.8.3"});a.ui.plugin.add("resizable","alsoResize",{start:function(){var b=a(this).data("resizable").options,g=function(d){a(d).each(function(){var c=a(this);c.data("resizable-alsoresize",{width:parseInt(c.width(),10),height:parseInt(c.height(),10),left:parseInt(c.css("left"),10),top:parseInt(c.css("top"),10),position:c.css("position")})})};if(typeof b.alsoResize=="object"&&!b.alsoResize.parentNode)if(b.alsoResize.length){b.alsoResize=
b.alsoResize[0];g(b.alsoResize)}else a.each(b.alsoResize,function(d){g(d)});else g(b.alsoResize)},resize:function(b,g){var d=a(this).data("resizable");b=d.options;var c=d.originalSize,h=d.originalPosition,k={height:d.size.height-c.height||0,width:d.size.width-c.width||0,top:d.position.top-h.top||0,left:d.position.left-h.left||0},l=function(o,n){a(o).each(function(){var m=a(this),C=a(this).data("resizable-alsoresize"),I={},H=n&&n.length?n:m.parents(g.originalElement[0]).length?["width","height"]:["width",
"height","top","left"];a.each(H,function(G,P){if((G=(C[P]||0)+(k[P]||0))&&G>=0)I[P]=G||null});if(a.browser.opera&&/relative/.test(m.css("position"))){d._revertToRelativePosition=true;m.css({position:"absolute",top:"auto",left:"auto"})}m.css(I)})};typeof b.alsoResize=="object"&&!b.alsoResize.nodeType?a.each(b.alsoResize,function(o,n){l(o,n)}):l(b.alsoResize)},stop:function(){var b=a(this).data("resizable"),g=b.options,d=function(c){a(c).each(function(){var h=a(this);h.css({position:h.data("resizable-alsoresize").position})})};
if(b._revertToRelativePosition){b._revertToRelativePosition=false;typeof g.alsoResize=="object"&&!g.alsoResize.nodeType?a.each(g.alsoResize,function(c){d(c)}):d(g.alsoResize)}a(this).removeData("resizable-alsoresize")}});a.ui.plugin.add("resizable","animate",{stop:function(b){var g=a(this).data("resizable"),d=g.options,c=g._proportionallyResizeElements,h=c.length&&/textarea/i.test(c[0].nodeName),k=h&&a.ui.hasScroll(c[0],"left")?0:g.sizeDiff.height;h={width:g.size.width-(h?0:g.sizeDiff.width),height:g.size.height-
k};k=parseInt(g.element.css("left"),10)+(g.position.left-g.originalPosition.left)||null;var l=parseInt(g.element.css("top"),10)+(g.position.top-g.originalPosition.top)||null;g.element.animate(a.extend(h,l&&k?{top:l,left:k}:{}),{duration:d.animateDuration,easing:d.animateEasing,step:function(){var o={width:parseInt(g.element.css("width"),10),height:parseInt(g.element.css("height"),10),top:parseInt(g.element.css("top"),10),left:parseInt(g.element.css("left"),10)};c&&c.length&&a(c[0]).css({width:o.width,
height:o.height});g._updateCache(o);g._propagate("resize",b)}})}});a.ui.plugin.add("resizable","containment",{start:function(){var b=a(this).data("resizable"),g=b.element,d=b.options.containment;if(g=d instanceof a?d.get(0):/parent/.test(d)?g.parent().get(0):d){b.containerElement=a(g);if(/document/.test(d)||d==document){b.containerOffset={left:0,top:0};b.containerPosition={left:0,top:0};b.parentData={element:a(document),left:0,top:0,width:a(document).width(),height:a(document).height()||document.body.parentNode.scrollHeight}}else{var c=
a(g),h=[];a(["Top","Right","Left","Bottom"]).each(function(o,n){h[o]=f(c.css("padding"+n))});b.containerOffset=c.offset();b.containerPosition=c.position();b.containerSize={height:c.innerHeight()-h[3],width:c.innerWidth()-h[1]};d=b.containerOffset;var k=b.containerSize.height,l=b.containerSize.width;l=a.ui.hasScroll(g,"left")?g.scrollWidth:l;k=a.ui.hasScroll(g)?g.scrollHeight:k;b.parentData={element:g,left:d.left,top:d.top,width:l,height:k}}}},resize:function(b){var g=a(this).data("resizable"),d=g.options,
c=g.containerOffset,h=g.position;b=g._aspectRatio||b.shiftKey;var k={top:0,left:0},l=g.containerElement;if(l[0]!=document&&/static/.test(l.css("position")))k=c;if(h.left<(g._helper?c.left:0)){g.size.width+=g._helper?g.position.left-c.left:g.position.left-k.left;if(b)g.size.height=g.size.width/d.aspectRatio;g.position.left=d.helper?c.left:0}if(h.top<(g._helper?c.top:0)){g.size.height+=g._helper?g.position.top-c.top:g.position.top;if(b)g.size.width=g.size.height*d.aspectRatio;g.position.top=g._helper?
c.top:0}g.offset.left=g.parentData.left+g.position.left;g.offset.top=g.parentData.top+g.position.top;d=Math.abs((g._helper?g.offset.left-k.left:g.offset.left-k.left)+g.sizeDiff.width);c=Math.abs((g._helper?g.offset.top-k.top:g.offset.top-c.top)+g.sizeDiff.height);h=g.containerElement.get(0)==g.element.parent().get(0);k=/relative|absolute/.test(g.containerElement.css("position"));if(h&&k)d-=g.parentData.left;if(d+g.size.width>=g.parentData.width){g.size.width=g.parentData.width-d;if(b)g.size.height=
g.size.width/g.aspectRatio}if(c+g.size.height>=g.parentData.height){g.size.height=g.parentData.height-c;if(b)g.size.width=g.size.height*g.aspectRatio}},stop:function(){var b=a(this).data("resizable"),g=b.options,d=b.containerOffset,c=b.containerPosition,h=b.containerElement,k=a(b.helper),l=k.offset(),o=k.outerWidth()-b.sizeDiff.width;k=k.outerHeight()-b.sizeDiff.height;b._helper&&!g.animate&&/relative/.test(h.css("position"))&&a(this).css({left:l.left-c.left-d.left,width:o,height:k});b._helper&&!g.animate&&
/static/.test(h.css("position"))&&a(this).css({left:l.left-c.left-d.left,width:o,height:k})}});a.ui.plugin.add("resizable","ghost",{start:function(){var b=a(this).data("resizable"),g=b.options,d=b.size;b.ghost=b.originalElement.clone();b.ghost.css({opacity:0.25,display:"block",position:"relative",height:d.height,width:d.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass(typeof g.ghost=="string"?g.ghost:"");b.ghost.appendTo(b.helper)},resize:function(){var b=a(this).data("resizable");
b.ghost&&b.ghost.css({position:"relative",height:b.size.height,width:b.size.width})},stop:function(){var b=a(this).data("resizable");b.ghost&&b.helper&&b.helper.get(0).removeChild(b.ghost.get(0))}});a.ui.plugin.add("resizable","grid",{resize:function(){var b=a(this).data("resizable"),g=b.options,d=b.size,c=b.originalSize,h=b.originalPosition,k=b.axis;g.grid=typeof g.grid=="number"?[g.grid,g.grid]:g.grid;var l=Math.round((d.width-c.width)/(g.grid[0]||1))*(g.grid[0]||1);g=Math.round((d.height-c.height)/
(g.grid[1]||1))*(g.grid[1]||1);if(/^(se|s|e)$/.test(k)){b.size.width=c.width+l;b.size.height=c.height+g}else if(/^(ne)$/.test(k)){b.size.width=c.width+l;b.size.height=c.height+g;b.position.top=h.top-g}else{if(/^(sw)$/.test(k)){b.size.width=c.width+l;b.size.height=c.height+g}else{b.size.width=c.width+l;b.size.height=c.height+g;b.position.top=h.top-g}b.position.left=h.left-l}}});var f=function(b){return parseInt(b,10)||0},e=function(b){return!isNaN(parseInt(b,10))}})(jQuery);
(function(a){a.widget("ui.selectable",a.ui.mouse,{options:{appendTo:"body",autoRefresh:true,distance:0,filter:"*",tolerance:"touch"},_create:function(){var f=this;this.element.addClass("ui-selectable");this.dragged=false;var e;this.refresh=function(){e=a(f.options.filter,f.element[0]);e.each(function(){var b=a(this),g=b.offset();a.data(this,"selectable-item",{element:this,$element:b,left:g.left,top:g.top,right:g.left+b.outerWidth(),bottom:g.top+b.outerHeight(),startselected:false,selected:b.hasClass("ui-selected"),
selecting:b.hasClass("ui-selecting"),unselecting:b.hasClass("ui-unselecting")})})};this.refresh();this.selectees=e.addClass("ui-selectee");this._mouseInit();this.helper=a("<div class='ui-selectable-helper'></div>")},destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item");this.element.removeClass("ui-selectable ui-selectable-disabled").removeData("selectable").unbind(".selectable");this._mouseDestroy();return this},_mouseStart:function(f){var e=this;this.opos=[f.pageX,
f.pageY];if(!this.options.disabled){var b=this.options;this.selectees=a(b.filter,this.element[0]);this._trigger("start",f);a(b.appendTo).append(this.helper);this.helper.css({left:f.clientX,top:f.clientY,width:0,height:0});b.autoRefresh&&this.refresh();this.selectees.filter(".ui-selected").each(function(){var g=a.data(this,"selectable-item");g.startselected=true;if(!f.metaKey){g.$element.removeClass("ui-selected");g.selected=false;g.$element.addClass("ui-unselecting");g.unselecting=true;e._trigger("unselecting",
f,{unselecting:g.element})}});a(f.target).parents().andSelf().each(function(){var g=a.data(this,"selectable-item");if(g){var d=!f.metaKey||!g.$element.hasClass("ui-selected");g.$element.removeClass(d?"ui-unselecting":"ui-selected").addClass(d?"ui-selecting":"ui-unselecting");g.unselecting=!d;g.selecting=d;(g.selected=d)?e._trigger("selecting",f,{selecting:g.element}):e._trigger("unselecting",f,{unselecting:g.element});return false}})}},_mouseDrag:function(f){var e=this;this.dragged=true;if(!this.options.disabled){var b=
this.options,g=this.opos[0],d=this.opos[1],c=f.pageX,h=f.pageY;if(g>c){var k=c;c=g;g=k}if(d>h){k=h;h=d;d=k}this.helper.css({left:g,top:d,width:c-g,height:h-d});this.selectees.each(function(){var l=a.data(this,"selectable-item");if(!(!l||l.element==e.element[0])){var o=false;if(b.tolerance=="touch")o=!(l.left>c||l.right<g||l.top>h||l.bottom<d);else if(b.tolerance=="fit")o=l.left>g&&l.right<c&&l.top>d&&l.bottom<h;if(o){if(l.selected){l.$element.removeClass("ui-selected");l.selected=false}if(l.unselecting){l.$element.removeClass("ui-unselecting");
l.unselecting=false}if(!l.selecting){l.$element.addClass("ui-selecting");l.selecting=true;e._trigger("selecting",f,{selecting:l.element})}}else{if(l.selecting)if(f.metaKey&&l.startselected){l.$element.removeClass("ui-selecting");l.selecting=false;l.$element.addClass("ui-selected");l.selected=true}else{l.$element.removeClass("ui-selecting");l.selecting=false;if(l.startselected){l.$element.addClass("ui-unselecting");l.unselecting=true}e._trigger("unselecting",f,{unselecting:l.element})}if(l.selected)if(!f.metaKey&&
!l.startselected){l.$element.removeClass("ui-selected");l.selected=false;l.$element.addClass("ui-unselecting");l.unselecting=true;e._trigger("unselecting",f,{unselecting:l.element})}}}});return false}},_mouseStop:function(f){var e=this;this.dragged=false;a(".ui-unselecting",this.element[0]).each(function(){var b=a.data(this,"selectable-item");b.$element.removeClass("ui-unselecting");b.unselecting=false;b.startselected=false;e._trigger("unselected",f,{unselected:b.element})});a(".ui-selecting",this.element[0]).each(function(){var b=
a.data(this,"selectable-item");b.$element.removeClass("ui-selecting").addClass("ui-selected");b.selecting=false;b.selected=true;b.startselected=true;e._trigger("selected",f,{selected:b.element})});this._trigger("stop",f);this.helper.remove();return false}});a.extend(a.ui.selectable,{version:"1.8.3"})})(jQuery);
(function(a){a.widget("ui.sortable",a.ui.mouse,{widgetEventPrefix:"sort",options:{appendTo:"parent",axis:false,connectWith:false,containment:false,cursor:"auto",cursorAt:false,dropOnEmpty:true,forcePlaceholderSize:false,forceHelperSize:false,grid:false,handle:false,helper:"original",items:"> *",opacity:false,placeholder:false,revert:false,scroll:true,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1E3},_create:function(){this.containerCache={};this.element.addClass("ui-sortable");
this.refresh();this.floating=this.items.length?/left|right/.test(this.items[0].item.css("float")):false;this.offset=this.element.offset();this._mouseInit()},destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").removeData("sortable").unbind(".sortable");this._mouseDestroy();for(var f=this.items.length-1;f>=0;f--)this.items[f].item.removeData("sortable-item");return this},_setOption:function(f,e){if(f==="disabled"){this.options[f]=e;this.widget()[e?"addClass":"removeClass"]("ui-sortable-disabled")}else a.Widget.prototype._setOption.apply(this,
arguments)},_mouseCapture:function(f,e){if(this.reverting)return false;if(this.options.disabled||this.options.type=="static")return false;this._refreshItems(f);var b=null,g=this;a(f.target).parents().each(function(){if(a.data(this,"sortable-item")==g){b=a(this);return false}});if(a.data(f.target,"sortable-item")==g)b=a(f.target);if(!b)return false;if(this.options.handle&&!e){var d=false;a(this.options.handle,b).find("*").andSelf().each(function(){if(this==f.target)d=true});if(!d)return false}this.currentItem=
b;this._removeCurrentsFromItems();return true},_mouseStart:function(f,e,b){e=this.options;this.currentContainer=this;this.refreshPositions();this.helper=this._createHelper(f);this._cacheHelperProportions();this._cacheMargins();this.scrollParent=this.helper.scrollParent();this.offset=this.currentItem.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};this.helper.css("position","absolute");this.cssPosition=this.helper.css("position");a.extend(this.offset,
{click:{left:f.pageX-this.offset.left,top:f.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this._generatePosition(f);this.originalPageX=f.pageX;this.originalPageY=f.pageY;e.cursorAt&&this._adjustOffsetFromHelper(e.cursorAt);this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]};this.helper[0]!=this.currentItem[0]&&this.currentItem.hide();this._createPlaceholder();e.containment&&this._setContainment();
if(e.cursor){if(a("body").css("cursor"))this._storedCursor=a("body").css("cursor");a("body").css("cursor",e.cursor)}if(e.opacity){if(this.helper.css("opacity"))this._storedOpacity=this.helper.css("opacity");this.helper.css("opacity",e.opacity)}if(e.zIndex){if(this.helper.css("zIndex"))this._storedZIndex=this.helper.css("zIndex");this.helper.css("zIndex",e.zIndex)}if(this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML")this.overflowOffset=this.scrollParent.offset();this._trigger("start",
f,this._uiHash());this._preserveHelperProportions||this._cacheHelperProportions();if(!b)for(b=this.containers.length-1;b>=0;b--)this.containers[b]._trigger("activate",f,this._uiHash(this));if(a.ui.ddmanager)a.ui.ddmanager.current=this;a.ui.ddmanager&&!e.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,f);this.dragging=true;this.helper.addClass("ui-sortable-helper");this._mouseDrag(f);return true},_mouseDrag:function(f){this.position=this._generatePosition(f);this.positionAbs=this._convertPositionTo("absolute");
if(!this.lastPositionAbs)this.lastPositionAbs=this.positionAbs;if(this.options.scroll){var e=this.options,b=false;if(this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"){if(this.overflowOffset.top+this.scrollParent[0].offsetHeight-f.pageY<e.scrollSensitivity)this.scrollParent[0].scrollTop=b=this.scrollParent[0].scrollTop+e.scrollSpeed;else if(f.pageY-this.overflowOffset.top<e.scrollSensitivity)this.scrollParent[0].scrollTop=b=this.scrollParent[0].scrollTop-e.scrollSpeed;if(this.overflowOffset.left+
this.scrollParent[0].offsetWidth-f.pageX<e.scrollSensitivity)this.scrollParent[0].scrollLeft=b=this.scrollParent[0].scrollLeft+e.scrollSpeed;else if(f.pageX-this.overflowOffset.left<e.scrollSensitivity)this.scrollParent[0].scrollLeft=b=this.scrollParent[0].scrollLeft-e.scrollSpeed}else{if(f.pageY-a(document).scrollTop()<e.scrollSensitivity)b=a(document).scrollTop(a(document).scrollTop()-e.scrollSpeed);else if(a(window).height()-(f.pageY-a(document).scrollTop())<e.scrollSensitivity)b=a(document).scrollTop(a(document).scrollTop()+
e.scrollSpeed);if(f.pageX-a(document).scrollLeft()<e.scrollSensitivity)b=a(document).scrollLeft(a(document).scrollLeft()-e.scrollSpeed);else if(a(window).width()-(f.pageX-a(document).scrollLeft())<e.scrollSensitivity)b=a(document).scrollLeft(a(document).scrollLeft()+e.scrollSpeed)}b!==false&&a.ui.ddmanager&&!e.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,f)}this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||this.options.axis!="y")this.helper[0].style.left=this.position.left+
"px";if(!this.options.axis||this.options.axis!="x")this.helper[0].style.top=this.position.top+"px";for(e=this.items.length-1;e>=0;e--){b=this.items[e];var g=b.item[0],d=this._intersectsWithPointer(b);if(d)if(g!=this.currentItem[0]&&this.placeholder[d==1?"next":"prev"]()[0]!=g&&!a.ui.contains(this.placeholder[0],g)&&(this.options.type=="semi-dynamic"?!a.ui.contains(this.element[0],g):true)){this.direction=d==1?"down":"up";if(this.options.tolerance=="pointer"||this._intersectsWithSides(b))this._rearrange(f,
b);else break;this._trigger("change",f,this._uiHash());break}}this._contactContainers(f);a.ui.ddmanager&&a.ui.ddmanager.drag(this,f);this._trigger("sort",f,this._uiHash());this.lastPositionAbs=this.positionAbs;return false},_mouseStop:function(f,e){if(f){a.ui.ddmanager&&!this.options.dropBehaviour&&a.ui.ddmanager.drop(this,f);if(this.options.revert){var b=this;e=b.placeholder.offset();b.reverting=true;a(this.helper).animate({left:e.left-this.offset.parent.left-b.margins.left+(this.offsetParent[0]==
document.body?0:this.offsetParent[0].scrollLeft),top:e.top-this.offset.parent.top-b.margins.top+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){b._clear(f)})}else this._clear(f,e);return false}},cancel:function(){if(this.dragging){this._mouseUp();this.options.helper=="original"?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var f=this.containers.length-1;f>=0;f--){this.containers[f]._trigger("deactivate",
null,this._uiHash(this));if(this.containers[f].containerCache.over){this.containers[f]._trigger("out",null,this._uiHash(this));this.containers[f].containerCache.over=0}}}this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]);this.options.helper!="original"&&this.helper&&this.helper[0].parentNode&&this.helper.remove();a.extend(this,{helper:null,dragging:false,reverting:false,_noFinalSort:null});this.domPosition.prev?a(this.domPosition.prev).after(this.currentItem):
a(this.domPosition.parent).prepend(this.currentItem);return this},serialize:function(f){var e=this._getItemsAsjQuery(f&&f.connected),b=[];f=f||{};a(e).each(function(){var g=(a(f.item||this).attr(f.attribute||"id")||"").match(f.expression||/(.+)[-=_](.+)/);if(g)b.push((f.key||g[1]+"[]")+"="+(f.key&&f.expression?g[1]:g[2]))});!b.length&&f.key&&b.push(f.key+"=");return b.join("&")},toArray:function(f){var e=this._getItemsAsjQuery(f&&f.connected),b=[];f=f||{};e.each(function(){b.push(a(f.item||this).attr(f.attribute||
"id")||"")});return b},_intersectsWith:function(f){var e=this.positionAbs.left,b=e+this.helperProportions.width,g=this.positionAbs.top,d=g+this.helperProportions.height,c=f.left,h=c+f.width,k=f.top,l=k+f.height,o=this.offset.click.top,n=this.offset.click.left;o=g+o>k&&g+o<l&&e+n>c&&e+n<h;return this.options.tolerance=="pointer"||this.options.forcePointerForContainers||this.options.tolerance!="pointer"&&this.helperProportions[this.floating?"width":"height"]>f[this.floating?"width":"height"]?o:c<e+
this.helperProportions.width/2&&b-this.helperProportions.width/2<h&&k<g+this.helperProportions.height/2&&d-this.helperProportions.height/2<l},_intersectsWithPointer:function(f){var e=a.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,f.top,f.height);f=a.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,f.left,f.width);e=e&&f;f=this._getDragVerticalDirection();var b=this._getDragHorizontalDirection();if(!e)return false;return this.floating?b&&b=="right"||f=="down"?2:1:f&&(f=="down"?
2:1)},_intersectsWithSides:function(f){var e=a.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,f.top+f.height/2,f.height);f=a.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,f.left+f.width/2,f.width);var b=this._getDragVerticalDirection(),g=this._getDragHorizontalDirection();return this.floating&&g?g=="right"&&f||g=="left"&&!f:b&&(b=="down"&&e||b=="up"&&!e)},_getDragVerticalDirection:function(){var f=this.positionAbs.top-this.lastPositionAbs.top;return f!=0&&(f>0?"down":"up")},
_getDragHorizontalDirection:function(){var f=this.positionAbs.left-this.lastPositionAbs.left;return f!=0&&(f>0?"right":"left")},refresh:function(f){this._refreshItems(f);this.refreshPositions();return this},_connectWith:function(){var f=this.options;return f.connectWith.constructor==String?[f.connectWith]:f.connectWith},_getItemsAsjQuery:function(f){var e=[],b=[],g=this._connectWith();if(g&&f)for(f=g.length-1;f>=0;f--)for(var d=a(g[f]),c=d.length-1;c>=0;c--){var h=a.data(d[c],"sortable");if(h&&h!=
this&&!h.options.disabled)b.push([a.isFunction(h.options.items)?h.options.items.call(h.element):a(h.options.items,h.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),h])}b.push([a.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):a(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(f=b.length-1;f>=0;f--)b[f][0].each(function(){e.push(this)});return a(e)},_removeCurrentsFromItems:function(){for(var f=
this.currentItem.find(":data(sortable-item)"),e=0;e<this.items.length;e++)for(var b=0;b<f.length;b++)f[b]==this.items[e].item[0]&&this.items.splice(e,1)},_refreshItems:function(f){this.items=[];this.containers=[this];var e=this.items,b=[[a.isFunction(this.options.items)?this.options.items.call(this.element[0],f,{item:this.currentItem}):a(this.options.items,this.element),this]],g=this._connectWith();if(g)for(var d=g.length-1;d>=0;d--)for(var c=a(g[d]),h=c.length-1;h>=0;h--){var k=a.data(c[h],"sortable");
if(k&&k!=this&&!k.options.disabled){b.push([a.isFunction(k.options.items)?k.options.items.call(k.element[0],f,{item:this.currentItem}):a(k.options.items,k.element),k]);this.containers.push(k)}}for(d=b.length-1;d>=0;d--){f=b[d][1];g=b[d][0];h=0;for(c=g.length;h<c;h++){k=a(g[h]);k.data("sortable-item",f);e.push({item:k,instance:f,width:0,height:0,left:0,top:0})}}},refreshPositions:function(f){if(this.offsetParent&&this.helper)this.offset.parent=this._getParentOffset();for(var e=this.items.length-1;e>=
0;e--){var b=this.items[e],g=this.options.toleranceElement?a(this.options.toleranceElement,b.item):b.item;if(!f){b.width=g.outerWidth();b.height=g.outerHeight()}g=g.offset();b.left=g.left;b.top=g.top}if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(e=this.containers.length-1;e>=0;e--){g=this.containers[e].element.offset();this.containers[e].containerCache.left=g.left;this.containers[e].containerCache.top=g.top;this.containers[e].containerCache.width=
this.containers[e].element.outerWidth();this.containers[e].containerCache.height=this.containers[e].element.outerHeight()}return this},_createPlaceholder:function(f){var e=f||this,b=e.options;if(!b.placeholder||b.placeholder.constructor==String){var g=b.placeholder;b.placeholder={element:function(){var d=a(document.createElement(e.currentItem[0].nodeName)).addClass(g||e.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];if(!g)d.style.visibility="hidden";return d},
update:function(d,c){if(!(g&&!b.forcePlaceholderSize)){c.height()||c.height(e.currentItem.innerHeight()-parseInt(e.currentItem.css("paddingTop")||0,10)-parseInt(e.currentItem.css("paddingBottom")||0,10));c.width()||c.width(e.currentItem.innerWidth()-parseInt(e.currentItem.css("paddingLeft")||0,10)-parseInt(e.currentItem.css("paddingRight")||0,10))}}}}e.placeholder=a(b.placeholder.element.call(e.element,e.currentItem));e.currentItem.after(e.placeholder);b.placeholder.update(e,e.placeholder)},_contactContainers:function(f){for(var e=
null,b=null,g=this.containers.length-1;g>=0;g--)if(!a.ui.contains(this.currentItem[0],this.containers[g].element[0]))if(this._intersectsWith(this.containers[g].containerCache)){if(!(e&&a.ui.contains(this.containers[g].element[0],e.element[0]))){e=this.containers[g];b=g}}else if(this.containers[g].containerCache.over){this.containers[g]._trigger("out",f,this._uiHash(this));this.containers[g].containerCache.over=0}if(e)if(this.containers.length===1){this.containers[b]._trigger("over",f,this._uiHash(this));
this.containers[b].containerCache.over=1}else if(this.currentContainer!=this.containers[b]){e=1E4;g=null;for(var d=this.positionAbs[this.containers[b].floating?"left":"top"],c=this.items.length-1;c>=0;c--)if(a.ui.contains(this.containers[b].element[0],this.items[c].item[0])){var h=this.items[c][this.containers[b].floating?"left":"top"];if(Math.abs(h-d)<e){e=Math.abs(h-d);g=this.items[c]}}if(g||this.options.dropOnEmpty){this.currentContainer=this.containers[b];g?this._rearrange(f,g,null,true):this._rearrange(f,
null,this.containers[b].element,true);this._trigger("change",f,this._uiHash());this.containers[b]._trigger("change",f,this._uiHash(this));this.options.placeholder.update(this.currentContainer,this.placeholder);this.containers[b]._trigger("over",f,this._uiHash(this));this.containers[b].containerCache.over=1}}},_createHelper:function(f){var e=this.options;f=a.isFunction(e.helper)?a(e.helper.apply(this.element[0],[f,this.currentItem])):e.helper=="clone"?this.currentItem.clone():this.currentItem;f.parents("body").length||
a(e.appendTo!="parent"?e.appendTo:this.currentItem[0].parentNode)[0].appendChild(f[0]);if(f[0]==this.currentItem[0])this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")};if(f[0].style.width==""||e.forceHelperSize)f.width(this.currentItem.width());if(f[0].style.height==""||e.forceHelperSize)f.height(this.currentItem.height());return f},_adjustOffsetFromHelper:function(f){if(typeof f==
"string")f=f.split(" ");if(a.isArray(f))f={left:+f[0],top:+f[1]||0};if("left"in f)this.offset.click.left=f.left+this.margins.left;if("right"in f)this.offset.click.left=this.helperProportions.width-f.right+this.margins.left;if("top"in f)this.offset.click.top=f.top+this.margins.top;if("bottom"in f)this.offset.click.top=this.helperProportions.height-f.bottom+this.margins.top},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var f=this.offsetParent.offset();if(this.cssPosition==
"absolute"&&this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0])){f.left+=this.scrollParent.scrollLeft();f.top+=this.scrollParent.scrollTop()}if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&a.browser.msie)f={top:0,left:0};return{top:f.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:f.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition==
"relative"){var f=this.currentItem.position();return{top:f.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:f.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}else return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},
_setContainment:function(){var f=this.options;if(f.containment=="parent")f.containment=this.helper[0].parentNode;if(f.containment=="document"||f.containment=="window")this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,a(f.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(a(f.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-
this.margins.top];if(!/^(document|window|parent)$/.test(f.containment)){var e=a(f.containment)[0];f=a(f.containment).offset();var b=a(e).css("overflow")!="hidden";this.containment=[f.left+(parseInt(a(e).css("borderLeftWidth"),10)||0)+(parseInt(a(e).css("paddingLeft"),10)||0)-this.margins.left,f.top+(parseInt(a(e).css("borderTopWidth"),10)||0)+(parseInt(a(e).css("paddingTop"),10)||0)-this.margins.top,f.left+(b?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(parseInt(a(e).css("borderLeftWidth"),
10)||0)-(parseInt(a(e).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,f.top+(b?Math.max(e.scrollHeight,e.offsetHeight):e.offsetHeight)-(parseInt(a(e).css("borderTopWidth"),10)||0)-(parseInt(a(e).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(f,e){if(!e)e=this.position;f=f=="absolute"?1:-1;var b=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?
this.offsetParent:this.scrollParent,g=/(html|body)/i.test(b[0].tagName);return{top:e.top+this.offset.relative.top*f+this.offset.parent.top*f-(a.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():g?0:b.scrollTop())*f),left:e.left+this.offset.relative.left*f+this.offset.parent.left*f-(a.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():g?0:b.scrollLeft())*f)}},_generatePosition:function(f){var e=
this.options,b=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,g=/(html|body)/i.test(b[0].tagName);if(this.cssPosition=="relative"&&!(this.scrollParent[0]!=document&&this.scrollParent[0]!=this.offsetParent[0]))this.offset.relative=this._getRelativeOffset();var d=f.pageX,c=f.pageY;if(this.originalPosition){if(this.containment){if(f.pageX-this.offset.click.left<this.containment[0])d=this.containment[0]+
this.offset.click.left;if(f.pageY-this.offset.click.top<this.containment[1])c=this.containment[1]+this.offset.click.top;if(f.pageX-this.offset.click.left>this.containment[2])d=this.containment[2]+this.offset.click.left;if(f.pageY-this.offset.click.top>this.containment[3])c=this.containment[3]+this.offset.click.top}if(e.grid){c=this.originalPageY+Math.round((c-this.originalPageY)/e.grid[1])*e.grid[1];c=this.containment?!(c-this.offset.click.top<this.containment[1]||c-this.offset.click.top>this.containment[3])?
c:!(c-this.offset.click.top<this.containment[1])?c-e.grid[1]:c+e.grid[1]:c;d=this.originalPageX+Math.round((d-this.originalPageX)/e.grid[0])*e.grid[0];d=this.containment?!(d-this.offset.click.left<this.containment[0]||d-this.offset.click.left>this.containment[2])?d:!(d-this.offset.click.left<this.containment[0])?d-e.grid[0]:d+e.grid[0]:d}}return{top:c-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(a.browser.safari&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollTop():
g?0:b.scrollTop()),left:d-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(a.browser.safari&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():g?0:b.scrollLeft())}},_rearrange:function(f,e,b,g){b?b[0].appendChild(this.placeholder[0]):e.item[0].parentNode.insertBefore(this.placeholder[0],this.direction=="down"?e.item[0]:e.item[0].nextSibling);this.counter=this.counter?++this.counter:1;var d=this,c=this.counter;window.setTimeout(function(){c==
d.counter&&d.refreshPositions(!g)},0)},_clear:function(f,e){this.reverting=false;var b=[];!this._noFinalSort&&this.currentItem[0].parentNode&&this.placeholder.before(this.currentItem);this._noFinalSort=null;if(this.helper[0]==this.currentItem[0]){for(var g in this._storedCSS)if(this._storedCSS[g]=="auto"||this._storedCSS[g]=="static")this._storedCSS[g]="";this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();this.fromOutside&&!e&&b.push(function(d){this._trigger("receive",
d,this._uiHash(this.fromOutside))});if((this.fromOutside||this.domPosition.prev!=this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!=this.currentItem.parent()[0])&&!e)b.push(function(d){this._trigger("update",d,this._uiHash())});if(!a.ui.contains(this.element[0],this.currentItem[0])){e||b.push(function(d){this._trigger("remove",d,this._uiHash())});for(g=this.containers.length-1;g>=0;g--)if(a.ui.contains(this.containers[g].element[0],this.currentItem[0])&&!e){b.push(function(d){return function(c){d._trigger("receive",
c,this._uiHash(this))}}.call(this,this.containers[g]));b.push(function(d){return function(c){d._trigger("update",c,this._uiHash(this))}}.call(this,this.containers[g]))}}for(g=this.containers.length-1;g>=0;g--){e||b.push(function(d){return function(c){d._trigger("deactivate",c,this._uiHash(this))}}.call(this,this.containers[g]));if(this.containers[g].containerCache.over){b.push(function(d){return function(c){d._trigger("out",c,this._uiHash(this))}}.call(this,this.containers[g]));this.containers[g].containerCache.over=
0}}this._storedCursor&&a("body").css("cursor",this._storedCursor);this._storedOpacity&&this.helper.css("opacity",this._storedOpacity);if(this._storedZIndex)this.helper.css("zIndex",this._storedZIndex=="auto"?"":this._storedZIndex);this.dragging=false;if(this.cancelHelperRemoval){if(!e){this._trigger("beforeStop",f,this._uiHash());for(g=0;g<b.length;g++)b[g].call(this,f);this._trigger("stop",f,this._uiHash())}return false}e||this._trigger("beforeStop",f,this._uiHash());this.placeholder[0].parentNode.removeChild(this.placeholder[0]);
this.helper[0]!=this.currentItem[0]&&this.helper.remove();this.helper=null;if(!e){for(g=0;g<b.length;g++)b[g].call(this,f);this._trigger("stop",f,this._uiHash())}this.fromOutside=false;return true},_trigger:function(){a.Widget.prototype._trigger.apply(this,arguments)===false&&this.cancel()},_uiHash:function(f){var e=f||this;return{helper:e.helper,placeholder:e.placeholder||a([]),position:e.position,originalPosition:e.originalPosition,offset:e.positionAbs,item:e.currentItem,sender:f?f.element:null}}});
a.extend(a.ui.sortable,{version:"1.8.3"})})(jQuery);
jQuery.effects||function(a,f){function e(o){var n;if(o&&o.constructor==Array&&o.length==3)return o;if(n=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(o))return[parseInt(n[1],10),parseInt(n[2],10),parseInt(n[3],10)];if(n=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(o))return[parseFloat(n[1])*2.55,parseFloat(n[2])*2.55,parseFloat(n[3])*2.55];if(n=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(o))return[parseInt(n[1],16),
parseInt(n[2],16),parseInt(n[3],16)];if(n=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(o))return[parseInt(n[1]+n[1],16),parseInt(n[2]+n[2],16),parseInt(n[3]+n[3],16)];if(/rgba\(0, 0, 0, 0\)/.exec(o))return h.transparent;return h[a.trim(o).toLowerCase()]}function b(){var o=document.defaultView?document.defaultView.getComputedStyle(this,null):this.currentStyle,n={},m,C;if(o&&o.length&&o[0]&&o[o[0]])for(var I=o.length;I--;){m=o[I];if(typeof o[m]=="string"){C=m.replace(/\-(\w)/g,function(H,G){return G.toUpperCase()});
n[C]=o[m]}}else for(m in o)if(typeof o[m]==="string")n[m]=o[m];return n}function g(o){var n,m;for(n in o){m=o[n];if(m==null||a.isFunction(m)||n in l||/scrollbar/.test(n)||!/color/i.test(n)&&isNaN(parseFloat(m)))delete o[n]}return o}function d(o,n){var m={_:0},C;for(C in n)if(o[C]!=n[C])m[C]=n[C];return m}function c(o,n,m,C){if(typeof o=="object"){C=n;m=null;n=o;o=n.effect}if(a.isFunction(n)){C=n;m=null;n={}}if(typeof n=="number"||a.fx.speeds[n]){C=m;m=n;n={}}if(a.isFunction(m)){C=m;m=null}n=n||{};
m=m||n.duration;m=a.fx.off?0:typeof m=="number"?m:a.fx.speeds[m]||a.fx.speeds._default;C=C||n.complete;return[o,n,m,C]}a.effects={};a.each(["backgroundColor","borderBottomColor","borderLeftColor","borderRightColor","borderTopColor","color","outlineColor"],function(o,n){a.fx.step[n]=function(m){if(!m.colorInit){var C;C=m.elem;var I=n,H;do{H=a.curCSS(C,I);if(H!=""&&H!="transparent"||a.nodeName(C,"body"))break;I="backgroundColor"}while(C=C.parentNode);C=e(H);m.start=C;m.end=e(m.end);m.colorInit=true}m.elem.style[n]=
"rgb("+Math.max(Math.min(parseInt(m.pos*(m.end[0]-m.start[0])+m.start[0],10),255),0)+","+Math.max(Math.min(parseInt(m.pos*(m.end[1]-m.start[1])+m.start[1],10),255),0)+","+Math.max(Math.min(parseInt(m.pos*(m.end[2]-m.start[2])+m.start[2],10),255),0)+")"}});var h={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,
0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,
203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0],transparent:[255,255,255]},k=["add","remove","toggle"],l={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};a.effects.animateClass=function(o,n,m,C){if(a.isFunction(m)){C=m;m=null}return this.each(function(){var I=a(this),H=I.attr("style")||" ",G=g(b.call(this)),P,Q=I.attr("className");a.each(k,function(N,ba){o[ba]&&I[ba+
"Class"](o[ba])});P=g(b.call(this));I.attr("className",Q);I.animate(d(G,P),n,m,function(){a.each(k,function(N,ba){o[ba]&&I[ba+"Class"](o[ba])});if(typeof I.attr("style")=="object"){I.attr("style").cssText="";I.attr("style").cssText=H}else I.attr("style",H);C&&C.apply(this,arguments)})})};a.fn.extend({_addClass:a.fn.addClass,addClass:function(o,n,m,C){return n?a.effects.animateClass.apply(this,[{add:o},n,m,C]):this._addClass(o)},_removeClass:a.fn.removeClass,removeClass:function(o,n,m,C){return n?
a.effects.animateClass.apply(this,[{remove:o},n,m,C]):this._removeClass(o)},_toggleClass:a.fn.toggleClass,toggleClass:function(o,n,m,C,I){return typeof n=="boolean"||n===f?m?a.effects.animateClass.apply(this,[n?{add:o}:{remove:o},m,C,I]):this._toggleClass(o,n):a.effects.animateClass.apply(this,[{toggle:o},n,m,C])},switchClass:function(o,n,m,C,I){return a.effects.animateClass.apply(this,[{add:n,remove:o},m,C,I])}});a.extend(a.effects,{version:"1.8.3",save:function(o,n){for(var m=0;m<n.length;m++)n[m]!==
null&&o.data("ec.storage."+n[m],o[0].style[n[m]])},restore:function(o,n){for(var m=0;m<n.length;m++)n[m]!==null&&o.css(n[m],o.data("ec.storage."+n[m]))},setMode:function(o,n){if(n=="toggle")n=o.is(":hidden")?"show":"hide";return n},getBaseline:function(o,n){var m;switch(o[0]){case "top":m=0;break;case "middle":m=0.5;break;case "bottom":m=1;break;default:m=o[0]/n.height}switch(o[1]){case "left":o=0;break;case "center":o=0.5;break;case "right":o=1;break;default:o=o[1]/n.width}return{x:o,y:m}},createWrapper:function(o){if(o.parent().is(".ui-effects-wrapper"))return o.parent();
var n={width:o.outerWidth(true),height:o.outerHeight(true),"float":o.css("float")},m=a("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0});o.wrap(m);m=o.parent();if(o.css("position")=="static"){m.css({position:"relative"});o.css({position:"relative"})}else{a.extend(n,{position:o.css("position"),zIndex:o.css("z-index")});a.each(["top","left","bottom","right"],function(C,I){n[I]=o.css(I);if(isNaN(parseInt(n[I],10)))n[I]="auto"});
o.css({position:"relative",top:0,left:0})}return m.css(n).show()},removeWrapper:function(o){if(o.parent().is(".ui-effects-wrapper"))return o.parent().replaceWith(o);return o},setTransition:function(o,n,m,C){C=C||{};a.each(n,function(I,H){unit=o.cssUnit(H);if(unit[0]>0)C[H]=unit[0]*m+unit[1]});return C}});a.fn.extend({effect:function(o){var n=c.apply(this,arguments);n={options:n[1],duration:n[2],callback:n[3]};var m=a.effects[o];return m&&!a.fx.off?m.call(this,n):this},_show:a.fn.show,show:function(o){if(!o||
typeof o=="number"||a.fx.speeds[o])return this._show.apply(this,arguments);else{var n=c.apply(this,arguments);n[1].mode="show";return this.effect.apply(this,n)}},_hide:a.fn.hide,hide:function(o){if(!o||typeof o=="number"||a.fx.speeds[o])return this._hide.apply(this,arguments);else{var n=c.apply(this,arguments);n[1].mode="hide";return this.effect.apply(this,n)}},__toggle:a.fn.toggle,toggle:function(o){if(!o||typeof o=="number"||a.fx.speeds[o]||typeof o=="boolean"||a.isFunction(o))return this.__toggle.apply(this,
arguments);else{var n=c.apply(this,arguments);n[1].mode="toggle";return this.effect.apply(this,n)}},cssUnit:function(o){var n=this.css(o),m=[];a.each(["em","px","%","pt"],function(C,I){if(n.indexOf(I)>0)m=[parseFloat(n),I]});return m}});a.easing.jswing=a.easing.swing;a.extend(a.easing,{def:"easeOutQuad",swing:function(o,n,m,C,I){return a.easing[a.easing.def](o,n,m,C,I)},easeInQuad:function(o,n,m,C,I){return C*(n/=I)*n+m},easeOutQuad:function(o,n,m,C,I){return-C*(n/=I)*(n-2)+m},easeInOutQuad:function(o,
n,m,C,I){if((n/=I/2)<1)return C/2*n*n+m;return-C/2*(--n*(n-2)-1)+m},easeInCubic:function(o,n,m,C,I){return C*(n/=I)*n*n+m},easeOutCubic:function(o,n,m,C,I){return C*((n=n/I-1)*n*n+1)+m},easeInOutCubic:function(o,n,m,C,I){if((n/=I/2)<1)return C/2*n*n*n+m;return C/2*((n-=2)*n*n+2)+m},easeInQuart:function(o,n,m,C,I){return C*(n/=I)*n*n*n+m},easeOutQuart:function(o,n,m,C,I){return-C*((n=n/I-1)*n*n*n-1)+m},easeInOutQuart:function(o,n,m,C,I){if((n/=I/2)<1)return C/2*n*n*n*n+m;return-C/2*((n-=2)*n*n*n-2)+
m},easeInQuint:function(o,n,m,C,I){return C*(n/=I)*n*n*n*n+m},easeOutQuint:function(o,n,m,C,I){return C*((n=n/I-1)*n*n*n*n+1)+m},easeInOutQuint:function(o,n,m,C,I){if((n/=I/2)<1)return C/2*n*n*n*n*n+m;return C/2*((n-=2)*n*n*n*n+2)+m},easeInSine:function(o,n,m,C,I){return-C*Math.cos(n/I*(Math.PI/2))+C+m},easeOutSine:function(o,n,m,C,I){return C*Math.sin(n/I*(Math.PI/2))+m},easeInOutSine:function(o,n,m,C,I){return-C/2*(Math.cos(Math.PI*n/I)-1)+m},easeInExpo:function(o,n,m,C,I){return n==0?m:C*Math.pow(2,
10*(n/I-1))+m},easeOutExpo:function(o,n,m,C,I){return n==I?m+C:C*(-Math.pow(2,-10*n/I)+1)+m},easeInOutExpo:function(o,n,m,C,I){if(n==0)return m;if(n==I)return m+C;if((n/=I/2)<1)return C/2*Math.pow(2,10*(n-1))+m;return C/2*(-Math.pow(2,-10*--n)+2)+m},easeInCirc:function(o,n,m,C,I){return-C*(Math.sqrt(1-(n/=I)*n)-1)+m},easeOutCirc:function(o,n,m,C,I){return C*Math.sqrt(1-(n=n/I-1)*n)+m},easeInOutCirc:function(o,n,m,C,I){if((n/=I/2)<1)return-C/2*(Math.sqrt(1-n*n)-1)+m;return C/2*(Math.sqrt(1-(n-=2)*
n)+1)+m},easeInElastic:function(o,n,m,C,I){var H=0,G=C;if(n==0)return m;if((n/=I)==1)return m+C;H||(H=I*0.3);if(G<Math.abs(C)){G=C;o=H/4}else o=H/(2*Math.PI)*Math.asin(C/G);return-(G*Math.pow(2,10*(n-=1))*Math.sin((n*I-o)*2*Math.PI/H))+m},easeOutElastic:function(o,n,m,C,I){var H=0,G=C;if(n==0)return m;if((n/=I)==1)return m+C;H||(H=I*0.3);if(G<Math.abs(C)){G=C;o=H/4}else o=H/(2*Math.PI)*Math.asin(C/G);return G*Math.pow(2,-10*n)*Math.sin((n*I-o)*2*Math.PI/H)+C+m},easeInOutElastic:function(o,n,m,C,I){var H=
0,G=C;if(n==0)return m;if((n/=I/2)==2)return m+C;H||(H=I*0.3*1.5);if(G<Math.abs(C)){G=C;o=H/4}else o=H/(2*Math.PI)*Math.asin(C/G);if(n<1)return-0.5*G*Math.pow(2,10*(n-=1))*Math.sin((n*I-o)*2*Math.PI/H)+m;return G*Math.pow(2,-10*(n-=1))*Math.sin((n*I-o)*2*Math.PI/H)*0.5+C+m},easeInBack:function(o,n,m,C,I,H){if(H==f)H=1.70158;return C*(n/=I)*n*((H+1)*n-H)+m},easeOutBack:function(o,n,m,C,I,H){if(H==f)H=1.70158;return C*((n=n/I-1)*n*((H+1)*n+H)+1)+m},easeInOutBack:function(o,n,m,C,I,H){if(H==f)H=1.70158;
if((n/=I/2)<1)return C/2*n*n*(((H*=1.525)+1)*n-H)+m;return C/2*((n-=2)*n*(((H*=1.525)+1)*n+H)+2)+m},easeInBounce:function(o,n,m,C,I){return C-a.easing.easeOutBounce(o,I-n,0,C,I)+m},easeOutBounce:function(o,n,m,C,I){return(n/=I)<1/2.75?C*7.5625*n*n+m:n<2/2.75?C*(7.5625*(n-=1.5/2.75)*n+0.75)+m:n<2.5/2.75?C*(7.5625*(n-=2.25/2.75)*n+0.9375)+m:C*(7.5625*(n-=2.625/2.75)*n+0.984375)+m},easeInOutBounce:function(o,n,m,C,I){if(n<I/2)return a.easing.easeInBounce(o,n*2,0,C,I)*0.5+m;return a.easing.easeOutBounce(o,
n*2-I,0,C,I)*0.5+C*0.5+m}})}(jQuery);
(function(a){a.effects.blind=function(f){return this.queue(function(){var e=a(this),b=["position","top","left"],g=a.effects.setMode(e,f.options.mode||"hide"),d=f.options.direction||"vertical";a.effects.save(e,b);e.show();var c=a.effects.createWrapper(e).css({overflow:"hidden"}),h=d=="vertical"?"height":"width";d=d=="vertical"?c.height():c.width();g=="show"&&c.css(h,0);var k={};k[h]=g=="show"?d:0;c.animate(k,f.duration,f.options.easing,function(){g=="hide"&&e.hide();a.effects.restore(e,b);a.effects.removeWrapper(e);
f.callback&&f.callback.apply(e[0],arguments);e.dequeue()})})}})(jQuery);
(function(a){a.effects.bounce=function(f){return this.queue(function(){var e=a(this),b=["position","top","left"],g=a.effects.setMode(e,f.options.mode||"effect"),d=f.options.direction||"up",c=f.options.distance||20,h=f.options.times||5,k=f.duration||250;/show|hide/.test(g)&&b.push("opacity");a.effects.save(e,b);e.show();a.effects.createWrapper(e);var l=d=="up"||d=="down"?"top":"left";d=d=="up"||d=="left"?"pos":"neg";c=f.options.distance||(l=="top"?e.outerHeight({margin:true})/3:e.outerWidth({margin:true})/
3);if(g=="show")e.css("opacity",0).css(l,d=="pos"?-c:c);if(g=="hide")c/=h*2;g!="hide"&&h--;if(g=="show"){var o={opacity:1};o[l]=(d=="pos"?"+=":"-=")+c;e.animate(o,k/2,f.options.easing);c/=2;h--}for(o=0;o<h;o++){var n={},m={};n[l]=(d=="pos"?"-=":"+=")+c;m[l]=(d=="pos"?"+=":"-=")+c;e.animate(n,k/2,f.options.easing).animate(m,k/2,f.options.easing);c=g=="hide"?c*2:c/2}if(g=="hide"){o={opacity:0};o[l]=(d=="pos"?"-=":"+=")+c;e.animate(o,k/2,f.options.easing,function(){e.hide();a.effects.restore(e,b);a.effects.removeWrapper(e);
f.callback&&f.callback.apply(this,arguments)})}else{n={};m={};n[l]=(d=="pos"?"-=":"+=")+c;m[l]=(d=="pos"?"+=":"-=")+c;e.animate(n,k/2,f.options.easing).animate(m,k/2,f.options.easing,function(){a.effects.restore(e,b);a.effects.removeWrapper(e);f.callback&&f.callback.apply(this,arguments)})}e.queue("fx",function(){e.dequeue()});e.dequeue()})}})(jQuery);
(function(a){a.effects.clip=function(f){return this.queue(function(){var e=a(this),b=["position","top","left","height","width"],g=a.effects.setMode(e,f.options.mode||"hide"),d=f.options.direction||"vertical";a.effects.save(e,b);e.show();var c=a.effects.createWrapper(e).css({overflow:"hidden"});c=e[0].tagName=="IMG"?c:e;var h={size:d=="vertical"?"height":"width",position:d=="vertical"?"top":"left"};d=d=="vertical"?c.height():c.width();if(g=="show"){c.css(h.size,0);c.css(h.position,d/2)}var k={};k[h.size]=
g=="show"?d:0;k[h.position]=g=="show"?0:d/2;c.animate(k,{queue:false,duration:f.duration,easing:f.options.easing,complete:function(){g=="hide"&&e.hide();a.effects.restore(e,b);a.effects.removeWrapper(e);f.callback&&f.callback.apply(e[0],arguments);e.dequeue()}})})}})(jQuery);
(function(a){a.effects.drop=function(f){return this.queue(function(){var e=a(this),b=["position","top","left","opacity"],g=a.effects.setMode(e,f.options.mode||"hide"),d=f.options.direction||"left";a.effects.save(e,b);e.show();a.effects.createWrapper(e);var c=d=="up"||d=="down"?"top":"left";d=d=="up"||d=="left"?"pos":"neg";var h=f.options.distance||(c=="top"?e.outerHeight({margin:true})/2:e.outerWidth({margin:true})/2);if(g=="show")e.css("opacity",0).css(c,d=="pos"?-h:h);var k={opacity:g=="show"?1:
0};k[c]=(g=="show"?d=="pos"?"+=":"-=":d=="pos"?"-=":"+=")+h;e.animate(k,{queue:false,duration:f.duration,easing:f.options.easing,complete:function(){g=="hide"&&e.hide();a.effects.restore(e,b);a.effects.removeWrapper(e);f.callback&&f.callback.apply(this,arguments);e.dequeue()}})})}})(jQuery);
(function(a){a.effects.explode=function(f){return this.queue(function(){var e=f.options.pieces?Math.round(Math.sqrt(f.options.pieces)):3,b=f.options.pieces?Math.round(Math.sqrt(f.options.pieces)):3;f.options.mode=f.options.mode=="toggle"?a(this).is(":visible")?"hide":"show":f.options.mode;var g=a(this).show().css("visibility","hidden"),d=g.offset();d.top-=parseInt(g.css("marginTop"),10)||0;d.left-=parseInt(g.css("marginLeft"),10)||0;for(var c=g.outerWidth(true),h=g.outerHeight(true),k=0;k<e;k++)for(var l=
0;l<b;l++)g.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-l*(c/b),top:-k*(h/e)}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:c/b,height:h/e,left:d.left+l*(c/b)+(f.options.mode=="show"?(l-Math.floor(b/2))*(c/b):0),top:d.top+k*(h/e)+(f.options.mode=="show"?(k-Math.floor(e/2))*(h/e):0),opacity:f.options.mode=="show"?0:1}).animate({left:d.left+l*(c/b)+(f.options.mode=="show"?0:(l-Math.floor(b/2))*(c/b)),top:d.top+
k*(h/e)+(f.options.mode=="show"?0:(k-Math.floor(e/2))*(h/e)),opacity:f.options.mode=="show"?1:0},f.duration||500);setTimeout(function(){f.options.mode=="show"?g.css({visibility:"visible"}):g.css({visibility:"visible"}).hide();f.callback&&f.callback.apply(g[0]);g.dequeue();a("div.ui-effects-explode").remove()},f.duration||500)})}})(jQuery);
(function(a){a.effects.fade=function(f){return this.queue(function(){var e=a(this),b=a.effects.setMode(e,f.options.mode||"hide");e.animate({opacity:b},{queue:false,duration:f.duration,easing:f.options.easing,complete:function(){f.callback&&f.callback.apply(this,arguments);e.dequeue()}})})}})(jQuery);
(function(a){a.effects.fold=function(f){return this.queue(function(){var e=a(this),b=["position","top","left"],g=a.effects.setMode(e,f.options.mode||"hide"),d=f.options.size||15,c=!!f.options.horizFirst,h=f.duration?f.duration/2:a.fx.speeds._default/2;a.effects.save(e,b);e.show();var k=a.effects.createWrapper(e).css({overflow:"hidden"}),l=g=="show"!=c,o=l?["width","height"]:["height","width"];l=l?[k.width(),k.height()]:[k.height(),k.width()];var n=/([0-9]+)%/.exec(d);if(n)d=parseInt(n[1],10)/100*
l[g=="hide"?0:1];if(g=="show")k.css(c?{height:0,width:d}:{height:d,width:0});c={};n={};c[o[0]]=g=="show"?l[0]:d;n[o[1]]=g=="show"?l[1]:0;k.animate(c,h,f.options.easing).animate(n,h,f.options.easing,function(){g=="hide"&&e.hide();a.effects.restore(e,b);a.effects.removeWrapper(e);f.callback&&f.callback.apply(e[0],arguments);e.dequeue()})})}})(jQuery);
(function(a){a.effects.highlight=function(f){return this.queue(function(){var e=a(this),b=["backgroundImage","backgroundColor","opacity"],g=a.effects.setMode(e,f.options.mode||"show"),d={backgroundColor:e.css("backgroundColor")};if(g=="hide")d.opacity=0;a.effects.save(e,b);e.show().css({backgroundImage:"none",backgroundColor:f.options.color||"#ffff99"}).animate(d,{queue:false,duration:f.duration,easing:f.options.easing,complete:function(){g=="hide"&&e.hide();a.effects.restore(e,b);g=="show"&&!a.support.opacity&&
this.style.removeAttribute("filter");f.callback&&f.callback.apply(this,arguments);e.dequeue()}})})}})(jQuery);
(function(a){a.effects.pulsate=function(f){return this.queue(function(){var e=a(this),b=a.effects.setMode(e,f.options.mode||"show");times=(f.options.times||5)*2-1;duration=f.duration?f.duration/2:a.fx.speeds._default/2;isVisible=e.is(":visible");animateTo=0;if(!isVisible){e.css("opacity",0).show();animateTo=1}if(b=="hide"&&isVisible||b=="show"&&!isVisible)times--;for(b=0;b<times;b++){e.animate({opacity:animateTo},duration,f.options.easing);animateTo=(animateTo+1)%2}e.animate({opacity:animateTo},duration,
f.options.easing,function(){animateTo==0&&e.hide();f.callback&&f.callback.apply(this,arguments)});e.queue("fx",function(){e.dequeue()}).dequeue()})}})(jQuery);
(function(a){a.effects.puff=function(f){return this.queue(function(){var e=a(this),b=a.effects.setMode(e,f.options.mode||"hide"),g=parseInt(f.options.percent,10)||150,d=g/100,c={height:e.height(),width:e.width()};a.extend(f.options,{fade:true,mode:b,percent:b=="hide"?g:100,from:b=="hide"?c:{height:c.height*d,width:c.width*d}});e.effect("scale",f.options,f.duration,f.callback);e.dequeue()})};a.effects.scale=function(f){return this.queue(function(){var e=a(this),b=a.extend(true,{},f.options),g=a.effects.setMode(e,
f.options.mode||"effect"),d=parseInt(f.options.percent,10)||(parseInt(f.options.percent,10)==0?0:g=="hide"?0:100),c=f.options.direction||"both",h=f.options.origin;if(g!="effect"){b.origin=h||["middle","center"];b.restore=true}h={height:e.height(),width:e.width()};e.from=f.options.from||(g=="show"?{height:0,width:0}:h);d={y:c!="horizontal"?d/100:1,x:c!="vertical"?d/100:1};e.to={height:h.height*d.y,width:h.width*d.x};if(f.options.fade){if(g=="show"){e.from.opacity=0;e.to.opacity=1}if(g=="hide"){e.from.opacity=
1;e.to.opacity=0}}b.from=e.from;b.to=e.to;b.mode=g;e.effect("size",b,f.duration,f.callback);e.dequeue()})};a.effects.size=function(f){return this.queue(function(){var e=a(this),b=["position","top","left","width","height","overflow","opacity"],g=["position","top","left","overflow","opacity"],d=["width","height","overflow"],c=["fontSize"],h=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],k=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],l=a.effects.setMode(e,
f.options.mode||"effect"),o=f.options.restore||false,n=f.options.scale||"both",m=f.options.origin,C={height:e.height(),width:e.width()};e.from=f.options.from||C;e.to=f.options.to||C;if(m){m=a.effects.getBaseline(m,C);e.from.top=(C.height-e.from.height)*m.y;e.from.left=(C.width-e.from.width)*m.x;e.to.top=(C.height-e.to.height)*m.y;e.to.left=(C.width-e.to.width)*m.x}var I={from:{y:e.from.height/C.height,x:e.from.width/C.width},to:{y:e.to.height/C.height,x:e.to.width/C.width}};if(n=="box"||n=="both"){if(I.from.y!=
I.to.y){b=b.concat(h);e.from=a.effects.setTransition(e,h,I.from.y,e.from);e.to=a.effects.setTransition(e,h,I.to.y,e.to)}if(I.from.x!=I.to.x){b=b.concat(k);e.from=a.effects.setTransition(e,k,I.from.x,e.from);e.to=a.effects.setTransition(e,k,I.to.x,e.to)}}if(n=="content"||n=="both")if(I.from.y!=I.to.y){b=b.concat(c);e.from=a.effects.setTransition(e,c,I.from.y,e.from);e.to=a.effects.setTransition(e,c,I.to.y,e.to)}a.effects.save(e,o?b:g);e.show();a.effects.createWrapper(e);e.css("overflow","hidden").css(e.from);
if(n=="content"||n=="both"){h=h.concat(["marginTop","marginBottom"]).concat(c);k=k.concat(["marginLeft","marginRight"]);d=b.concat(h).concat(k);e.find("*[width]").each(function(){child=a(this);o&&a.effects.save(child,d);var H={height:child.height(),width:child.width()};child.from={height:H.height*I.from.y,width:H.width*I.from.x};child.to={height:H.height*I.to.y,width:H.width*I.to.x};if(I.from.y!=I.to.y){child.from=a.effects.setTransition(child,h,I.from.y,child.from);child.to=a.effects.setTransition(child,
h,I.to.y,child.to)}if(I.from.x!=I.to.x){child.from=a.effects.setTransition(child,k,I.from.x,child.from);child.to=a.effects.setTransition(child,k,I.to.x,child.to)}child.css(child.from);child.animate(child.to,f.duration,f.options.easing,function(){o&&a.effects.restore(child,d)})})}e.animate(e.to,{queue:false,duration:f.duration,easing:f.options.easing,complete:function(){e.to.opacity===0&&e.css("opacity",e.from.opacity);l=="hide"&&e.hide();a.effects.restore(e,o?b:g);a.effects.removeWrapper(e);f.callback&&
f.callback.apply(this,arguments);e.dequeue()}})})}})(jQuery);
(function(a){a.effects.shake=function(f){return this.queue(function(){var e=a(this),b=["position","top","left"];a.effects.setMode(e,f.options.mode||"effect");var g=f.options.direction||"left",d=f.options.distance||20,c=f.options.times||3,h=f.duration||f.options.duration||140;a.effects.save(e,b);e.show();a.effects.createWrapper(e);var k=g=="up"||g=="down"?"top":"left",l=g=="up"||g=="left"?"pos":"neg";g={};var o={},n={};g[k]=(l=="pos"?"-=":"+=")+d;o[k]=(l=="pos"?"+=":"-=")+d*2;n[k]=(l=="pos"?"-=":"+=")+
d*2;e.animate(g,h,f.options.easing);for(d=1;d<c;d++)e.animate(o,h,f.options.easing).animate(n,h,f.options.easing);e.animate(o,h,f.options.easing).animate(g,h/2,f.options.easing,function(){a.effects.restore(e,b);a.effects.removeWrapper(e);f.callback&&f.callback.apply(this,arguments)});e.queue("fx",function(){e.dequeue()});e.dequeue()})}})(jQuery);
(function(a){a.effects.slide=function(f){return this.queue(function(){var e=a(this),b=["position","top","left"],g=a.effects.setMode(e,f.options.mode||"show"),d=f.options.direction||"left";a.effects.save(e,b);e.show();a.effects.createWrapper(e).css({overflow:"hidden"});var c=d=="up"||d=="down"?"top":"left";d=d=="up"||d=="left"?"pos":"neg";var h=f.options.distance||(c=="top"?e.outerHeight({margin:true}):e.outerWidth({margin:true}));if(g=="show")e.css(c,d=="pos"?-h:h);var k={};k[c]=(g=="show"?d=="pos"?
"+=":"-=":d=="pos"?"-=":"+=")+h;e.animate(k,{queue:false,duration:f.duration,easing:f.options.easing,complete:function(){g=="hide"&&e.hide();a.effects.restore(e,b);a.effects.removeWrapper(e);f.callback&&f.callback.apply(this,arguments);e.dequeue()}})})}})(jQuery);
(function(a){a.effects.transfer=function(f){return this.queue(function(){var e=a(this),b=a(f.options.to),g=b.offset();b={top:g.top,left:g.left,height:b.innerHeight(),width:b.innerWidth()};g=e.offset();var d=a('<div class="ui-effects-transfer"></div>').appendTo(document.body).addClass(f.options.className).css({top:g.top,left:g.left,height:e.innerHeight(),width:e.innerWidth(),position:"absolute"}).animate(b,f.duration,f.options.easing,function(){d.remove();f.callback&&f.callback.apply(e[0],arguments);
e.dequeue()})})}})(jQuery);
(function(a){a.widget("ui.accordion",{options:{active:0,animated:"slide",autoHeight:true,clearStyle:false,collapsible:false,event:"click",fillSpace:false,header:"> li > :first-child,> :not(li):even",icons:{header:"ui-icon-triangle-1-e",headerSelected:"ui-icon-triangle-1-s"},navigation:false,navigationFilter:function(){return this.href.toLowerCase()===location.href.toLowerCase()}},_create:function(){var f=this,e=f.options;f.running=0;f.element.addClass("ui-accordion ui-widget ui-helper-reset").children("li").addClass("ui-accordion-li-fix");f.headers=
f.element.find(e.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all").bind("mouseenter.accordion",function(){e.disabled||a(this).addClass("ui-state-hover")}).bind("mouseleave.accordion",function(){e.disabled||a(this).removeClass("ui-state-hover")}).bind("focus.accordion",function(){e.disabled||a(this).addClass("ui-state-focus")}).bind("blur.accordion",function(){e.disabled||a(this).removeClass("ui-state-focus")});f.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom");
if(e.navigation){var b=f.element.find("a").filter(e.navigationFilter).eq(0);if(b.length){var g=b.closest(".ui-accordion-header");f.active=g.length?g:b.closest(".ui-accordion-content").prev()}}f.active=f._findActive(f.active||e.active).addClass("ui-state-default ui-state-active").toggleClass("ui-corner-all ui-corner-top");f.active.next().addClass("ui-accordion-content-active");f._createIcons();f.resize();f.element.attr("role","tablist");f.headers.attr("role","tab").bind("keydown.accordion",function(d){return f._keydown(d)}).next().attr("role",
"tabpanel");f.headers.not(f.active||"").attr({"aria-expanded":"false",tabIndex:-1}).next().hide();f.active.length?f.active.attr({"aria-expanded":"true",tabIndex:0}):f.headers.eq(0).attr("tabIndex",0);a.browser.safari||f.headers.find("a").attr("tabIndex",-1);e.event&&f.headers.bind(e.event.split(" ").join(".accordion ")+".accordion",function(d){f._clickHandler.call(f,d,this);d.preventDefault()})},_createIcons:function(){var f=this.options;if(f.icons){a("<span></span>").addClass("ui-icon "+f.icons.header).prependTo(this.headers);
this.active.children(".ui-icon").toggleClass(f.icons.header).toggleClass(f.icons.headerSelected);this.element.addClass("ui-accordion-icons")}},_destroyIcons:function(){this.headers.children(".ui-icon").remove();this.element.removeClass("ui-accordion-icons")},destroy:function(){var f=this.options;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role");this.headers.unbind(".accordion").removeClass("ui-accordion-header ui-accordion-disabled ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("tabIndex");
this.headers.find("a").removeAttr("tabIndex");this._destroyIcons();var e=this.headers.next().css("display","").removeAttr("role").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-accordion-disabled ui-state-disabled");if(f.autoHeight||f.fillHeight)e.css("height","");return a.Widget.prototype.destroy.call(this)},_setOption:function(f,e){a.Widget.prototype._setOption.apply(this,arguments);f=="active"&&this.activate(e);if(f=="icons"){this._destroyIcons();
e&&this._createIcons()}if(f=="disabled")this.headers.add(this.headers.next())[e?"addClass":"removeClass"]("ui-accordion-disabled ui-state-disabled")},_keydown:function(f){if(!(this.options.disabled||f.altKey||f.ctrlKey)){var e=a.ui.keyCode,b=this.headers.length,g=this.headers.index(f.target),d=false;switch(f.keyCode){case e.RIGHT:case e.DOWN:d=this.headers[(g+1)%b];break;case e.LEFT:case e.UP:d=this.headers[(g-1+b)%b];break;case e.SPACE:case e.ENTER:this._clickHandler({target:f.target},f.target);
f.preventDefault()}if(d){a(f.target).attr("tabIndex",-1);a(d).attr("tabIndex",0);d.focus();return false}return true}},resize:function(){var f=this.options,e;if(f.fillSpace){if(a.browser.msie){var b=this.element.parent().css("overflow");this.element.parent().css("overflow","hidden")}e=this.element.parent().height();a.browser.msie&&this.element.parent().css("overflow",b);this.headers.each(function(){e-=a(this).outerHeight(true)});this.headers.next().each(function(){a(this).height(Math.max(0,e-a(this).innerHeight()+
a(this).height()))}).css("overflow","auto")}else if(f.autoHeight){e=0;this.headers.next().each(function(){e=Math.max(e,a(this).height("").height())}).height(e)}return this},activate:function(f){this.options.active=f;f=this._findActive(f)[0];this._clickHandler({target:f},f);return this},_findActive:function(f){return f?typeof f==="number"?this.headers.filter(":eq("+f+")"):this.headers.not(this.headers.not(f)):f===false?a([]):this.headers.filter(":eq(0)")},_clickHandler:function(f,e){var b=this.options;
if(!b.disabled)if(f.target){f=a(f.currentTarget||e);e=f[0]===this.active[0];b.active=b.collapsible&&e?false:this.headers.index(f);if(!(this.running||!b.collapsible&&e)){this.active.removeClass("ui-state-active ui-corner-top").addClass("ui-state-default ui-corner-all").children(".ui-icon").removeClass(b.icons.headerSelected).addClass(b.icons.header);if(!e){f.removeClass("ui-state-default ui-corner-all").addClass("ui-state-active ui-corner-top").children(".ui-icon").removeClass(b.icons.header).addClass(b.icons.headerSelected);
f.next().addClass("ui-accordion-content-active")}c=f.next();g=this.active.next();d={options:b,newHeader:e&&b.collapsible?a([]):f,oldHeader:this.active,newContent:e&&b.collapsible?a([]):c,oldContent:g};b=this.headers.index(this.active[0])>this.headers.index(f[0]);this.active=e?a([]):f;this._toggle(c,g,d,e,b)}}else if(b.collapsible){this.active.removeClass("ui-state-active ui-corner-top").addClass("ui-state-default ui-corner-all").children(".ui-icon").removeClass(b.icons.headerSelected).addClass(b.icons.header);
this.active.next().addClass("ui-accordion-content-active");var g=this.active.next(),d={options:b,newHeader:a([]),oldHeader:b.active,newContent:a([]),oldContent:g},c=this.active=a([]);this._toggle(c,g,d)}},_toggle:function(f,e,b,g,d){var c=this,h=c.options;c.toShow=f;c.toHide=e;c.data=b;var k=function(){if(c)return c._completed.apply(c,arguments)};c._trigger("changestart",null,c.data);c.running=e.size()===0?f.size():e.size();if(h.animated){b={};b=h.collapsible&&g?{toShow:a([]),toHide:e,complete:k,
down:d,autoHeight:h.autoHeight||h.fillSpace}:{toShow:f,toHide:e,complete:k,down:d,autoHeight:h.autoHeight||h.fillSpace};if(!h.proxied)h.proxied=h.animated;if(!h.proxiedDuration)h.proxiedDuration=h.duration;h.animated=a.isFunction(h.proxied)?h.proxied(b):h.proxied;h.duration=a.isFunction(h.proxiedDuration)?h.proxiedDuration(b):h.proxiedDuration;g=a.ui.accordion.animations;var l=h.duration,o=h.animated;if(o&&!g[o]&&!a.easing[o])o="slide";g[o]||(g[o]=function(n){this.slide(n,{easing:o,duration:l||700})});
g[o](b)}else{if(h.collapsible&&g)f.toggle();else{e.hide();f.show()}k(true)}e.prev().attr({"aria-expanded":"false",tabIndex:-1}).blur();f.prev().attr({"aria-expanded":"true",tabIndex:0}).focus()},_completed:function(f){this.running=f?0:--this.running;if(!this.running){this.options.clearStyle&&this.toShow.add(this.toHide).css({height:"",overflow:""});this.toHide.removeClass("ui-accordion-content-active");this._trigger("change",null,this.data)}}});a.extend(a.ui.accordion,{version:"1.8.3",animations:{slide:function(f,
e){f=a.extend({easing:"swing",duration:300},f,e);if(f.toHide.size())if(f.toShow.size()){var b=f.toShow.css("overflow"),g=0,d={},c={},h;e=f.toShow;h=e[0].style.width;e.width(parseInt(e.parent().width(),10)-parseInt(e.css("paddingLeft"),10)-parseInt(e.css("paddingRight"),10)-(parseInt(e.css("borderLeftWidth"),10)||0)-(parseInt(e.css("borderRightWidth"),10)||0));a.each(["height","paddingTop","paddingBottom"],function(k,l){c[l]="hide";k=(""+a.css(f.toShow[0],l)).match(/^([\d+-.]+)(.*)$/);d[l]={value:k[1],
unit:k[2]||"px"}});f.toShow.css({height:0,overflow:"hidden"}).show();f.toHide.filter(":hidden").each(f.complete).end().filter(":visible").animate(c,{step:function(k,l){if(l.prop=="height")g=l.end-l.start===0?0:(l.now-l.start)/(l.end-l.start);f.toShow[0].style[l.prop]=g*d[l.prop].value+d[l.prop].unit},duration:f.duration,easing:f.easing,complete:function(){f.autoHeight||f.toShow.css("height","");f.toShow.css({width:h,overflow:b});f.complete()}})}else f.toHide.animate({height:"hide",paddingTop:"hide",
paddingBottom:"hide"},f);else f.toShow.animate({height:"show",paddingTop:"show",paddingBottom:"show"},f)},bounceslide:function(f){this.slide(f,{easing:f.down?"easeOutBounce":"swing",duration:f.down?1E3:200})}}})})(jQuery);
(function(a){a.widget("ui.autocomplete",{options:{appendTo:"body",delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null},_create:function(){var f=this,e=this.element[0].ownerDocument;this.element.addClass("ui-autocomplete-input").attr("autocomplete","off").attr({role:"textbox","aria-autocomplete":"list","aria-haspopup":"true"}).bind("keydown.autocomplete",function(b){if(!f.options.disabled){var g=a.ui.keyCode;switch(b.keyCode){case g.PAGE_UP:f._move("previousPage",
b);break;case g.PAGE_DOWN:f._move("nextPage",b);break;case g.UP:f._move("previous",b);b.preventDefault();break;case g.DOWN:f._move("next",b);b.preventDefault();break;case g.ENTER:case g.NUMPAD_ENTER:f.menu.element.is(":visible")&&b.preventDefault();case g.TAB:if(!f.menu.active)break;f.menu.select(b);break;case g.ESCAPE:f.element.val(f.term);f.close(b);break;default:clearTimeout(f.searching);f.searching=setTimeout(function(){if(f.term!=f.element.val()){f.selectedItem=null;f.search(null,b)}},f.options.delay)}}}).bind("focus.autocomplete",
function(){if(!f.options.disabled){f.selectedItem=null;f.previous=f.element.val()}}).bind("blur.autocomplete",function(b){if(!f.options.disabled){clearTimeout(f.searching);f.closing=setTimeout(function(){f.close(b);f._change(b)},150)}});this._initSource();this.response=function(){return f._response.apply(f,arguments)};this.menu=a("<ul></ul>").addClass("ui-autocomplete").appendTo(a(this.options.appendTo||"body",e)[0]).mousedown(function(){setTimeout(function(){clearTimeout(f.closing)},13)}).menu({focus:function(b,
g){g=g.item.data("item.autocomplete");false!==f._trigger("focus",null,{item:g})&&/^key/.test(b.originalEvent.type)&&f.element.val(g.value)},selected:function(b,g){g=g.item.data("item.autocomplete");var d=f.previous;if(f.element[0]!==e.activeElement){f.element.focus();f.previous=d}false!==f._trigger("select",b,{item:g})&&f.element.val(g.value);f.close(b);f.selectedItem=g},blur:function(){f.menu.element.is(":visible")&&f.element.val(f.term)}}).zIndex(this.element.zIndex()+1).css({top:0,left:0}).hide().data("menu");
a.fn.bgiframe&&this.menu.element.bgiframe()},destroy:function(){this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete").removeAttr("role").removeAttr("aria-autocomplete").removeAttr("aria-haspopup");this.menu.element.remove();a.Widget.prototype.destroy.call(this)},_setOption:function(f,e){a.Widget.prototype._setOption.apply(this,arguments);f==="source"&&this._initSource();if(f==="appendTo")this.menu.element.appendTo(a(e||"body",this.element[0].ownerDocument)[0])},_initSource:function(){var f,
e;if(a.isArray(this.options.source)){f=this.options.source;this.source=function(b,g){g(a.ui.autocomplete.filter(f,b.term))}}else if(typeof this.options.source==="string"){e=this.options.source;this.source=function(b,g){a.getJSON(e,b,g)}}else this.source=this.options.source},search:function(f,e){f=f!=null?f:this.element.val();if(f.length<this.options.minLength)return this.close(e);clearTimeout(this.closing);if(this._trigger("search")!==false)return this._search(f)},_search:function(f){this.term=this.element.addClass("ui-autocomplete-loading").val();
this.source({term:f},this.response)},_response:function(f){if(f.length){f=this._normalize(f);this._suggest(f);this._trigger("open")}else this.close();this.element.removeClass("ui-autocomplete-loading")},close:function(f){clearTimeout(this.closing);if(this.menu.element.is(":visible")){this._trigger("close",f);this.menu.element.hide();this.menu.deactivate()}},_change:function(f){this.previous!==this.element.val()&&this._trigger("change",f,{item:this.selectedItem})},_normalize:function(f){if(f.length&&
f[0].label&&f[0].value)return f;return a.map(f,function(e){if(typeof e==="string")return{label:e,value:e};return a.extend({label:e.label||e.value,value:e.value||e.label},e)})},_suggest:function(f){var e=this.menu.element.empty().zIndex(this.element.zIndex()+1),b;this._renderMenu(e,f);this.menu.deactivate();this.menu.refresh();this.menu.element.show().position(a.extend({of:this.element},this.options.position));f=e.width("").outerWidth();b=this.element.outerWidth();e.outerWidth(Math.max(f,b))},_renderMenu:function(f,
e){var b=this;a.each(e,function(g,d){b._renderItem(f,d)})},_renderItem:function(f,e){return a("<li></li>").data("item.autocomplete",e).append(a("<a></a>").text(e.label)).appendTo(f)},_move:function(f,e){if(this.menu.element.is(":visible"))if(this.menu.first()&&/^previous/.test(f)||this.menu.last()&&/^next/.test(f)){this.element.val(this.term);this.menu.deactivate()}else this.menu[f](e);else this.search(null,e)},widget:function(){return this.menu.element}});a.extend(a.ui.autocomplete,{escapeRegex:function(f){return f.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,
"\\$&")},filter:function(f,e){var b=RegExp(a.ui.autocomplete.escapeRegex(e),"i");return a.grep(f,function(g){return b.test(g.label||g.value||g)})}})})(jQuery);
(function(a){a.widget("ui.menu",{_create:function(){var f=this;this.element.addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr({role:"listbox","aria-activedescendant":"ui-active-menuitem"}).click(function(e){if(a(e.target).closest(".ui-menu-item a").length){e.preventDefault();f.select(e)}});this.refresh()},refresh:function(){var f=this;this.element.children("li:not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","menuitem").children("a").addClass("ui-corner-all").attr("tabindex",
-1).mouseenter(function(e){f.activate(e,a(this).parent())}).mouseleave(function(){f.deactivate()})},activate:function(f,e){this.deactivate();if(this.hasScroll()){var b=e.offset().top-this.element.offset().top,g=this.element.attr("scrollTop"),d=this.element.height();if(b<0)this.element.attr("scrollTop",g+b);else b>d&&this.element.attr("scrollTop",g+b-d+e.height())}this.active=e.eq(0).children("a").addClass("ui-state-hover").attr("id","ui-active-menuitem").end();this._trigger("focus",f,{item:e})},deactivate:function(){if(this.active){this.active.children("a").removeClass("ui-state-hover").removeAttr("id");
this._trigger("blur");this.active=null}},next:function(f){this.move("next",".ui-menu-item:first",f)},previous:function(f){this.move("prev",".ui-menu-item:last",f)},first:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},last:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},move:function(f,e,b){if(this.active){f=this.active[f+"All"](".ui-menu-item").eq(0);f.length?this.activate(b,f):this.activate(b,this.element.children(e))}else this.activate(b,
this.element.children(e))},nextPage:function(f){if(this.hasScroll())if(!this.active||this.last())this.activate(f,this.element.children(":first"));else{var e=this.active.offset().top,b=this.element.height(),g=this.element.children("li").filter(function(){var d=a(this).offset().top-e-b+a(this).height();return d<10&&d>-10});g.length||(g=this.element.children(":last"));this.activate(f,g)}else this.activate(f,this.element.children(!this.active||this.last()?":first":":last"))},previousPage:function(f){if(this.hasScroll())if(!this.active||
this.first())this.activate(f,this.element.children(":last"));else{var e=this.active.offset().top,b=this.element.height();result=this.element.children("li").filter(function(){var g=a(this).offset().top-e+b-a(this).height();return g<10&&g>-10});result.length||(result=this.element.children(":first"));this.activate(f,result)}else this.activate(f,this.element.children(!this.active||this.first()?":last":":first"))},hasScroll:function(){return this.element.height()<this.element.attr("scrollHeight")},select:function(f){this._trigger("selected",
f,{item:this.active})}})})(jQuery);
(function(a){var f,e=function(g){a(":ui-button",g.target.form).each(function(){var d=a(this).data("button");setTimeout(function(){d.refresh()},1)})},b=function(g){var d=g.name,c=g.form,h=a([]);if(d)h=c?a(c).find("[name='"+d+"']"):a("[name='"+d+"']",g.ownerDocument).filter(function(){return!this.form});return h};a.widget("ui.button",{options:{text:true,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset.button").bind("reset.button",e);this._determineButtonType();
this.hasTitle=!!this.buttonElement.attr("title");var g=this,d=this.options,c=this.type==="checkbox"||this.type==="radio",h="ui-state-hover"+(!c?" ui-state-active":"");if(d.label===null)d.label=this.buttonElement.html();if(this.element.is(":disabled"))d.disabled=true;this.buttonElement.addClass("ui-button ui-widget ui-state-default ui-corner-all").attr("role","button").bind("mouseenter.button",function(){if(!d.disabled){a(this).addClass("ui-state-hover");this===f&&a(this).addClass("ui-state-active")}}).bind("mouseleave.button",
function(){d.disabled||a(this).removeClass(h)}).bind("focus.button",function(){a(this).addClass("ui-state-focus")}).bind("blur.button",function(){a(this).removeClass("ui-state-focus")});c&&this.element.bind("change.button",function(){g.refresh()});if(this.type==="checkbox")this.buttonElement.bind("click.button",function(){if(d.disabled)return false;a(this).toggleClass("ui-state-active");g.buttonElement.attr("aria-pressed",g.element[0].checked)});else if(this.type==="radio")this.buttonElement.bind("click.button",
function(){if(d.disabled)return false;a(this).addClass("ui-state-active");g.buttonElement.attr("aria-pressed",true);var k=g.element[0];b(k).not(k).map(function(){return a(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed",false)});else{this.buttonElement.bind("mousedown.button",function(){if(d.disabled)return false;a(this).addClass("ui-state-active");f=this;a(document).one("mouseup",function(){f=null})}).bind("mouseup.button",function(){if(d.disabled)return false;a(this).removeClass("ui-state-active")}).bind("keydown.button",
function(k){if(d.disabled)return false;if(k.keyCode==a.ui.keyCode.SPACE||k.keyCode==a.ui.keyCode.ENTER)a(this).addClass("ui-state-active")}).bind("keyup.button",function(){a(this).removeClass("ui-state-active")});this.buttonElement.is("a")&&this.buttonElement.keyup(function(k){k.keyCode===a.ui.keyCode.SPACE&&a(this).click()})}this._setOption("disabled",d.disabled)},_determineButtonType:function(){this.type=this.element.is(":checkbox")?"checkbox":this.element.is(":radio")?"radio":this.element.is("input")?
"input":"button";if(this.type==="checkbox"||this.type==="radio"){this.buttonElement=this.element.parents().last().find("label[for="+this.element.attr("id")+"]");this.element.addClass("ui-helper-hidden-accessible");var g=this.element.is(":checked");g&&this.buttonElement.addClass("ui-state-active");this.buttonElement.attr("aria-pressed",g)}else this.buttonElement=this.element},widget:function(){return this.buttonElement},destroy:function(){this.element.removeClass("ui-helper-hidden-accessible");this.buttonElement.removeClass("ui-button ui-widget ui-state-default ui-corner-all ui-state-hover ui-state-active  ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only").removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html());
this.hasTitle||this.buttonElement.removeAttr("title");a.Widget.prototype.destroy.call(this)},_setOption:function(g,d){a.Widget.prototype._setOption.apply(this,arguments);if(g==="disabled")d?this.element.attr("disabled",true):this.element.removeAttr("disabled");this._resetButton()},refresh:function(){var g=this.element.is(":disabled");g!==this.options.disabled&&this._setOption("disabled",g);if(this.type==="radio")b(this.element[0]).each(function(){a(this).is(":checked")?a(this).button("widget").addClass("ui-state-active").attr("aria-pressed",
true):a(this).button("widget").removeClass("ui-state-active").attr("aria-pressed",false)});else if(this.type==="checkbox")this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed",true):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed",false)},_resetButton:function(){if(this.type==="input")this.options.label&&this.element.val(this.options.label);else{var g=this.buttonElement.removeClass("ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only"),
d=a("<span></span>").addClass("ui-button-text").html(this.options.label).appendTo(g.empty()).text(),c=this.options.icons,h=c.primary&&c.secondary;if(c.primary||c.secondary){g.addClass("ui-button-text-icon"+(h?"s":c.primary?"-primary":"-secondary"));c.primary&&g.prepend("<span class='ui-button-icon-primary ui-icon "+c.primary+"'></span>");c.secondary&&g.append("<span class='ui-button-icon-secondary ui-icon "+c.secondary+"'></span>");if(!this.options.text){g.addClass(h?"ui-button-icons-only":"ui-button-icon-only").removeClass("ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary");
this.hasTitle||g.attr("title",d)}}else g.addClass("ui-button-text-only")}}});a.widget("ui.buttonset",{_create:function(){this.element.addClass("ui-buttonset");this._init()},_init:function(){this.refresh()},_setOption:function(g,d){g==="disabled"&&this.buttons.button("option",g,d);a.Widget.prototype._setOption.apply(this,arguments)},refresh:function(){this.buttons=this.element.find(":button, :submit, :reset, :checkbox, :radio, a, :data(button)").filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return a(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass("ui-corner-left").end().filter(":last").addClass("ui-corner-right").end().end()},
destroy:function(){this.element.removeClass("ui-buttonset");this.buttons.map(function(){return a(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy");a.Widget.prototype.destroy.call(this)}})})(jQuery);
(function(a,f){function e(){this.debug=false;this._curInst=null;this._keyEvent=false;this._disabledInputs=[];this._inDialog=this._datepickerShowing=false;this._mainDivId="ui-datepicker-div";this._inlineClass="ui-datepicker-inline";this._appendClass="ui-datepicker-append";this._triggerClass="ui-datepicker-trigger";this._dialogClass="ui-datepicker-dialog";this._disableClass="ui-datepicker-disabled";this._unselectableClass="ui-datepicker-unselectable";this._currentClass="ui-datepicker-current-day";this._dayOverClass=
"ui-datepicker-days-cell-over";this.regional=[];this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su",
"Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:false,showMonthAfterYear:false,yearSuffix:""};this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:false,hideIfNoPrevNext:false,navigationAsDateFormat:false,gotoCurrent:false,changeMonth:false,changeYear:false,yearRange:"c-10:c+10",showOtherMonths:false,selectOtherMonths:false,showWeek:false,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",
minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:true,showButtonPanel:false,autoSize:false};a.extend(this._defaults,this.regional[""]);this.dpDiv=a('<div id="'+this._mainDivId+'" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all ui-helper-hidden-accessible"></div>')}function b(d,c){a.extend(d,
c);for(var h in c)if(c[h]==null||c[h]==f)d[h]=c[h];return d}a.extend(a.ui,{datepicker:{version:"1.8.3"}});var g=(new Date).getTime();a.extend(e.prototype,{markerClassName:"hasDatepicker",log:function(){this.debug&&console.log.apply("",arguments)},_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(d){b(this._defaults,d||{});return this},_attachDatepicker:function(d,c){var h=null,k;for(k in this._defaults){var l=d.getAttribute("date:"+k);if(l){h=h||{};try{h[k]=eval(l)}catch(o){h[k]=
l}}}k=d.nodeName.toLowerCase();l=k=="div"||k=="span";if(!d.id){this.uuid+=1;d.id="dp"+this.uuid}var n=this._newInst(a(d),l);n.settings=a.extend({},c||{},h||{});if(k=="input")this._connectDatepicker(d,n);else l&&this._inlineDatepicker(d,n)},_newInst:function(d,c){return{id:d[0].id.replace(/([^A-Za-z0-9_])/g,"\\\\$1"),input:d,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:c,dpDiv:!c?this.dpDiv:a('<div class="'+this._inlineClass+' ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>')}},
_connectDatepicker:function(d,c){var h=a(d);c.append=a([]);c.trigger=a([]);if(!h.hasClass(this.markerClassName)){this._attachments(h,c);h.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp).bind("setData.datepicker",function(k,l,o){c.settings[l]=o}).bind("getData.datepicker",function(k,l){return this._get(c,l)});this._autoSize(c);a.data(d,"datepicker",c)}},_attachments:function(d,c){var h=this._get(c,"appendText"),k=this._get(c,"isRTL");c.append&&
c.append.remove();if(h){c.append=a('<span class="'+this._appendClass+'">'+h+"</span>");d[k?"before":"after"](c.append)}d.unbind("focus",this._showDatepicker);c.trigger&&c.trigger.remove();h=this._get(c,"showOn");if(h=="focus"||h=="both")d.focus(this._showDatepicker);if(h=="button"||h=="both"){h=this._get(c,"buttonText");var l=this._get(c,"buttonImage");c.trigger=a(this._get(c,"buttonImageOnly")?a("<img/>").addClass(this._triggerClass).attr({src:l,alt:h,title:h}):a('<button type="button"></button>').addClass(this._triggerClass).html(l==
""?h:a("<img/>").attr({src:l,alt:h,title:h})));d[k?"before":"after"](c.trigger);c.trigger.click(function(){a.datepicker._datepickerShowing&&a.datepicker._lastInput==d[0]?a.datepicker._hideDatepicker():a.datepicker._showDatepicker(d[0]);return false})}},_autoSize:function(d){if(this._get(d,"autoSize")&&!d.inline){var c=new Date(2009,11,20),h=this._get(d,"dateFormat");if(h.match(/[DM]/)){var k=function(l){for(var o=0,n=0,m=0;m<l.length;m++)if(l[m].length>o){o=l[m].length;n=m}return n};c.setMonth(k(this._get(d,
h.match(/MM/)?"monthNames":"monthNamesShort")));c.setDate(k(this._get(d,h.match(/DD/)?"dayNames":"dayNamesShort"))+20-c.getDay())}d.input.attr("size",this._formatDate(d,c).length)}},_inlineDatepicker:function(d,c){var h=a(d);if(!h.hasClass(this.markerClassName)){h.addClass(this.markerClassName).append(c.dpDiv).bind("setData.datepicker",function(k,l,o){c.settings[l]=o}).bind("getData.datepicker",function(k,l){return this._get(c,l)});a.data(d,"datepicker",c);this._setDate(c,this._getDefaultDate(c),
true);this._updateDatepicker(c);this._updateAlternate(c)}},_dialogDatepicker:function(d,c,h,k,l){d=this._dialogInst;if(!d){this.uuid+=1;this._dialogInput=a('<input type="text" id="'+("dp"+this.uuid)+'" style="position: absolute; top: -100px; width: 0px; z-index: -10;"/>');this._dialogInput.keydown(this._doKeyDown);a("body").append(this._dialogInput);d=this._dialogInst=this._newInst(this._dialogInput,false);d.settings={};a.data(this._dialogInput[0],"datepicker",d)}b(d.settings,k||{});c=c&&c.constructor==
Date?this._formatDate(d,c):c;this._dialogInput.val(c);this._pos=l?l.length?l:[l.pageX,l.pageY]:null;if(!this._pos)this._pos=[document.documentElement.clientWidth/2-100+(document.documentElement.scrollLeft||document.body.scrollLeft),document.documentElement.clientHeight/2-150+(document.documentElement.scrollTop||document.body.scrollTop)];this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px");d.settings.onSelect=h;this._inDialog=true;this.dpDiv.addClass(this._dialogClass);this._showDatepicker(this._dialogInput[0]);
a.blockUI&&a.blockUI(this.dpDiv);a.data(this._dialogInput[0],"datepicker",d);return this},_destroyDatepicker:function(d){var c=a(d),h=a.data(d,"datepicker");if(c.hasClass(this.markerClassName)){var k=d.nodeName.toLowerCase();a.removeData(d,"datepicker");if(k=="input"){h.append.remove();h.trigger.remove();c.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)}else if(k=="div"||k=="span")c.removeClass(this.markerClassName).empty()}},
_enableDatepicker:function(d){var c=a(d),h=a.data(d,"datepicker");if(c.hasClass(this.markerClassName)){var k=d.nodeName.toLowerCase();if(k=="input"){d.disabled=false;h.trigger.filter("button").each(function(){this.disabled=false}).end().filter("img").css({opacity:"1.0",cursor:""})}else if(k=="div"||k=="span")c.children("."+this._inlineClass).children().removeClass("ui-state-disabled");this._disabledInputs=a.map(this._disabledInputs,function(l){return l==d?null:l})}},_disableDatepicker:function(d){var c=
a(d),h=a.data(d,"datepicker");if(c.hasClass(this.markerClassName)){var k=d.nodeName.toLowerCase();if(k=="input"){d.disabled=true;h.trigger.filter("button").each(function(){this.disabled=true}).end().filter("img").css({opacity:"0.5",cursor:"default"})}else if(k=="div"||k=="span")c.children("."+this._inlineClass).children().addClass("ui-state-disabled");this._disabledInputs=a.map(this._disabledInputs,function(l){return l==d?null:l});this._disabledInputs[this._disabledInputs.length]=d}},_isDisabledDatepicker:function(d){if(!d)return false;
for(var c=0;c<this._disabledInputs.length;c++)if(this._disabledInputs[c]==d)return true;return false},_getInst:function(d){try{return a.data(d,"datepicker")}catch(c){throw"Missing instance data for this datepicker";}},_optionDatepicker:function(d,c,h){var k=this._getInst(d);if(arguments.length==2&&typeof c=="string")return c=="defaults"?a.extend({},a.datepicker._defaults):k?c=="all"?a.extend({},k.settings):this._get(k,c):null;var l=c||{};if(typeof c=="string"){l={};l[c]=h}if(k){this._curInst==k&&
this._hideDatepicker();var o=this._getDateDatepicker(d,true);b(k.settings,l);this._attachments(a(d),k);this._autoSize(k);this._setDateDatepicker(d,o);this._updateDatepicker(k)}},_changeDatepicker:function(d,c,h){this._optionDatepicker(d,c,h)},_refreshDatepicker:function(d){(d=this._getInst(d))&&this._updateDatepicker(d)},_setDateDatepicker:function(d,c){if(d=this._getInst(d)){this._setDate(d,c);this._updateDatepicker(d);this._updateAlternate(d)}},_getDateDatepicker:function(d,c){(d=this._getInst(d))&&
!d.inline&&this._setDateFromField(d,c);return d?this._getDate(d):null},_doKeyDown:function(d){var c=a.datepicker._getInst(d.target),h=true,k=c.dpDiv.is(".ui-datepicker-rtl");c._keyEvent=true;if(a.datepicker._datepickerShowing)switch(d.keyCode){case 9:a.datepicker._hideDatepicker();h=false;break;case 13:h=a("td."+a.datepicker._dayOverClass,c.dpDiv).add(a("td."+a.datepicker._currentClass,c.dpDiv));h[0]?a.datepicker._selectDay(d.target,c.selectedMonth,c.selectedYear,h[0]):a.datepicker._hideDatepicker();
return false;case 27:a.datepicker._hideDatepicker();break;case 33:a.datepicker._adjustDate(d.target,d.ctrlKey?-a.datepicker._get(c,"stepBigMonths"):-a.datepicker._get(c,"stepMonths"),"M");break;case 34:a.datepicker._adjustDate(d.target,d.ctrlKey?+a.datepicker._get(c,"stepBigMonths"):+a.datepicker._get(c,"stepMonths"),"M");break;case 35:if(d.ctrlKey||d.metaKey)a.datepicker._clearDate(d.target);h=d.ctrlKey||d.metaKey;break;case 36:if(d.ctrlKey||d.metaKey)a.datepicker._gotoToday(d.target);h=d.ctrlKey||
d.metaKey;break;case 37:if(d.ctrlKey||d.metaKey)a.datepicker._adjustDate(d.target,k?+1:-1,"D");h=d.ctrlKey||d.metaKey;if(d.originalEvent.altKey)a.datepicker._adjustDate(d.target,d.ctrlKey?-a.datepicker._get(c,"stepBigMonths"):-a.datepicker._get(c,"stepMonths"),"M");break;case 38:if(d.ctrlKey||d.metaKey)a.datepicker._adjustDate(d.target,-7,"D");h=d.ctrlKey||d.metaKey;break;case 39:if(d.ctrlKey||d.metaKey)a.datepicker._adjustDate(d.target,k?-1:+1,"D");h=d.ctrlKey||d.metaKey;if(d.originalEvent.altKey)a.datepicker._adjustDate(d.target,
d.ctrlKey?+a.datepicker._get(c,"stepBigMonths"):+a.datepicker._get(c,"stepMonths"),"M");break;case 40:if(d.ctrlKey||d.metaKey)a.datepicker._adjustDate(d.target,+7,"D");h=d.ctrlKey||d.metaKey;break;default:h=false}else if(d.keyCode==36&&d.ctrlKey)a.datepicker._showDatepicker(this);else h=false;if(h){d.preventDefault();d.stopPropagation()}},_doKeyPress:function(d){var c=a.datepicker._getInst(d.target);if(a.datepicker._get(c,"constrainInput")){c=a.datepicker._possibleChars(a.datepicker._get(c,"dateFormat"));
var h=String.fromCharCode(d.charCode==f?d.keyCode:d.charCode);return d.ctrlKey||h<" "||!c||c.indexOf(h)>-1}},_doKeyUp:function(d){d=a.datepicker._getInst(d.target);if(d.input.val()!=d.lastVal)try{if(a.datepicker.parseDate(a.datepicker._get(d,"dateFormat"),d.input?d.input.val():null,a.datepicker._getFormatConfig(d))){a.datepicker._setDateFromField(d);a.datepicker._updateAlternate(d);a.datepicker._updateDatepicker(d)}}catch(c){a.datepicker.log(c)}return true},_showDatepicker:function(d){d=d.target||
d;if(d.nodeName.toLowerCase()!="input")d=a("input",d.parentNode)[0];if(!(a.datepicker._isDisabledDatepicker(d)||a.datepicker._lastInput==d)){var c=a.datepicker._getInst(d);a.datepicker._curInst&&a.datepicker._curInst!=c&&a.datepicker._curInst.dpDiv.stop(true,true);var h=a.datepicker._get(c,"beforeShow");b(c.settings,h?h.apply(d,[d,c]):{});c.lastVal=null;a.datepicker._lastInput=d;a.datepicker._setDateFromField(c);if(a.datepicker._inDialog)d.value="";if(!a.datepicker._pos){a.datepicker._pos=a.datepicker._findPos(d);
a.datepicker._pos[1]+=d.offsetHeight}var k=false;a(d).parents().each(function(){k|=a(this).css("position")=="fixed";return!k});if(k&&a.browser.opera){a.datepicker._pos[0]-=document.documentElement.scrollLeft;a.datepicker._pos[1]-=document.documentElement.scrollTop}h={left:a.datepicker._pos[0],top:a.datepicker._pos[1]};a.datepicker._pos=null;c.dpDiv.css({position:"absolute",display:"block",top:"-1000px"});a.datepicker._updateDatepicker(c);h=a.datepicker._checkOffset(c,h,k);c.dpDiv.css({position:a.datepicker._inDialog&&
a.blockUI?"static":k?"fixed":"absolute",display:"none",left:h.left+"px",top:h.top+"px"});if(!c.inline){h=a.datepicker._get(c,"showAnim");var l=a.datepicker._get(c,"duration"),o=function(){a.datepicker._datepickerShowing=true;var n=a.datepicker._getBorders(c.dpDiv);c.dpDiv.find("iframe.ui-datepicker-cover").css({left:-n[0],top:-n[1],width:c.dpDiv.outerWidth(),height:c.dpDiv.outerHeight()})};c.dpDiv.zIndex(a(d).zIndex()+1);a.effects&&a.effects[h]?c.dpDiv.show(h,a.datepicker._get(c,"showOptions"),l,
o):c.dpDiv[h||"show"](h?l:null,o);if(!h||!l)o();c.input.is(":visible")&&!c.input.is(":disabled")&&c.input.focus();a.datepicker._curInst=c}}},_updateDatepicker:function(d){var c=this,h=a.datepicker._getBorders(d.dpDiv);d.dpDiv.empty().append(this._generateHTML(d)).find("iframe.ui-datepicker-cover").css({left:-h[0],top:-h[1],width:d.dpDiv.outerWidth(),height:d.dpDiv.outerHeight()}).end().find("button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a").bind("mouseout",function(){a(this).removeClass("ui-state-hover");
this.className.indexOf("ui-datepicker-prev")!=-1&&a(this).removeClass("ui-datepicker-prev-hover");this.className.indexOf("ui-datepicker-next")!=-1&&a(this).removeClass("ui-datepicker-next-hover")}).bind("mouseover",function(){if(!c._isDisabledDatepicker(d.inline?d.dpDiv.parent()[0]:d.input[0])){a(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover");a(this).addClass("ui-state-hover");this.className.indexOf("ui-datepicker-prev")!=-1&&a(this).addClass("ui-datepicker-prev-hover");
this.className.indexOf("ui-datepicker-next")!=-1&&a(this).addClass("ui-datepicker-next-hover")}}).end().find("."+this._dayOverClass+" a").trigger("mouseover").end();h=this._getNumberOfMonths(d);var k=h[1];k>1?d.dpDiv.addClass("ui-datepicker-multi-"+k).css("width",17*k+"em"):d.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width("");d.dpDiv[(h[0]!=1||h[1]!=1?"add":"remove")+"Class"]("ui-datepicker-multi");d.dpDiv[(this._get(d,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl");
d==a.datepicker._curInst&&a.datepicker._datepickerShowing&&d.input&&d.input.is(":visible")&&!d.input.is(":disabled")&&d.input.focus()},_getBorders:function(d){var c=function(h){return{thin:1,medium:2,thick:3}[h]||h};return[parseFloat(c(d.css("border-left-width"))),parseFloat(c(d.css("border-top-width")))]},_checkOffset:function(d,c,h){var k=d.dpDiv.outerWidth(),l=d.dpDiv.outerHeight(),o=d.input?d.input.outerWidth():0,n=d.input?d.input.outerHeight():0,m=document.documentElement.clientWidth+a(document).scrollLeft(),
C=document.documentElement.clientHeight+a(document).scrollTop();c.left-=this._get(d,"isRTL")?k-o:0;c.left-=h&&c.left==d.input.offset().left?a(document).scrollLeft():0;c.top-=h&&c.top==d.input.offset().top+n?a(document).scrollTop():0;c.left-=Math.min(c.left,c.left+k>m&&m>k?Math.abs(c.left+k-m):0);c.top-=Math.min(c.top,c.top+l>C&&C>l?Math.abs(l+n):0);return c},_findPos:function(d){for(var c=this._get(this._getInst(d),"isRTL");d&&(d.type=="hidden"||d.nodeType!=1);)d=d[c?"previousSibling":"nextSibling"];
d=a(d).offset();return[d.left,d.top]},_hideDatepicker:function(d){var c=this._curInst;if(!(!c||d&&c!=a.data(d,"datepicker")))if(this._datepickerShowing){d=this._get(c,"showAnim");var h=this._get(c,"duration"),k=function(){a.datepicker._tidyDialog(c);this._curInst=null};a.effects&&a.effects[d]?c.dpDiv.hide(d,a.datepicker._get(c,"showOptions"),h,k):c.dpDiv[d=="slideDown"?"slideUp":d=="fadeIn"?"fadeOut":"hide"](d?h:null,k);d||k();if(d=this._get(c,"onClose"))d.apply(c.input?c.input[0]:null,[c.input?c.input.val():
"",c]);this._datepickerShowing=false;this._lastInput=null;if(this._inDialog){this._dialogInput.css({position:"absolute",left:"0",top:"-100px"});if(a.blockUI){a.unblockUI();a("body").append(this.dpDiv)}}this._inDialog=false}},_tidyDialog:function(d){d.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(d){if(a.datepicker._curInst){d=a(d.target);d[0].id!=a.datepicker._mainDivId&&d.parents("#"+a.datepicker._mainDivId).length==0&&!d.hasClass(a.datepicker.markerClassName)&&
!d.hasClass(a.datepicker._triggerClass)&&a.datepicker._datepickerShowing&&!(a.datepicker._inDialog&&a.blockUI)&&a.datepicker._hideDatepicker()}},_adjustDate:function(d,c,h){d=a(d);var k=this._getInst(d[0]);if(!this._isDisabledDatepicker(d[0])){this._adjustInstDate(k,c+(h=="M"?this._get(k,"showCurrentAtPos"):0),h);this._updateDatepicker(k)}},_gotoToday:function(d){d=a(d);var c=this._getInst(d[0]);if(this._get(c,"gotoCurrent")&&c.currentDay){c.selectedDay=c.currentDay;c.drawMonth=c.selectedMonth=c.currentMonth;
c.drawYear=c.selectedYear=c.currentYear}else{var h=new Date;c.selectedDay=h.getDate();c.drawMonth=c.selectedMonth=h.getMonth();c.drawYear=c.selectedYear=h.getFullYear()}this._notifyChange(c);this._adjustDate(d)},_selectMonthYear:function(d,c,h){d=a(d);var k=this._getInst(d[0]);k._selectingMonthYear=false;k["selected"+(h=="M"?"Month":"Year")]=k["draw"+(h=="M"?"Month":"Year")]=parseInt(c.options[c.selectedIndex].value,10);this._notifyChange(k);this._adjustDate(d)},_clickMonthYear:function(d){d=this._getInst(a(d)[0]);
d.input&&d._selectingMonthYear&&!a.browser.msie&&d.input.focus();d._selectingMonthYear=!d._selectingMonthYear},_selectDay:function(d,c,h,k){var l=a(d);if(!(a(k).hasClass(this._unselectableClass)||this._isDisabledDatepicker(l[0]))){l=this._getInst(l[0]);l.selectedDay=l.currentDay=a("a",k).html();l.selectedMonth=l.currentMonth=c;l.selectedYear=l.currentYear=h;this._selectDate(d,this._formatDate(l,l.currentDay,l.currentMonth,l.currentYear))}},_clearDate:function(d){d=a(d);this._getInst(d[0]);this._selectDate(d,
"")},_selectDate:function(d,c){d=this._getInst(a(d)[0]);c=c!=null?c:this._formatDate(d);d.input&&d.input.val(c);this._updateAlternate(d);var h=this._get(d,"onSelect");if(h)h.apply(d.input?d.input[0]:null,[c,d]);else d.input&&d.input.trigger("change");if(d.inline)this._updateDatepicker(d);else{this._hideDatepicker();this._lastInput=d.input[0];typeof d.input[0]!="object"&&d.input.focus();this._lastInput=null}},_updateAlternate:function(d){var c=this._get(d,"altField");if(c){var h=this._get(d,"altFormat")||
this._get(d,"dateFormat"),k=this._getDate(d),l=this.formatDate(h,k,this._getFormatConfig(d));a(c).each(function(){a(this).val(l)})}},noWeekends:function(d){d=d.getDay();return[d>0&&d<6,""]},iso8601Week:function(d){d=new Date(d.getTime());d.setDate(d.getDate()+4-(d.getDay()||7));var c=d.getTime();d.setMonth(0);d.setDate(1);return Math.floor(Math.round((c-d)/864E5)/7)+1},parseDate:function(d,c,h){if(d==null||c==null)throw"Invalid arguments";c=typeof c=="object"?c.toString():c+"";if(c=="")return null;
for(var k=(h?h.shortYearCutoff:null)||this._defaults.shortYearCutoff,l=(h?h.dayNamesShort:null)||this._defaults.dayNamesShort,o=(h?h.dayNames:null)||this._defaults.dayNames,n=(h?h.monthNamesShort:null)||this._defaults.monthNamesShort,m=(h?h.monthNames:null)||this._defaults.monthNames,C=h=-1,I=-1,H=-1,G=false,P=function(aa){(aa=V+1<d.length&&d.charAt(V+1)==aa)&&V++;return aa},Q=function(aa){P(aa);aa=RegExp("^\\d{1,"+(aa=="@"?14:aa=="!"?20:aa=="y"?4:aa=="o"?3:2)+"}");aa=c.substring(ja).match(aa);if(!aa)throw"Missing number at position "+
ja;ja+=aa[0].length;return parseInt(aa[0],10)},N=function(aa,sa,ka){aa=P(aa)?ka:sa;for(sa=0;sa<aa.length;sa++)if(c.substr(ja,aa[sa].length)==aa[sa]){ja+=aa[sa].length;return sa+1}throw"Unknown name at position "+ja;},ba=function(){if(c.charAt(ja)!=d.charAt(V))throw"Unexpected literal at position "+ja;ja++},ja=0,V=0;V<d.length;V++)if(G)if(d.charAt(V)=="'"&&!P("'"))G=false;else ba();else switch(d.charAt(V)){case "d":I=Q("d");break;case "D":N("D",l,o);break;case "o":H=Q("o");break;case "m":C=Q("m");
break;case "M":C=N("M",n,m);break;case "y":h=Q("y");break;case "@":var T=new Date(Q("@"));h=T.getFullYear();C=T.getMonth()+1;I=T.getDate();break;case "!":T=new Date((Q("!")-this._ticksTo1970)/1E4);h=T.getFullYear();C=T.getMonth()+1;I=T.getDate();break;case "'":if(P("'"))ba();else G=true;break;default:ba()}if(h==-1)h=(new Date).getFullYear();else if(h<100)h+=(new Date).getFullYear()-(new Date).getFullYear()%100+(h<=k?0:-100);if(H>-1){C=1;I=H;do{k=this._getDaysInMonth(h,C-1);if(I<=k)break;C++;I-=k}while(1)}T=
this._daylightSavingAdjust(new Date(h,C-1,I));if(T.getFullYear()!=h||T.getMonth()+1!=C||T.getDate()!=I)throw"Invalid date";return T},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*24*60*60*1E7,formatDate:function(d,c,h){if(!c)return"";var k=(h?h.dayNamesShort:null)||
this._defaults.dayNamesShort,l=(h?h.dayNames:null)||this._defaults.dayNames,o=(h?h.monthNamesShort:null)||this._defaults.monthNamesShort;h=(h?h.monthNames:null)||this._defaults.monthNames;var n=function(P){(P=G+1<d.length&&d.charAt(G+1)==P)&&G++;return P},m=function(P,Q,N){Q=""+Q;if(n(P))for(;Q.length<N;)Q="0"+Q;return Q},C=function(P,Q,N,ba){return n(P)?ba[Q]:N[Q]},I="",H=false;if(c)for(var G=0;G<d.length;G++)if(H)if(d.charAt(G)=="'"&&!n("'"))H=false;else I+=d.charAt(G);else switch(d.charAt(G)){case "d":I+=
m("d",c.getDate(),2);break;case "D":I+=C("D",c.getDay(),k,l);break;case "o":I+=m("o",(c.getTime()-(new Date(c.getFullYear(),0,0)).getTime())/864E5,3);break;case "m":I+=m("m",c.getMonth()+1,2);break;case "M":I+=C("M",c.getMonth(),o,h);break;case "y":I+=n("y")?c.getFullYear():(c.getYear()%100<10?"0":"")+c.getYear()%100;break;case "@":I+=c.getTime();break;case "!":I+=c.getTime()*1E4+this._ticksTo1970;break;case "'":if(n("'"))I+="'";else H=true;break;default:I+=d.charAt(G)}return I},_possibleChars:function(d){for(var c=
"",h=false,k=function(o){(o=l+1<d.length&&d.charAt(l+1)==o)&&l++;return o},l=0;l<d.length;l++)if(h)if(d.charAt(l)=="'"&&!k("'"))h=false;else c+=d.charAt(l);else switch(d.charAt(l)){case "d":case "m":case "y":case "@":c+="0123456789";break;case "D":case "M":return null;case "'":if(k("'"))c+="'";else h=true;break;default:c+=d.charAt(l)}return c},_get:function(d,c){return d.settings[c]!==f?d.settings[c]:this._defaults[c]},_setDateFromField:function(d,c){if(d.input.val()!=d.lastVal){var h=this._get(d,
"dateFormat"),k=d.lastVal=d.input?d.input.val():null,l,o;l=o=this._getDefaultDate(d);var n=this._getFormatConfig(d);try{l=this.parseDate(h,k,n)||o}catch(m){this.log(m);k=c?"":k}d.selectedDay=l.getDate();d.drawMonth=d.selectedMonth=l.getMonth();d.drawYear=d.selectedYear=l.getFullYear();d.currentDay=k?l.getDate():0;d.currentMonth=k?l.getMonth():0;d.currentYear=k?l.getFullYear():0;this._adjustInstDate(d)}},_getDefaultDate:function(d){return this._restrictMinMax(d,this._determineDate(d,this._get(d,"defaultDate"),
new Date))},_determineDate:function(d,c,h){var k=function(o){var n=new Date;n.setDate(n.getDate()+o);return n},l=function(o){try{return a.datepicker.parseDate(a.datepicker._get(d,"dateFormat"),o,a.datepicker._getFormatConfig(d))}catch(n){}var m=(o.toLowerCase().match(/^c/)?a.datepicker._getDate(d):null)||new Date,C=m.getFullYear(),I=m.getMonth();m=m.getDate();for(var H=/([+-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,G=H.exec(o);G;){switch(G[2]||"d"){case "d":case "D":m+=parseInt(G[1],10);break;case "w":case "W":m+=
parseInt(G[1],10)*7;break;case "m":case "M":I+=parseInt(G[1],10);m=Math.min(m,a.datepicker._getDaysInMonth(C,I));break;case "y":case "Y":C+=parseInt(G[1],10);m=Math.min(m,a.datepicker._getDaysInMonth(C,I))}G=H.exec(o)}return new Date(C,I,m)};if(c=(c=c==null?h:typeof c=="string"?l(c):typeof c=="number"?isNaN(c)?h:k(c):c)&&c.toString()=="Invalid Date"?h:c){c.setHours(0);c.setMinutes(0);c.setSeconds(0);c.setMilliseconds(0)}return this._daylightSavingAdjust(c)},_daylightSavingAdjust:function(d){if(!d)return null;
d.setHours(d.getHours()>12?d.getHours()+2:0);return d},_setDate:function(d,c,h){var k=!c,l=d.selectedMonth,o=d.selectedYear;c=this._restrictMinMax(d,this._determineDate(d,c,new Date));d.selectedDay=d.currentDay=c.getDate();d.drawMonth=d.selectedMonth=d.currentMonth=c.getMonth();d.drawYear=d.selectedYear=d.currentYear=c.getFullYear();if((l!=d.selectedMonth||o!=d.selectedYear)&&!h)this._notifyChange(d);this._adjustInstDate(d);if(d.input)d.input.val(k?"":this._formatDate(d))},_getDate:function(d){return!d.currentYear||
d.input&&d.input.val()==""?null:this._daylightSavingAdjust(new Date(d.currentYear,d.currentMonth,d.currentDay))},_generateHTML:function(d){var c=new Date;c=this._daylightSavingAdjust(new Date(c.getFullYear(),c.getMonth(),c.getDate()));var h=this._get(d,"isRTL"),k=this._get(d,"showButtonPanel"),l=this._get(d,"hideIfNoPrevNext"),o=this._get(d,"navigationAsDateFormat"),n=this._getNumberOfMonths(d),m=this._get(d,"showCurrentAtPos"),C=this._get(d,"stepMonths"),I=n[0]!=1||n[1]!=1,H=this._daylightSavingAdjust(!d.currentDay?
new Date(9999,9,9):new Date(d.currentYear,d.currentMonth,d.currentDay)),G=this._getMinMaxDate(d,"min"),P=this._getMinMaxDate(d,"max");m=d.drawMonth-m;var Q=d.drawYear;if(m<0){m+=12;Q--}if(P){var N=this._daylightSavingAdjust(new Date(P.getFullYear(),P.getMonth()-n[0]*n[1]+1,P.getDate()));for(N=G&&N<G?G:N;this._daylightSavingAdjust(new Date(Q,m,1))>N;){m--;if(m<0){m=11;Q--}}}d.drawMonth=m;d.drawYear=Q;N=this._get(d,"prevText");N=!o?N:this.formatDate(N,this._daylightSavingAdjust(new Date(Q,m-C,1)),this._getFormatConfig(d));
N=this._canAdjustMonth(d,-1,Q,m)?'<a class="ui-datepicker-prev ui-corner-all" onclick="DP_jQuery_'+g+".datepicker._adjustDate('#"+d.id+"', -"+C+", 'M');\" title=\""+N+'"><span class="ui-icon ui-icon-circle-triangle-'+(h?"e":"w")+'">'+N+"</span></a>":l?"":'<a class="ui-datepicker-prev ui-corner-all ui-state-disabled" title="'+N+'"><span class="ui-icon ui-icon-circle-triangle-'+(h?"e":"w")+'">'+N+"</span></a>";var ba=this._get(d,"nextText");ba=!o?ba:this.formatDate(ba,this._daylightSavingAdjust(new Date(Q,
m+C,1)),this._getFormatConfig(d));l=this._canAdjustMonth(d,+1,Q,m)?'<a class="ui-datepicker-next ui-corner-all" onclick="DP_jQuery_'+g+".datepicker._adjustDate('#"+d.id+"', +"+C+", 'M');\" title=\""+ba+'"><span class="ui-icon ui-icon-circle-triangle-'+(h?"w":"e")+'">'+ba+"</span></a>":l?"":'<a class="ui-datepicker-next ui-corner-all ui-state-disabled" title="'+ba+'"><span class="ui-icon ui-icon-circle-triangle-'+(h?"w":"e")+'">'+ba+"</span></a>";C=this._get(d,"currentText");ba=this._get(d,"gotoCurrent")&&
d.currentDay?H:c;C=!o?C:this.formatDate(C,ba,this._getFormatConfig(d));o=!d.inline?'<button type="button" class="ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all" onclick="DP_jQuery_'+g+'.datepicker._hideDatepicker();">'+this._get(d,"closeText")+"</button>":"";k=k?'<div class="ui-datepicker-buttonpane ui-widget-content">'+(h?o:"")+(this._isInRange(d,ba)?'<button type="button" class="ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all" onclick="DP_jQuery_'+
g+".datepicker._gotoToday('#"+d.id+"');\">"+C+"</button>":"")+(h?"":o)+"</div>":"";o=parseInt(this._get(d,"firstDay"),10);o=isNaN(o)?0:o;C=this._get(d,"showWeek");ba=this._get(d,"dayNames");this._get(d,"dayNamesShort");var ja=this._get(d,"dayNamesMin"),V=this._get(d,"monthNames"),T=this._get(d,"monthNamesShort"),aa=this._get(d,"beforeShowDay"),sa=this._get(d,"showOtherMonths"),ka=this._get(d,"selectOtherMonths");this._get(d,"calculateWeek");for(var ea=this._getDefaultDate(d),U="",Y=0;Y<n[0];Y++){for(var oa=
"",pa=0;pa<n[1];pa++){var na=this._daylightSavingAdjust(new Date(Q,m,d.selectedDay)),ia=" ui-corner-all",ta="";if(I){ta+='<div class="ui-datepicker-group';if(n[1]>1)switch(pa){case 0:ta+=" ui-datepicker-group-first";ia=" ui-corner-"+(h?"right":"left");break;case n[1]-1:ta+=" ui-datepicker-group-last";ia=" ui-corner-"+(h?"left":"right");break;default:ta+=" ui-datepicker-group-middle";ia=""}ta+='">'}ta+='<div class="ui-datepicker-header ui-widget-header ui-helper-clearfix'+ia+'">'+(/all|left/.test(ia)&&
Y==0?h?l:N:"")+(/all|right/.test(ia)&&Y==0?h?N:l:"")+this._generateMonthYearHeader(d,m,Q,G,P,Y>0||pa>0,V,T)+'</div><table class="ui-datepicker-calendar"><thead><tr>';var wa=C?'<th class="ui-datepicker-week-col">'+this._get(d,"weekHeader")+"</th>":"";for(ia=0;ia<7;ia++){var ra=(ia+o)%7;wa+="<th"+((ia+o+6)%7>=5?' class="ui-datepicker-week-end"':"")+'><span title="'+ba[ra]+'">'+ja[ra]+"</span></th>"}ta+=wa+"</tr></thead><tbody>";wa=this._getDaysInMonth(Q,m);if(Q==d.selectedYear&&m==d.selectedMonth)d.selectedDay=
Math.min(d.selectedDay,wa);ia=(this._getFirstDayOfMonth(Q,m)-o+7)%7;wa=I?6:Math.ceil((ia+wa)/7);ra=this._daylightSavingAdjust(new Date(Q,m,1-ia));for(var Ha=0;Ha<wa;Ha++){ta+="<tr>";var Da=!C?"":'<td class="ui-datepicker-week-col">'+this._get(d,"calculateWeek")(ra)+"</td>";for(ia=0;ia<7;ia++){var Ka=aa?aa.apply(d.input?d.input[0]:null,[ra]):[true,""],Aa=ra.getMonth()!=m,xa=Aa&&!ka||!Ka[0]||G&&ra<G||P&&ra>P;Da+='<td class="'+((ia+o+6)%7>=5?" ui-datepicker-week-end":"")+(Aa?" ui-datepicker-other-month":
"")+(ra.getTime()==na.getTime()&&m==d.selectedMonth&&d._keyEvent||ea.getTime()==ra.getTime()&&ea.getTime()==na.getTime()?" "+this._dayOverClass:"")+(xa?" "+this._unselectableClass+" ui-state-disabled":"")+(Aa&&!sa?"":" "+Ka[1]+(ra.getTime()==H.getTime()?" "+this._currentClass:"")+(ra.getTime()==c.getTime()?" ui-datepicker-today":""))+'"'+((!Aa||sa)&&Ka[2]?' title="'+Ka[2]+'"':"")+(xa?"":' onclick="DP_jQuery_'+g+".datepicker._selectDay('#"+d.id+"',"+ra.getMonth()+","+ra.getFullYear()+', this);return false;"')+
">"+(Aa&&!sa?"&#xa0;":xa?'<span class="ui-state-default">'+ra.getDate()+"</span>":'<a class="ui-state-default'+(ra.getTime()==c.getTime()?" ui-state-highlight":"")+(ra.getTime()==na.getTime()?" ui-state-active":"")+(Aa?" ui-priority-secondary":"")+'" href="#">'+ra.getDate()+"</a>")+"</td>";ra.setDate(ra.getDate()+1);ra=this._daylightSavingAdjust(ra)}ta+=Da+"</tr>"}m++;if(m>11){m=0;Q++}ta+="</tbody></table>"+(I?"</div>"+(n[0]>0&&pa==n[1]-1?'<div class="ui-datepicker-row-break"></div>':""):"");oa+=
ta}U+=oa}U+=k+(a.browser.msie&&parseInt(a.browser.version,10)<7&&!d.inline?'<iframe src="javascript:false;" class="ui-datepicker-cover" frameborder="0"></iframe>':"");d._keyEvent=false;return U},_generateMonthYearHeader:function(d,c,h,k,l,o,n,m){var C=this._get(d,"changeMonth"),I=this._get(d,"changeYear"),H=this._get(d,"showMonthAfterYear"),G='<div class="ui-datepicker-title">',P="";if(o||!C)P+='<span class="ui-datepicker-month">'+n[c]+"</span>";else{n=k&&k.getFullYear()==h;var Q=l&&l.getFullYear()==
h;P+='<select class="ui-datepicker-month" onchange="DP_jQuery_'+g+".datepicker._selectMonthYear('#"+d.id+"', this, 'M');\" onclick=\"DP_jQuery_"+g+".datepicker._clickMonthYear('#"+d.id+"');\">";for(var N=0;N<12;N++)if((!n||N>=k.getMonth())&&(!Q||N<=l.getMonth()))P+='<option value="'+N+'"'+(N==c?' selected="selected"':"")+">"+m[N]+"</option>";P+="</select>"}H||(G+=P+(o||!(C&&I)?"&#xa0;":""));if(o||!I)G+='<span class="ui-datepicker-year">'+h+"</span>";else{m=this._get(d,"yearRange").split(":");var ba=
(new Date).getFullYear();n=function(ja){ja=ja.match(/c[+-].*/)?h+parseInt(ja.substring(1),10):ja.match(/[+-].*/)?ba+parseInt(ja,10):parseInt(ja,10);return isNaN(ja)?ba:ja};c=n(m[0]);m=Math.max(c,n(m[1]||""));c=k?Math.max(c,k.getFullYear()):c;m=l?Math.min(m,l.getFullYear()):m;for(G+='<select class="ui-datepicker-year" onchange="DP_jQuery_'+g+".datepicker._selectMonthYear('#"+d.id+"', this, 'Y');\" onclick=\"DP_jQuery_"+g+".datepicker._clickMonthYear('#"+d.id+"');\">";c<=m;c++)G+='<option value="'+
c+'"'+(c==h?' selected="selected"':"")+">"+c+"</option>";G+="</select>"}G+=this._get(d,"yearSuffix");if(H)G+=(o||!(C&&I)?"&#xa0;":"")+P;G+="</div>";return G},_adjustInstDate:function(d,c,h){var k=d.drawYear+(h=="Y"?c:0),l=d.drawMonth+(h=="M"?c:0);c=Math.min(d.selectedDay,this._getDaysInMonth(k,l))+(h=="D"?c:0);k=this._restrictMinMax(d,this._daylightSavingAdjust(new Date(k,l,c)));d.selectedDay=k.getDate();d.drawMonth=d.selectedMonth=k.getMonth();d.drawYear=d.selectedYear=k.getFullYear();if(h=="M"||
h=="Y")this._notifyChange(d)},_restrictMinMax:function(d,c){var h=this._getMinMaxDate(d,"min");d=this._getMinMaxDate(d,"max");c=h&&c<h?h:c;return d&&c>d?d:c},_notifyChange:function(d){var c=this._get(d,"onChangeMonthYear");if(c)c.apply(d.input?d.input[0]:null,[d.selectedYear,d.selectedMonth+1,d])},_getNumberOfMonths:function(d){d=this._get(d,"numberOfMonths");return d==null?[1,1]:typeof d=="number"?[1,d]:d},_getMinMaxDate:function(d,c){return this._determineDate(d,this._get(d,c+"Date"),null)},_getDaysInMonth:function(d,
c){return 32-(new Date(d,c,32)).getDate()},_getFirstDayOfMonth:function(d,c){return(new Date(d,c,1)).getDay()},_canAdjustMonth:function(d,c,h,k){var l=this._getNumberOfMonths(d);h=this._daylightSavingAdjust(new Date(h,k+(c<0?c:l[0]*l[1]),1));c<0&&h.setDate(this._getDaysInMonth(h.getFullYear(),h.getMonth()));return this._isInRange(d,h)},_isInRange:function(d,c){var h=this._getMinMaxDate(d,"min");d=this._getMinMaxDate(d,"max");return(!h||c.getTime()>=h.getTime())&&(!d||c.getTime()<=d.getTime())},_getFormatConfig:function(d){var c=
this._get(d,"shortYearCutoff");c=typeof c!="string"?c:(new Date).getFullYear()%100+parseInt(c,10);return{shortYearCutoff:c,dayNamesShort:this._get(d,"dayNamesShort"),dayNames:this._get(d,"dayNames"),monthNamesShort:this._get(d,"monthNamesShort"),monthNames:this._get(d,"monthNames")}},_formatDate:function(d,c,h,k){if(!c){d.currentDay=d.selectedDay;d.currentMonth=d.selectedMonth;d.currentYear=d.selectedYear}c=c?typeof c=="object"?c:this._daylightSavingAdjust(new Date(k,h,c)):this._daylightSavingAdjust(new Date(d.currentYear,
d.currentMonth,d.currentDay));return this.formatDate(this._get(d,"dateFormat"),c,this._getFormatConfig(d))}});a.fn.datepicker=function(d){if(!a.datepicker.initialized){a(document).mousedown(a.datepicker._checkExternalClick).find("body").append(a.datepicker.dpDiv);a.datepicker.initialized=true}var c=Array.prototype.slice.call(arguments,1);if(typeof d=="string"&&(d=="isDisabled"||d=="getDate"||d=="widget"))return a.datepicker["_"+d+"Datepicker"].apply(a.datepicker,[this[0]].concat(c));if(d=="option"&&
arguments.length==2&&typeof arguments[1]=="string")return a.datepicker["_"+d+"Datepicker"].apply(a.datepicker,[this[0]].concat(c));return this.each(function(){typeof d=="string"?a.datepicker["_"+d+"Datepicker"].apply(a.datepicker,[this].concat(c)):a.datepicker._attachDatepicker(this,d)})};a.datepicker=new e;a.datepicker.initialized=false;a.datepicker.uuid=(new Date).getTime();a.datepicker.version="1.8.3";window["DP_jQuery_"+g]=a})(jQuery);
(function(a,f){a.widget("ui.dialog",{options:{autoOpen:true,buttons:{},closeOnEscape:true,closeText:"close",dialogClass:"",draggable:true,hide:null,height:"auto",maxHeight:false,maxWidth:false,minHeight:150,minWidth:150,modal:false,position:{my:"center",at:"center",of:window,collision:"fit",using:function(e){var b=a(this).css(e).offset().top;b<0&&a(this).css("top",e.top-b)}},resizable:true,show:null,stack:true,title:"",width:300,zIndex:1E3},_create:function(){this.originalTitle=this.element.attr("title");
if(typeof this.originalTitle!=="string")this.originalTitle="";var e=this,b=e.options,g=b.title||e.originalTitle||"&#160;",d=a.ui.dialog.getTitleId(e.element),c=(e.uiDialog=a("<div></div>")).appendTo(document.body).hide().addClass("ui-dialog ui-widget ui-widget-content ui-corner-all "+b.dialogClass).css({zIndex:b.zIndex}).attr("tabIndex",-1).css("outline",0).keydown(function(l){if(b.closeOnEscape&&l.keyCode&&l.keyCode===a.ui.keyCode.ESCAPE){e.close(l);l.preventDefault()}}).attr({role:"dialog","aria-labelledby":d}).mousedown(function(l){e.moveToTop(false,
l)});e.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(c);var h=(e.uiDialogTitlebar=a("<div></div>")).addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(c),k=a('<a href="#"></a>').addClass("ui-dialog-titlebar-close ui-corner-all").attr("role","button").hover(function(){k.addClass("ui-state-hover")},function(){k.removeClass("ui-state-hover")}).focus(function(){k.addClass("ui-state-focus")}).blur(function(){k.removeClass("ui-state-focus")}).click(function(l){e.close(l);
return false}).appendTo(h);(e.uiDialogTitlebarCloseText=a("<span></span>")).addClass("ui-icon ui-icon-closethick").text(b.closeText).appendTo(k);a("<span></span>").addClass("ui-dialog-title").attr("id",d).html(g).prependTo(h);if(a.isFunction(b.beforeclose)&&!a.isFunction(b.beforeClose))b.beforeClose=b.beforeclose;h.find("*").add(h).disableSelection();b.draggable&&a.fn.draggable&&e._makeDraggable();b.resizable&&a.fn.resizable&&e._makeResizable();e._createButtons(b.buttons);e._isOpen=false;a.fn.bgiframe&&
c.bgiframe()},_init:function(){this.options.autoOpen&&this.open()},destroy:function(){this.overlay&&this.overlay.destroy();this.uiDialog.hide();this.element.unbind(".dialog").removeData("dialog").removeClass("ui-dialog-content ui-widget-content").hide().appendTo("body");this.uiDialog.remove();this.originalTitle&&this.element.attr("title",this.originalTitle);return this},widget:function(){return this.uiDialog},close:function(e){var b=this,g;if(false!==b._trigger("beforeClose",e)){b.overlay&&b.overlay.destroy();
b.uiDialog.unbind("keypress.ui-dialog");b._isOpen=false;if(b.options.hide)b.uiDialog.hide(b.options.hide,function(){b._trigger("close",e)});else{b.uiDialog.hide();b._trigger("close",e)}a.ui.dialog.overlay.resize();if(b.options.modal){g=0;a(".ui-dialog").each(function(){if(this!==b.uiDialog[0])g=Math.max(g,a(this).css("z-index"))});a.ui.dialog.maxZ=g}return b}},isOpen:function(){return this._isOpen},moveToTop:function(e,b){var g=this.options;if(g.modal&&!e||!g.stack&&!g.modal)return this._trigger("focus",
b);if(g.zIndex>a.ui.dialog.maxZ)a.ui.dialog.maxZ=g.zIndex;if(this.overlay){a.ui.dialog.maxZ+=1;this.overlay.$el.css("z-index",a.ui.dialog.overlay.maxZ=a.ui.dialog.maxZ)}e={scrollTop:this.element.attr("scrollTop"),scrollLeft:this.element.attr("scrollLeft")};a.ui.dialog.maxZ+=1;this.uiDialog.css("z-index",a.ui.dialog.maxZ);this.element.attr(e);this._trigger("focus",b);return this},open:function(){if(!this._isOpen){var e=this.options,b=this.uiDialog;this.overlay=e.modal?new a.ui.dialog.overlay(this):
null;b.next().length&&b.appendTo("body");this._size();this._position(e.position);b.show(e.show);this.moveToTop(true);e.modal&&b.bind("keypress.ui-dialog",function(g){if(g.keyCode===a.ui.keyCode.TAB){var d=a(":tabbable",this),c=d.filter(":first");d=d.filter(":last");if(g.target===d[0]&&!g.shiftKey){c.focus(1);return false}else if(g.target===c[0]&&g.shiftKey){d.focus(1);return false}}});a(this.element.find(":tabbable").get().concat(b.find(".ui-dialog-buttonpane :tabbable").get().concat(b.get()))).eq(0).focus();
this._trigger("open");this._isOpen=true;return this}},_createButtons:function(e){var b=this,g=false,d=a("<div></div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),c=a("<div></div>").addClass("ui-dialog-buttonset").appendTo(d);b.uiDialog.find(".ui-dialog-buttonpane").remove();typeof e==="object"&&e!==null&&a.each(e,function(){return!(g=true)});if(g){a.each(e,function(h,k){h=a('<button type="button"></button>').text(h).click(function(){k.apply(b.element[0],arguments)}).appendTo(c);
a.fn.button&&h.button()});d.appendTo(b.uiDialog)}},_makeDraggable:function(){function e(h){return{position:h.position,offset:h.offset}}var b=this,g=b.options,d=a(document),c;b.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(h,k){c=g.height==="auto"?"auto":a(this).height();a(this).height(a(this).height()).addClass("ui-dialog-dragging");b._trigger("dragStart",h,e(k))},drag:function(h,k){b._trigger("drag",h,
e(k))},stop:function(h,k){g.position=[k.position.left-d.scrollLeft(),k.position.top-d.scrollTop()];a(this).removeClass("ui-dialog-dragging").height(c);b._trigger("dragStop",h,e(k));a.ui.dialog.overlay.resize()}})},_makeResizable:function(e){function b(h){return{originalPosition:h.originalPosition,originalSize:h.originalSize,position:h.position,size:h.size}}e=e===f?this.options.resizable:e;var g=this,d=g.options,c=g.uiDialog.css("position");e=typeof e==="string"?e:"n,e,s,w,se,sw,ne,nw";g.uiDialog.resizable({cancel:".ui-dialog-content",
containment:"document",alsoResize:g.element,maxWidth:d.maxWidth,maxHeight:d.maxHeight,minWidth:d.minWidth,minHeight:g._minHeight(),handles:e,start:function(h,k){a(this).addClass("ui-dialog-resizing");g._trigger("resizeStart",h,b(k))},resize:function(h,k){g._trigger("resize",h,b(k))},stop:function(h,k){a(this).removeClass("ui-dialog-resizing");d.height=a(this).height();d.width=a(this).width();g._trigger("resizeStop",h,b(k));a.ui.dialog.overlay.resize()}}).css("position",c).find(".ui-resizable-se").addClass("ui-icon ui-icon-grip-diagonal-se")},
_minHeight:function(){var e=this.options;return e.height==="auto"?e.minHeight:Math.min(e.minHeight,e.height)},_position:function(e){var b=[],g=[0,0],d;if(e){if(typeof e==="string"||typeof e==="object"&&"0"in e){b=e.split?e.split(" "):[e[0],e[1]];if(b.length===1)b[1]=b[0];a.each(["left","top"],function(c,h){if(+b[c]===b[c]){g[c]=b[c];b[c]=h}});e={my:b.join(" "),at:b.join(" "),offset:g.join(" ")}}e=a.extend({},a.ui.dialog.prototype.options.position,e)}else e=a.ui.dialog.prototype.options.position;(d=
this.uiDialog.is(":visible"))||this.uiDialog.show();this.uiDialog.css({top:0,left:0}).position(e);d||this.uiDialog.hide()},_setOption:function(e,b){var g=this.uiDialog,d=g.is(":data(resizable)"),c=false;switch(e){case "beforeclose":e="beforeClose";break;case "buttons":this._createButtons(b);c=true;break;case "closeText":this.uiDialogTitlebarCloseText.text(""+b);break;case "dialogClass":g.removeClass(this.options.dialogClass).addClass("ui-dialog ui-widget ui-widget-content ui-corner-all "+b);break;
case "disabled":b?g.addClass("ui-dialog-disabled"):g.removeClass("ui-dialog-disabled");break;case "draggable":b?this._makeDraggable():g.draggable("destroy");break;case "height":c=true;break;case "maxHeight":d&&g.resizable("option","maxHeight",b);c=true;break;case "maxWidth":d&&g.resizable("option","maxWidth",b);c=true;break;case "minHeight":d&&g.resizable("option","minHeight",b);c=true;break;case "minWidth":d&&g.resizable("option","minWidth",b);c=true;break;case "position":this._position(b);break;
case "resizable":d&&!b&&g.resizable("destroy");d&&typeof b==="string"&&g.resizable("option","handles",b);!d&&b!==false&&this._makeResizable(b);break;case "title":a(".ui-dialog-title",this.uiDialogTitlebar).html(""+(b||"&#160;"));break;case "width":c=true}a.Widget.prototype._setOption.apply(this,arguments);c&&this._size()},_size:function(){var e=this.options,b;this.element.css({width:"auto",minHeight:0,height:0});if(e.minWidth>e.width)e.width=e.minWidth;b=this.uiDialog.css({height:"auto",width:e.width}).height();
this.element.css(e.height==="auto"?{minHeight:Math.max(e.minHeight-b,0),height:"auto"}:{minHeight:0,height:Math.max(e.height-b,0)}).show();this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())}});a.extend(a.ui.dialog,{version:"1.8.3",uuid:0,maxZ:0,getTitleId:function(e){e=e.attr("id");if(!e){this.uuid+=1;e=this.uuid}return"ui-dialog-title-"+e},overlay:function(e){this.$el=a.ui.dialog.overlay.create(e)}});a.extend(a.ui.dialog.overlay,{instances:[],oldInstances:[],
maxZ:0,events:a.map("focus,mousedown,mouseup,keydown,keypress,click".split(","),function(e){return e+".dialog-overlay"}).join(" "),create:function(e){if(this.instances.length===0){setTimeout(function(){a.ui.dialog.overlay.instances.length&&a(document).bind(a.ui.dialog.overlay.events,function(g){return a(g.target).zIndex()>=a.ui.dialog.overlay.maxZ})},1);a(document).bind("keydown.dialog-overlay",function(g){if(e.options.closeOnEscape&&g.keyCode&&g.keyCode===a.ui.keyCode.ESCAPE){e.close(g);g.preventDefault()}});
a(window).bind("resize.dialog-overlay",a.ui.dialog.overlay.resize)}var b=(this.oldInstances.pop()||a("<div></div>").addClass("ui-widget-overlay")).appendTo(document.body).css({width:this.width(),height:this.height()});a.fn.bgiframe&&b.bgiframe();this.instances.push(b);return b},destroy:function(e){this.oldInstances.push(this.instances.splice(a.inArray(e,this.instances),1)[0]);this.instances.length===0&&a([document,window]).unbind(".dialog-overlay");e.remove();var b=0;a.each(this.instances,function(){b=
Math.max(b,this.css("z-index"))});this.maxZ=b},height:function(){var e,b;if(a.browser.msie&&a.browser.version<7){e=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight);b=Math.max(document.documentElement.offsetHeight,document.body.offsetHeight);return e<b?a(window).height()+"px":e+"px"}else return a(document).height()+"px"},width:function(){var e,b;if(a.browser.msie&&a.browser.version<7){e=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth);b=Math.max(document.documentElement.offsetWidth,
document.body.offsetWidth);return e<b?a(window).width()+"px":e+"px"}else return a(document).width()+"px"},resize:function(){var e=a([]);a.each(a.ui.dialog.overlay.instances,function(){e=e.add(this)});e.css({width:0,height:0}).css({width:a.ui.dialog.overlay.width(),height:a.ui.dialog.overlay.height()})}});a.extend(a.ui.dialog.overlay.prototype,{destroy:function(){a.ui.dialog.overlay.destroy(this.$el)}})})(jQuery);
(function(a){a.ui=a.ui||{};var f=/left|center|right/,e=/top|center|bottom/,b=a.fn.position,g=a.fn.offset;a.fn.position=function(d){if(!d||!d.of)return b.apply(this,arguments);d=a.extend({},d);var c=a(d.of),h=(d.collision||"flip").split(" "),k=d.offset?d.offset.split(" "):[0,0],l,o,n;if(d.of.nodeType===9){l=c.width();o=c.height();n={top:0,left:0}}else if(d.of.scrollTo&&d.of.document){l=c.width();o=c.height();n={top:c.scrollTop(),left:c.scrollLeft()}}else if(d.of.preventDefault){d.at="left top";l=o=
0;n={top:d.of.pageY,left:d.of.pageX}}else{l=c.outerWidth();o=c.outerHeight();n=c.offset()}a.each(["my","at"],function(){var m=(d[this]||"").split(" ");if(m.length===1)m=f.test(m[0])?m.concat(["center"]):e.test(m[0])?["center"].concat(m):["center","center"];m[0]=f.test(m[0])?m[0]:"center";m[1]=e.test(m[1])?m[1]:"center";d[this]=m});if(h.length===1)h[1]=h[0];k[0]=parseInt(k[0],10)||0;if(k.length===1)k[1]=k[0];k[1]=parseInt(k[1],10)||0;if(d.at[0]==="right")n.left+=l;else if(d.at[0]==="center")n.left+=
l/2;if(d.at[1]==="bottom")n.top+=o;else if(d.at[1]==="center")n.top+=o/2;n.left+=k[0];n.top+=k[1];return this.each(function(){var m=a(this),C=m.outerWidth(),I=m.outerHeight(),H=a.extend({},n);if(d.my[0]==="right")H.left-=C;else if(d.my[0]==="center")H.left-=C/2;if(d.my[1]==="bottom")H.top-=I;else if(d.my[1]==="center")H.top-=I/2;H.left=parseInt(H.left);H.top=parseInt(H.top);a.each(["left","top"],function(G,P){a.ui.position[h[G]]&&a.ui.position[h[G]][P](H,{targetWidth:l,targetHeight:o,elemWidth:C,
elemHeight:I,offset:k,my:d.my,at:d.at})});a.fn.bgiframe&&m.bgiframe();m.offset(a.extend(H,{using:d.using}))})};a.ui.position={fit:{left:function(d,c){var h=a(window);c=d.left+c.elemWidth-h.width()-h.scrollLeft();d.left=c>0?d.left-c:Math.max(0,d.left)},top:function(d,c){var h=a(window);c=d.top+c.elemHeight-h.height()-h.scrollTop();d.top=c>0?d.top-c:Math.max(0,d.top)}},flip:{left:function(d,c){if(c.at[0]!=="center"){var h=a(window);h=d.left+c.elemWidth-h.width()-h.scrollLeft();var k=c.my[0]==="left"?
-c.elemWidth:c.my[0]==="right"?c.elemWidth:0,l=-2*c.offset[0];d.left+=d.left<0?k+c.targetWidth+l:h>0?k-c.targetWidth+l:0}},top:function(d,c){if(c.at[1]!=="center"){var h=a(window);h=d.top+c.elemHeight-h.height()-h.scrollTop();var k=c.my[1]==="top"?-c.elemHeight:c.my[1]==="bottom"?c.elemHeight:0,l=c.at[1]==="top"?c.targetHeight:-c.targetHeight,o=-2*c.offset[1];d.top+=d.top<0?k+c.targetHeight+o:h>0?k+l+o:0}}}};if(!a.offset.setOffset){a.offset.setOffset=function(d,c){if(/static/.test(a.curCSS(d,"position")))d.style.position=
"relative";var h=a(d),k=h.offset(),l=parseInt(a.curCSS(d,"top",true),10)||0,o=parseInt(a.curCSS(d,"left",true),10)||0;k={top:c.top-k.top+l,left:c.left-k.left+o};"using"in c?c.using.call(d,k):h.css(k)};a.fn.offset=function(d){var c=this[0];if(!c||!c.ownerDocument)return null;if(d)return this.each(function(){a.offset.setOffset(this,d)});return g.call(this)}}})(jQuery);
(function(a,f){a.widget("ui.progressbar",{options:{value:0},min:0,max:100,_create:function(){this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min,"aria-valuemax":this.max,"aria-valuenow":this._value()});this.valueDiv=a("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element);this._refreshValue()},destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow");
this.valueDiv.remove();a.Widget.prototype.destroy.apply(this,arguments)},value:function(e){if(e===f)return this._value();this._setOption("value",e);return this},_setOption:function(e,b){if(e==="value"){this.options.value=b;this._refreshValue();this._trigger("change")}a.Widget.prototype._setOption.apply(this,arguments)},_value:function(){var e=this.options.value;if(typeof e!=="number")e=0;return Math.min(this.max,Math.max(this.min,e))},_refreshValue:function(){var e=this.value();this.valueDiv.toggleClass("ui-corner-right",
e===this.max).width(e+"%");this.element.attr("aria-valuenow",e)}});a.extend(a.ui.progressbar,{version:"1.8.3"})})(jQuery);
(function(a){a.widget("ui.slider",a.ui.mouse,{widgetEventPrefix:"slide",options:{animate:false,distance:0,max:100,min:0,orientation:"horizontal",range:false,step:1,value:0,values:null},_create:function(){var f=this,e=this.options;this._mouseSliding=this._keySliding=false;this._animateOff=true;this._handleIndex=null;this._detectOrientation();this._mouseInit();this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all");e.disabled&&this.element.addClass("ui-slider-disabled ui-disabled");
this.range=a([]);if(e.range){if(e.range===true){this.range=a("<div></div>");if(!e.values)e.values=[this._valueMin(),this._valueMin()];if(e.values.length&&e.values.length!==2)e.values=[e.values[0],e.values[0]]}else this.range=a("<div></div>");this.range.appendTo(this.element).addClass("ui-slider-range");if(e.range==="min"||e.range==="max")this.range.addClass("ui-slider-range-"+e.range);this.range.addClass("ui-widget-header")}a(".ui-slider-handle",this.element).length===0&&a("<a href='#'></a>").appendTo(this.element).addClass("ui-slider-handle");
if(e.values&&e.values.length)for(;a(".ui-slider-handle",this.element).length<e.values.length;)a("<a href='#'></a>").appendTo(this.element).addClass("ui-slider-handle");this.handles=a(".ui-slider-handle",this.element).addClass("ui-state-default ui-corner-all");this.handle=this.handles.eq(0);this.handles.add(this.range).filter("a").click(function(b){b.preventDefault()}).hover(function(){e.disabled||a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")}).focus(function(){if(e.disabled)a(this).blur();
else{a(".ui-slider .ui-state-focus").removeClass("ui-state-focus");a(this).addClass("ui-state-focus")}}).blur(function(){a(this).removeClass("ui-state-focus")});this.handles.each(function(b){a(this).data("index.ui-slider-handle",b)});this.handles.keydown(function(b){var g=true,d=a(this).data("index.ui-slider-handle"),c,h,k;if(!f.options.disabled){switch(b.keyCode){case a.ui.keyCode.HOME:case a.ui.keyCode.END:case a.ui.keyCode.PAGE_UP:case a.ui.keyCode.PAGE_DOWN:case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:g=
false;if(!f._keySliding){f._keySliding=true;a(this).addClass("ui-state-active");c=f._start(b,d);if(c===false)return}}k=f.options.step;c=f.options.values&&f.options.values.length?h=f.values(d):h=f.value();switch(b.keyCode){case a.ui.keyCode.HOME:h=f._valueMin();break;case a.ui.keyCode.END:h=f._valueMax();break;case a.ui.keyCode.PAGE_UP:h=f._trimAlignValue(c+(f._valueMax()-f._valueMin())/5);break;case a.ui.keyCode.PAGE_DOWN:h=f._trimAlignValue(c-(f._valueMax()-f._valueMin())/5);break;case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:if(c===
f._valueMax())return;h=f._trimAlignValue(c+k);break;case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:if(c===f._valueMin())return;h=f._trimAlignValue(c-k)}f._slide(b,d,h);return g}}).keyup(function(b){var g=a(this).data("index.ui-slider-handle");if(f._keySliding){f._keySliding=false;f._stop(b,g);f._change(b,g);a(this).removeClass("ui-state-active")}});this._refreshValue();this._animateOff=false},destroy:function(){this.handles.remove();this.range.remove();this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all").removeData("slider").unbind(".slider");
this._mouseDestroy();return this},_mouseCapture:function(f){var e=this.options,b,g,d,c,h;if(e.disabled)return false;this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()};this.elementOffset=this.element.offset();b=this._normValueFromMouse({x:f.pageX,y:f.pageY});g=this._valueMax()-this._valueMin()+1;c=this;this.handles.each(function(k){var l=Math.abs(b-c.values(k));if(g>l){g=l;d=a(this);h=k}});if(e.range===true&&this.values(1)===e.min){h+=1;d=a(this.handles[h])}if(this._start(f,
h)===false)return false;this._mouseSliding=true;c._handleIndex=h;d.addClass("ui-state-active").focus();e=d.offset();this._clickOffset=!a(f.target).parents().andSelf().is(".ui-slider-handle")?{left:0,top:0}:{left:f.pageX-e.left-d.width()/2,top:f.pageY-e.top-d.height()/2-(parseInt(d.css("borderTopWidth"),10)||0)-(parseInt(d.css("borderBottomWidth"),10)||0)+(parseInt(d.css("marginTop"),10)||0)};this._slide(f,h,b);return this._animateOff=true},_mouseStart:function(){return true},_mouseDrag:function(f){var e=
this._normValueFromMouse({x:f.pageX,y:f.pageY});this._slide(f,this._handleIndex,e);return false},_mouseStop:function(f){this.handles.removeClass("ui-state-active");this._mouseSliding=false;this._stop(f,this._handleIndex);this._change(f,this._handleIndex);this._clickOffset=this._handleIndex=null;return this._animateOff=false},_detectOrientation:function(){this.orientation=this.options.orientation==="vertical"?"vertical":"horizontal"},_normValueFromMouse:function(f){var e;if(this.orientation==="horizontal"){e=
this.elementSize.width;f=f.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)}else{e=this.elementSize.height;f=f.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)}e=f/e;if(e>1)e=1;if(e<0)e=0;if(this.orientation==="vertical")e=1-e;f=this._valueMax()-this._valueMin();return this._trimAlignValue(this._valueMin()+e*f)},_start:function(f,e){var b={handle:this.handles[e],value:this.value()};if(this.options.values&&this.options.values.length){b.value=this.values(e);
b.values=this.values()}return this._trigger("start",f,b)},_slide:function(f,e,b){var g;if(this.options.values&&this.options.values.length){g=this.values(e?0:1);if(this.options.values.length===2&&this.options.range===true&&(e===0&&b>g||e===1&&b<g))b=g;if(b!==this.values(e)){g=this.values();g[e]=b;f=this._trigger("slide",f,{handle:this.handles[e],value:b,values:g});this.values(e?0:1);f!==false&&this.values(e,b,true)}}else if(b!==this.value()){f=this._trigger("slide",f,{handle:this.handles[e],value:b});
f!==false&&this.value(b)}},_stop:function(f,e){var b={handle:this.handles[e],value:this.value()};if(this.options.values&&this.options.values.length){b.value=this.values(e);b.values=this.values()}this._trigger("stop",f,b)},_change:function(f,e){if(!this._keySliding&&!this._mouseSliding){var b={handle:this.handles[e],value:this.value()};if(this.options.values&&this.options.values.length){b.value=this.values(e);b.values=this.values()}this._trigger("change",f,b)}},value:function(f){if(arguments.length){this.options.value=
this._trimAlignValue(f);this._refreshValue();this._change(null,0)}return this._value()},values:function(f,e){var b,g,d;if(arguments.length>1){this.options.values[f]=this._trimAlignValue(e);this._refreshValue();this._change(null,f)}if(arguments.length)if(a.isArray(arguments[0])){b=this.options.values;g=arguments[0];for(d=0;d<b.length;d+=1){b[d]=this._trimAlignValue(g[d]);this._change(null,d)}this._refreshValue()}else return this.options.values&&this.options.values.length?this._values(f):this.value();
else return this._values()},_setOption:function(f,e){var b,g=0;if(a.isArray(this.options.values))g=this.options.values.length;a.Widget.prototype._setOption.apply(this,arguments);switch(f){case "disabled":if(e){this.handles.filter(".ui-state-focus").blur();this.handles.removeClass("ui-state-hover");this.handles.attr("disabled","disabled");this.element.addClass("ui-disabled")}else{this.handles.removeAttr("disabled");this.element.removeClass("ui-disabled")}break;case "orientation":this._detectOrientation();
this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation);this._refreshValue();break;case "value":this._animateOff=true;this._refreshValue();this._change(null,0);this._animateOff=false;break;case "values":this._animateOff=true;this._refreshValue();for(b=0;b<g;b+=1)this._change(null,b);this._animateOff=false}},_value:function(){return this._trimAlignValue(this.options.value)},_values:function(f){var e,b;if(arguments.length){e=this.options.values[f];
return this._trimAlignValue(e)}else{e=this.options.values.slice();for(b=0;b<e.length;b+=1)e[b]=this._trimAlignValue(e[b]);return e}},_trimAlignValue:function(f){if(f<this._valueMin())return this._valueMin();if(f>this._valueMax())return this._valueMax();var e=this.options.step>0?this.options.step:1,b=f%e;f-=b;if(Math.abs(b)*2>=e)f+=b>0?e:-e;return parseFloat(f.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var f=this.options.range,
e=this.options,b=this,g=!this._animateOff?e.animate:false,d,c={},h,k,l,o;if(this.options.values&&this.options.values.length)this.handles.each(function(n){d=(b.values(n)-b._valueMin())/(b._valueMax()-b._valueMin())*100;c[b.orientation==="horizontal"?"left":"bottom"]=d+"%";a(this).stop(1,1)[g?"animate":"css"](c,e.animate);if(b.options.range===true)if(b.orientation==="horizontal"){if(n===0)b.range.stop(1,1)[g?"animate":"css"]({left:d+"%"},e.animate);if(n===1)b.range[g?"animate":"css"]({width:d-h+"%"},
{queue:false,duration:e.animate})}else{if(n===0)b.range.stop(1,1)[g?"animate":"css"]({bottom:d+"%"},e.animate);if(n===1)b.range[g?"animate":"css"]({height:d-h+"%"},{queue:false,duration:e.animate})}h=d});else{k=this.value();l=this._valueMin();o=this._valueMax();d=o!==l?(k-l)/(o-l)*100:0;c[b.orientation==="horizontal"?"left":"bottom"]=d+"%";this.handle.stop(1,1)[g?"animate":"css"](c,e.animate);if(f==="min"&&this.orientation==="horizontal")this.range.stop(1,1)[g?"animate":"css"]({width:d+"%"},e.animate);
if(f==="max"&&this.orientation==="horizontal")this.range[g?"animate":"css"]({width:100-d+"%"},{queue:false,duration:e.animate});if(f==="min"&&this.orientation==="vertical")this.range.stop(1,1)[g?"animate":"css"]({height:d+"%"},e.animate);if(f==="max"&&this.orientation==="vertical")this.range[g?"animate":"css"]({height:100-d+"%"},{queue:false,duration:e.animate})}}});a.extend(a.ui.slider,{version:"1.8.3"})})(jQuery);
(function(a,f){var e=0,b=0;a.widget("ui.tabs",{options:{add:null,ajaxOptions:null,cache:false,cookie:null,collapsible:false,disable:null,disabled:[],enable:null,event:"click",fx:null,idPrefix:"ui-tabs-",load:null,panelTemplate:"<div></div>",remove:null,select:null,show:null,spinner:"<em>Loading&#8230;</em>",tabTemplate:"<li><a href='#{href}'><span>#{label}</span></a></li>"},_create:function(){this._tabify(true)},_setOption:function(g,d){if(g=="selected")this.options.collapsible&&d==this.options.selected||
this.select(d);else{this.options[g]=d;this._tabify()}},_tabId:function(g){return g.title&&g.title.replace(/\s/g,"_").replace(/[^A-Za-z0-9\-_:\.]/g,"")||this.options.idPrefix+ ++e},_sanitizeSelector:function(g){return g.replace(/:/g,"\\:")},_cookie:function(){var g=this.cookie||(this.cookie=this.options.cookie.name||"ui-tabs-"+ ++b);return a.cookie.apply(null,[g].concat(a.makeArray(arguments)))},_ui:function(g,d){return{tab:g,panel:d,index:this.anchors.index(g)}},_cleanup:function(){this.lis.filter(".ui-state-processing").removeClass("ui-state-processing").find("span:data(label.tabs)").each(function(){var g=
a(this);g.html(g.data("label.tabs")).removeData("label.tabs")})},_tabify:function(g){function d(H,G){H.css("display","");!a.support.opacity&&G.opacity&&H[0].style.removeAttribute("filter")}var c=this,h=this.options,k=/^#.+/;this.list=this.element.find("ol,ul").eq(0);this.lis=a("li:has(a[href])",this.list);this.anchors=this.lis.map(function(){return a("a",this)[0]});this.panels=a([]);this.anchors.each(function(H,G){var P=a(G).attr("href"),Q=P.split("#")[0],N;if(Q&&(Q===location.toString().split("#")[0]||
(N=a("base")[0])&&Q===N.href)){P=G.hash;G.href=P}if(k.test(P))c.panels=c.panels.add(c._sanitizeSelector(P));else if(P!=="#"){a.data(G,"href.tabs",P);a.data(G,"load.tabs",P.replace(/#.*$/,""));P=c._tabId(G);G.href="#"+P;G=a("#"+P);if(!G.length){G=a(h.panelTemplate).attr("id",P).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").insertAfter(c.panels[H-1]||c.list);G.data("destroy.tabs",true)}c.panels=c.panels.add(G)}else h.disabled.push(H)});if(g){this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all");
this.list.addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all");this.lis.addClass("ui-state-default ui-corner-top");this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom");if(h.selected===f){location.hash&&this.anchors.each(function(H,G){if(G.hash==location.hash){h.selected=H;return false}});if(typeof h.selected!=="number"&&h.cookie)h.selected=parseInt(c._cookie(),10);if(typeof h.selected!=="number"&&this.lis.filter(".ui-tabs-selected").length)h.selected=
this.lis.index(this.lis.filter(".ui-tabs-selected"));h.selected=h.selected||(this.lis.length?0:-1)}else if(h.selected===null)h.selected=-1;h.selected=h.selected>=0&&this.anchors[h.selected]||h.selected<0?h.selected:0;h.disabled=a.unique(h.disabled.concat(a.map(this.lis.filter(".ui-state-disabled"),function(H){return c.lis.index(H)}))).sort();a.inArray(h.selected,h.disabled)!=-1&&h.disabled.splice(a.inArray(h.selected,h.disabled),1);this.panels.addClass("ui-tabs-hide");this.lis.removeClass("ui-tabs-selected ui-state-active");
if(h.selected>=0&&this.anchors.length){this.panels.eq(h.selected).removeClass("ui-tabs-hide");this.lis.eq(h.selected).addClass("ui-tabs-selected ui-state-active");c.element.queue("tabs",function(){c._trigger("show",null,c._ui(c.anchors[h.selected],c.panels[h.selected]))});this.load(h.selected)}a(window).bind("unload",function(){c.lis.add(c.anchors).unbind(".tabs");c.lis=c.anchors=c.panels=null})}else h.selected=this.lis.index(this.lis.filter(".ui-tabs-selected"));this.element[h.collapsible?"addClass":
"removeClass"]("ui-tabs-collapsible");h.cookie&&this._cookie(h.selected,h.cookie);g=0;for(var l;l=this.lis[g];g++)a(l)[a.inArray(g,h.disabled)!=-1&&!a(l).hasClass("ui-tabs-selected")?"addClass":"removeClass"]("ui-state-disabled");h.cache===false&&this.anchors.removeData("cache.tabs");this.lis.add(this.anchors).unbind(".tabs");if(h.event!=="mouseover"){var o=function(H,G){G.is(":not(.ui-state-disabled)")&&G.addClass("ui-state-"+H)};this.lis.bind("mouseover.tabs",function(){o("hover",a(this))});this.lis.bind("mouseout.tabs",
function(){a(this).removeClass("ui-state-hover")});this.anchors.bind("focus.tabs",function(){o("focus",a(this).closest("li"))});this.anchors.bind("blur.tabs",function(){a(this).closest("li").removeClass("ui-state-focus")})}var n,m;if(h.fx)if(a.isArray(h.fx)){n=h.fx[0];m=h.fx[1]}else n=m=h.fx;var C=m?function(H,G){a(H).closest("li").addClass("ui-tabs-selected ui-state-active");G.hide().removeClass("ui-tabs-hide").animate(m,m.duration||"normal",function(){d(G,m);c._trigger("show",null,c._ui(H,G[0]))})}:
function(H,G){a(H).closest("li").addClass("ui-tabs-selected ui-state-active");G.removeClass("ui-tabs-hide");c._trigger("show",null,c._ui(H,G[0]))},I=n?function(H,G){G.animate(n,n.duration||"normal",function(){c.lis.removeClass("ui-tabs-selected ui-state-active");G.addClass("ui-tabs-hide");d(G,n);c.element.dequeue("tabs")})}:function(H,G){c.lis.removeClass("ui-tabs-selected ui-state-active");G.addClass("ui-tabs-hide");c.element.dequeue("tabs")};this.anchors.bind(h.event+".tabs",function(){var H=this,
G=a(H).closest("li"),P=c.panels.filter(":not(.ui-tabs-hide)"),Q=a(c._sanitizeSelector(H.hash));if(G.hasClass("ui-tabs-selected")&&!h.collapsible||G.hasClass("ui-state-disabled")||G.hasClass("ui-state-processing")||c._trigger("select",null,c._ui(this,Q[0]))===false){this.blur();return false}h.selected=c.anchors.index(this);c.abort();if(h.collapsible)if(G.hasClass("ui-tabs-selected")){h.selected=-1;h.cookie&&c._cookie(h.selected,h.cookie);c.element.queue("tabs",function(){I(H,P)}).dequeue("tabs");this.blur();
return false}else if(!P.length){h.cookie&&c._cookie(h.selected,h.cookie);c.element.queue("tabs",function(){C(H,Q)});c.load(c.anchors.index(this));this.blur();return false}h.cookie&&c._cookie(h.selected,h.cookie);if(Q.length){P.length&&c.element.queue("tabs",function(){I(H,P)});c.element.queue("tabs",function(){C(H,Q)});c.load(c.anchors.index(this))}else throw"jQuery UI Tabs: Mismatching fragment identifier.";a.browser.msie&&this.blur()});this.anchors.bind("click.tabs",function(){return false})},_getIndex:function(g){if(typeof g==
"string")g=this.anchors.index(this.anchors.filter("[href$="+g+"]"));return g},destroy:function(){var g=this.options;this.abort();this.element.unbind(".tabs").removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible").removeData("tabs");this.list.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all");this.anchors.each(function(){var d=a.data(this,"href.tabs");if(d)this.href=d;var c=a(this).unbind(".tabs");a.each(["href","load","cache"],
function(h,k){c.removeData(k+".tabs")})});this.lis.unbind(".tabs").add(this.panels).each(function(){a.data(this,"destroy.tabs")?a(this).remove():a(this).removeClass("ui-state-default ui-corner-top ui-tabs-selected ui-state-active ui-state-hover ui-state-focus ui-state-disabled ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide")});g.cookie&&this._cookie(null,g.cookie);return this},add:function(g,d,c){if(c===f)c=this.anchors.length;var h=this,k=this.options;d=a(k.tabTemplate.replace(/#\{href\}/g,
g).replace(/#\{label\}/g,d));g=!g.indexOf("#")?g.replace("#",""):this._tabId(a("a",d)[0]);d.addClass("ui-state-default ui-corner-top").data("destroy.tabs",true);var l=a("#"+g);l.length||(l=a(k.panelTemplate).attr("id",g).data("destroy.tabs",true));l.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide");if(c>=this.lis.length){d.appendTo(this.list);l.appendTo(this.list[0].parentNode)}else{d.insertBefore(this.lis[c]);l.insertBefore(this.panels[c])}k.disabled=a.map(k.disabled,function(o){return o>=
c?++o:o});this._tabify();if(this.anchors.length==1){k.selected=0;d.addClass("ui-tabs-selected ui-state-active");l.removeClass("ui-tabs-hide");this.element.queue("tabs",function(){h._trigger("show",null,h._ui(h.anchors[0],h.panels[0]))});this.load(0)}this._trigger("add",null,this._ui(this.anchors[c],this.panels[c]));return this},remove:function(g){g=this._getIndex(g);var d=this.options,c=this.lis.eq(g).remove(),h=this.panels.eq(g).remove();if(c.hasClass("ui-tabs-selected")&&this.anchors.length>1)this.select(g+
(g+1<this.anchors.length?1:-1));d.disabled=a.map(a.grep(d.disabled,function(k){return k!=g}),function(k){return k>=g?--k:k});this._tabify();this._trigger("remove",null,this._ui(c.find("a")[0],h[0]));return this},enable:function(g){g=this._getIndex(g);var d=this.options;if(a.inArray(g,d.disabled)!=-1){this.lis.eq(g).removeClass("ui-state-disabled");d.disabled=a.grep(d.disabled,function(c){return c!=g});this._trigger("enable",null,this._ui(this.anchors[g],this.panels[g]));return this}},disable:function(g){g=
this._getIndex(g);var d=this.options;if(g!=d.selected){this.lis.eq(g).addClass("ui-state-disabled");d.disabled.push(g);d.disabled.sort();this._trigger("disable",null,this._ui(this.anchors[g],this.panels[g]))}return this},select:function(g){g=this._getIndex(g);if(g==-1)if(this.options.collapsible&&this.options.selected!=-1)g=this.options.selected;else return this;this.anchors.eq(g).trigger(this.options.event+".tabs");return this},load:function(g){g=this._getIndex(g);var d=this,c=this.options,h=this.anchors.eq(g)[0],
k=a.data(h,"load.tabs");this.abort();if(!k||this.element.queue("tabs").length!==0&&a.data(h,"cache.tabs"))this.element.dequeue("tabs");else{this.lis.eq(g).addClass("ui-state-processing");if(c.spinner){var l=a("span",h);l.data("label.tabs",l.html()).html(c.spinner)}this.xhr=a.ajax(a.extend({},c.ajaxOptions,{url:k,success:function(o,n){a(d._sanitizeSelector(h.hash)).html(o);d._cleanup();c.cache&&a.data(h,"cache.tabs",true);d._trigger("load",null,d._ui(d.anchors[g],d.panels[g]));try{c.ajaxOptions.success(o,
n)}catch(m){}},error:function(o,n){d._cleanup();d._trigger("load",null,d._ui(d.anchors[g],d.panels[g]));try{c.ajaxOptions.error(o,n,g,h)}catch(m){}}}));d.element.dequeue("tabs");return this}},abort:function(){this.element.queue([]);this.panels.stop(false,true);this.element.queue("tabs",this.element.queue("tabs").splice(-2,2));if(this.xhr){this.xhr.abort();delete this.xhr}this._cleanup();return this},url:function(g,d){this.anchors.eq(g).removeData("cache.tabs").data("load.tabs",d);return this},length:function(){return this.anchors.length}});
a.extend(a.ui.tabs,{version:"1.8.3"});a.extend(a.ui.tabs.prototype,{rotation:null,rotate:function(g,d){var c=this,h=this.options,k=c._rotate||(c._rotate=function(l){clearTimeout(c.rotation);c.rotation=setTimeout(function(){var o=h.selected;c.select(++o<c.anchors.length?o:0)},g);l&&l.stopPropagation()});d=c._unrotate||(c._unrotate=!d?function(l){l.clientX&&c.rotate(null)}:function(){t=h.selected;k()});if(g){this.element.bind("tabsshow",k);this.anchors.bind(h.event+".tabs",d);k()}else{clearTimeout(c.rotation);
this.element.unbind("tabsshow",k);this.anchors.unbind(h.event+".tabs",d);delete this._rotate;delete this._unrotate}return this}})})(jQuery);(function(a){Math.precision=function(c,h){if(h===undefined)h=0;return Math.round(c*Math.pow(10,h))/Math.pow(10,h)};var f=function(c,h){var k=this,l=c.find("img:first"),o=0,n=100,m=100,C=0,I=100,H=100,G=0,P=0,Q,N,ba=[],ja=function(U){for(var Y=0;Y<ba.length;Y++)ba[Y].call(k,k,U)},V=function(U){var Y=c.offset();Q={l:Y.left|0,t:Y.top|0};clearTimeout(N);N=setTimeout(function(){sa.call(k,U)},0);a(document).bind("mousemove",T).bind("mouseup",aa);U.preventDefault()},T=function(U){clearTimeout(N);N=setTimeout(function(){sa.call(k,
U)},0);U.stopPropagation();U.preventDefault();return false},aa=function(U){a(document).unbind("mouseup",aa).unbind("mousemove",T);U.stopPropagation();U.preventDefault();return false},sa=function(U){var Y=U.pageX-Q.l;U=U.pageY-Q.t;var oa=c.w,pa=c.h;if(Y<0)Y=0;else if(Y>oa)Y=oa;if(U<0)U=0;else if(U>pa)U=pa;ka.call(k,"xy",{x:Y/oa*m+o,y:U/pa*H+C})},ka=function(U,Y,oa){if(Y===undefined){if(U===undefined||U==null)U="xy";switch(U.toLowerCase()){case "x":return G;case "y":return P;default:return{x:G,y:P}}}if(!(oa!=
null&&oa==k)){var pa=false,na,ia;if(U==null)U="xy";switch(U.toLowerCase()){case "x":na=Y&&(Y.x&&Y.x|0||Y|0)||0;break;case "y":ia=Y&&(Y.y&&Y.y|0||Y|0)||0;break;default:na=Y&&Y.x&&Y.x|0||0;ia=Y&&Y.y&&Y.y|0||0}if(na!=null){if(na<o)na=o;else if(na>n)na=n;if(G!=na){G=na;pa=true}}if(ia!=null){if(ia<C)ia=C;else if(ia>I)ia=I;if(P!=ia){P=ia;pa=true}}pa&&ja.call(k,oa||k)}},ea=function(U){a.isFunction(U)&&ba.push(U)};a.extend(true,k,{val:ka,range:function(U,Y){if(Y===undefined){if(U===undefined||U==null)U="all";
switch(U.toLowerCase()){case "minx":return o;case "maxx":return n;case "rangex":return{minX:o,maxX:n,rangeX:m};case "miny":return C;case "maxy":return I;case "rangey":return{minY:C,maxY:I,rangeY:H};default:return{minX:o,maxX:n,rangeX:m,minY:C,maxY:I,rangeY:H}}}var oa,pa,na,ia;if(U==null)U="all";switch(U.toLowerCase()){case "minx":oa=Y&&(Y.minX&&Y.minX|0||Y|0)||0;break;case "maxx":pa=Y&&(Y.maxX&&Y.maxX|0||Y|0)||0;break;case "rangex":oa=Y&&Y.minX&&Y.minX|0||0;pa=Y&&Y.maxX&&Y.maxX|0||0;break;case "miny":na=
Y&&(Y.minY&&Y.minY|0||Y|0)||0;break;case "maxy":ia=Y&&(Y.maxY&&Y.maxY|0||Y|0)||0;break;case "rangey":na=Y&&Y.minY&&Y.minY|0||0;ia=Y&&Y.maxY&&Y.maxY|0||0;break;default:oa=Y&&Y.minX&&Y.minX|0||0;pa=Y&&Y.maxX&&Y.maxX|0||0;na=Y&&Y.minY&&Y.minY|0||0;ia=Y&&Y.maxY&&Y.maxY|0||0}if(oa!=null&&o!=oa){o=oa;m=n-o}if(pa!=null&&n!=pa){n=pa;m=n-o}if(na!=null&&C!=na){C=na;H=I-C}if(ia!=null&&I!=ia){I=ia;H=I-C}},bind:ea,unbind:function(U){if(a.isFunction(U))for(var Y;(Y=a.inArray(U,ba))!=-1;)ba.splice(Y,1)},destroy:function(){a(document).unbind("mouseup",
aa).unbind("mousemove",T);c.unbind("mousedown",V);ba=l=c=null}});l.src=h.arrow&&h.arrow.image;l.w=h.arrow&&h.arrow.width||l.width();l.h=h.arrow&&h.arrow.height||l.height();c.w=h.map&&h.map.width||c.width();c.h=h.map&&h.map.height||c.height();c.bind("mousedown",V);ea.call(k,function(){var U=0,Y=0,oa=c.w,pa=c.h,na=l.w,ia=l.h;setTimeout(function(){if(m>0)U=G==n?oa:G/m*oa|0;if(H>0)Y=P==I?pa:P/H*pa|0;if(na>=oa)U=(oa>>1)-(na>>1);else U-=na>>1;if(ia>=pa)Y=(pa>>1)-(ia>>1);else Y-=ia>>1;l.css({left:U+"px",
top:Y+"px"})},0)})},e=function(c,h,k,l){var o=this;c=c.find("td.Text input");var n=c.eq(3),m=c.eq(4),C=c.eq(5),I=c.length>7?c.eq(6):null,H=c.eq(0),G=c.eq(1),P=c.eq(2),Q=c.eq(c.length>7?7:6),N=c.length>7?c.eq(8):null,ba=function(ka){if(!(ka.target.value==""&&ka.target!=Q.get(0)&&(k!=null&&ka.target!=k.get(0)||k==null))){if(!T(ka))return ka;switch(ka.target){case n.get(0):switch(ka.keyCode){case 38:n.val(aa.call(o,(n.val()<<0)+1,0,255));h.val("r",n.val(),ka.target);return false;case 40:n.val(aa.call(o,
(n.val()<<0)-1,0,255));h.val("r",n.val(),ka.target);return false}break;case m.get(0):switch(ka.keyCode){case 38:m.val(aa.call(o,(m.val()<<0)+1,0,255));h.val("g",m.val(),ka.target);return false;case 40:m.val(aa.call(o,(m.val()<<0)-1,0,255));h.val("g",m.val(),ka.target);return false}break;case C.get(0):switch(ka.keyCode){case 38:C.val(aa.call(o,(C.val()<<0)+1,0,255));h.val("b",C.val(),ka.target);return false;case 40:C.val(aa.call(o,(C.val()<<0)-1,0,255));h.val("b",C.val(),ka.target);return false}break;
case I&&I.get(0):switch(ka.keyCode){case 38:I.val(aa.call(o,parseFloat(I.val())+1,0,100));h.val("a",Math.precision(I.val()*255/100,l),ka.target);return false;case 40:I.val(aa.call(o,parseFloat(I.val())-1,0,100));h.val("a",Math.precision(I.val()*255/100,l),ka.target);return false}break;case H.get(0):switch(ka.keyCode){case 38:H.val(aa.call(o,(H.val()<<0)+1,0,360));h.val("h",H.val(),ka.target);return false;case 40:H.val(aa.call(o,(H.val()<<0)-1,0,360));h.val("h",H.val(),ka.target);return false}break;
case G.get(0):switch(ka.keyCode){case 38:G.val(aa.call(o,(G.val()<<0)+1,0,100));h.val("s",G.val(),ka.target);return false;case 40:G.val(aa.call(o,(G.val()<<0)-1,0,100));h.val("s",G.val(),ka.target);return false}break;case P.get(0):switch(ka.keyCode){case 38:P.val(aa.call(o,(P.val()<<0)+1,0,100));h.val("v",P.val(),ka.target);return false;case 40:P.val(aa.call(o,(P.val()<<0)-1,0,100));h.val("v",P.val(),ka.target);return false}}}},ja=function(ka){if(!(ka.target.value==""&&ka.target!=Q.get(0)&&(k!=null&&
ka.target!=k.get(0)||k==null))){if(!T(ka))return ka;switch(ka.target){case n.get(0):n.val(aa.call(o,n.val(),0,255));h.val("r",n.val(),ka.target);break;case m.get(0):m.val(aa.call(o,m.val(),0,255));h.val("g",m.val(),ka.target);break;case C.get(0):C.val(aa.call(o,C.val(),0,255));h.val("b",C.val(),ka.target);break;case I&&I.get(0):I.val(aa.call(o,I.val(),0,100));h.val("a",Math.precision(I.val()*255/100,l),ka.target);break;case H.get(0):H.val(aa.call(o,H.val(),0,360));h.val("h",H.val(),ka.target);break;
case G.get(0):G.val(aa.call(o,G.val(),0,100));h.val("s",G.val(),ka.target);break;case P.get(0):P.val(aa.call(o,P.val(),0,100));h.val("v",P.val(),ka.target);break;case Q.get(0):Q.val(Q.val().replace(/[^a-fA-F0-9]/g,"").toLowerCase().substring(0,6));k&&k.val(Q.val());h.val("hex",Q.val()!=""?Q.val():null,ka.target);break;case k&&k.get(0):k.val(k.val().replace(/[^a-fA-F0-9]/g,"").toLowerCase().substring(0,6));Q.val(k.val());h.val("hex",k.val()!=""?k.val():null,ka.target);break;case N&&N.get(0):N.val(N.val().replace(/[^a-fA-F0-9]/g,
"").toLowerCase().substring(0,2));h.val("a",N.val()!=null?parseInt(N.val(),16):null,ka.target)}}},V=function(ka){if(h.val()!=null)switch(ka.target){case n.get(0):n.val(h.val("r"));break;case m.get(0):m.val(h.val("g"));break;case C.get(0):C.val(h.val("b"));break;case I&&I.get(0):I.val(Math.precision(h.val("a")*100/255,l));break;case H.get(0):H.val(h.val("h"));break;case G.get(0):G.val(h.val("s"));break;case P.get(0):P.val(h.val("v"));break;case Q.get(0):case k&&k.get(0):Q.val(h.val("hex"));k&&k.val(h.val("hex"));
break;case N&&N.get(0):N.val(h.val("ahex").substring(6))}},T=function(ka){switch(ka.keyCode){case 9:case 16:case 29:case 37:case 39:return false;case "c".charCodeAt():case "v".charCodeAt():if(ka.ctrlKey)return false}return true},aa=function(ka,ea,U){if(ka==""||isNaN(ka))return ea;if(ka>U)return U;if(ka<ea)return ea;return ka},sa=function(ka,ea){var U=ka.val("all");if(ea!=n.get(0))n.val(U!=null?U.r:"");if(ea!=m.get(0))m.val(U!=null?U.g:"");if(ea!=C.get(0))C.val(U!=null?U.b:"");if(I&&ea!=I.get(0))I.val(U!=
null?Math.precision(U.a*100/255,l):"");if(ea!=H.get(0))H.val(U!=null?U.h:"");if(ea!=G.get(0))G.val(U!=null?U.s:"");if(ea!=P.get(0))P.val(U!=null?U.v:"");if(ea!=Q.get(0)&&(k&&ea!=k.get(0)||!k))Q.val(U!=null?U.hex:"");if(k&&ea!=k.get(0)&&ea!=Q.get(0))k.val(U!=null?U.hex:"");if(N&&ea!=N.get(0))N.val(U!=null?U.ahex.substring(6):"")};a.extend(true,o,{destroy:function(){n.add(m).add(C).add(I).add(H).add(G).add(P).add(Q).add(k).add(N).unbind("keyup",ja).unbind("blur",V);n.add(m).add(C).add(I).add(H).add(G).add(P).unbind("keydown",
ba);h.unbind(sa);N=Q=P=G=H=I=C=m=n=null}});n.add(m).add(C).add(I).add(H).add(G).add(P).add(Q).add(k).add(N).bind("keyup",ja).bind("blur",V);n.add(m).add(C).add(I).add(H).add(G).add(P).bind("keydown",ba);h.bind(sa)};a.jPicker={List:[],Color:function(c){var h=this,k,l,o,n,m,C,I,H=[],G=function(Q){for(var N=0;N<H.length;N++)H[N].call(h,h,Q)},P=function(Q,N,ba){if(N===undefined){if(Q===undefined||Q==null||Q=="")Q="all";if(k==null)return null;switch(Q.toLowerCase()){case "ahex":return d.rgbaToHex({r:k,
g:l,b:o,a:n});case "hex":return P("ahex").substring(0,6);case "all":return{r:k,g:l,b:o,a:n,h:m,s:C,v:I,hex:P.call(h,"hex"),ahex:P.call(h,"ahex")};default:N={};for(var ja=0;ja<Q.length;ja++)switch(Q.charAt(ja)){case "r":if(Q.length==1)N=k;else N.r=k;break;case "g":if(Q.length==1)N=l;else N.g=l;break;case "b":if(Q.length==1)N=o;else N.b=o;break;case "a":if(Q.length==1)N=n;else N.a=n;break;case "h":if(Q.length==1)N=m;else N.h=m;break;case "s":if(Q.length==1)N=C;else N.s=C;break;case "v":if(Q.length==
1)N=I;else N.v=I}return N=={}?P.call(h,"all"):N}}if(!(ba!=null&&ba==h)){var V=false;if(Q==null)Q="";if(N==null){if(k!=null){k=null;V=true}if(l!=null){l=null;V=true}if(o!=null){o=null;V=true}if(n!=null){n=null;V=true}if(m!=null){m=null;V=true}if(C!=null){C=null;V=true}if(I!=null){I=null;V=true}V&&G.call(h,ba||h)}else switch(Q.toLowerCase()){case "ahex":case "hex":N=d.hexToRgba(N&&(N.ahex||N.hex)||N||"00000000");P.call(h,"rgba",{r:N.r,g:N.g,b:N.b,a:Q=="ahex"?N.a:n!=null?n:255},ba);break;default:if(N&&
(N.ahex!=null||N.hex!=null)){P.call(h,"ahex",N.ahex||N.hex||"00000000",ba);break}var T={},aa=false,sa=false;if(N.r!==undefined&&!Q.indexOf("r")==-1)Q+="r";if(N.g!==undefined&&!Q.indexOf("g")==-1)Q+="g";if(N.b!==undefined&&!Q.indexOf("b")==-1)Q+="b";if(N.a!==undefined&&!Q.indexOf("a")==-1)Q+="a";if(N.h!==undefined&&!Q.indexOf("h")==-1)Q+="h";if(N.s!==undefined&&!Q.indexOf("s")==-1)Q+="s";if(N.v!==undefined&&!Q.indexOf("v")==-1)Q+="v";for(ja=0;ja<Q.length;ja++)switch(Q.charAt(ja)){case "r":if(sa)continue;
aa=true;T.r=N&&N.r&&N.r|0||N&&N|0||0;if(T.r<0)T.r=0;else if(T.r>255)T.r=255;if(k!=T.r){k=T.r;V=true}break;case "g":if(sa)continue;aa=true;T.g=N&&N.g&&N.g|0||N&&N|0||0;if(T.g<0)T.g=0;else if(T.g>255)T.g=255;if(l!=T.g){l=T.g;V=true}break;case "b":if(sa)continue;aa=true;T.b=N&&N.b&&N.b|0||N&&N|0||0;if(T.b<0)T.b=0;else if(T.b>255)T.b=255;if(o!=T.b){o=T.b;V=true}break;case "a":T.a=N&&N.a!=null?N.a|0:N!=null?N|0:255;if(T.a<0)T.a=0;else if(T.a>255)T.a=255;if(n!=T.a){n=T.a;V=true}break;case "h":if(aa)continue;
sa=true;T.h=N&&N.h&&N.h|0||N&&N|0||0;if(T.h<0)T.h=0;else if(T.h>360)T.h=360;if(m!=T.h){m=T.h;V=true}break;case "s":if(aa)continue;sa=true;T.s=N&&N.s!=null?N.s|0:N!=null?N|0:100;if(T.s<0)T.s=0;else if(T.s>100)T.s=100;if(C!=T.s){C=T.s;V=true}break;case "v":if(aa)continue;sa=true;T.v=N&&N.v!=null?N.v|0:N!=null?N|0:100;if(T.v<0)T.v=0;else if(T.v>100)T.v=100;if(I!=T.v){I=T.v;V=true}}if(V){if(aa){k=k||0;l=l||0;o=o||0;N=d.rgbToHsv({r:k,g:l,b:o});m=N.h;C=N.s;I=N.v}else if(sa){m=m||0;C=C!=null?C:100;I=I!=
null?I:100;N=d.hsvToRgb({h:m,s:C,v:I});k=N.r;l=N.g;o=N.b}n=n!=null?n:255;G.call(h,ba||h)}}}};a.extend(true,h,{val:P,bind:function(Q){a.isFunction(Q)&&H.push(Q)},unbind:function(Q){if(a.isFunction(Q))for(var N;(N=a.inArray(Q,H))!=-1;)H.splice(N,1)},destroy:function(){H=null}});if(c)if(c.ahex!=null)P("ahex",c);else if(c.hex!=null)P((c.a!=null?"a":"")+"hex",c.a!=null?{ahex:c.hex+d.intToHex(c.a)}:c);else if(c.r!=null&&c.g!=null&&c.b!=null)P("rgb"+(c.a!=null?"a":""),c);else if(c.h!=null&&c.s!=null&&c.v!=
null)P("hsv"+(c.a!=null?"a":""),c)},ColorMethods:{hexToRgba:function(c){c=this.validateHex(c);if(c=="")return{r:null,g:null,b:null,a:null};var h="00",k="00",l="00",o="255";if(c.length==6)c+="ff";if(c.length>6){h=c.substring(0,2);k=c.substring(2,4);l=c.substring(4,6);o=c.substring(6,c.length)}else{if(c.length>4){h=c.substring(4,c.length);c=c.substring(0,4)}if(c.length>2){k=c.substring(2,c.length);c=c.substring(0,2)}if(c.length>0)l=c.substring(0,c.length)}return{r:this.hexToInt(h),g:this.hexToInt(k),
b:this.hexToInt(l),a:this.hexToInt(o)}},validateHex:function(c){if(typeof c=="object")return"";c=c.toLowerCase().replace(/[^a-f0-9]/g,"");if(c.length>8)c=c.substring(0,8);return c},rgbaToHex:function(c){return this.intToHex(c.r)+this.intToHex(c.g)+this.intToHex(c.b)+this.intToHex(c.a)},intToHex:function(c){c=(c|0).toString(16);if(c.length==1)c="0"+c;return c.toLowerCase()},hexToInt:function(c){return parseInt(c,16)},rgbToHsv:function(c){var h=c.r/255,k=c.g/255;c=c.b/255;var l={h:0,s:0,v:0},o=0,n=
0;if(h>=k&&h>=c){n=h;o=k>c?c:k}else if(k>=c&&k>=h){n=k;o=h>c?c:h}else{n=c;o=k>h?h:k}l.v=n;l.s=n?(n-o)/n:0;if(l.s){o=n-o;l.h=h==n?(k-c)/o:k==n?2+(c-h)/o:4+(h-k)/o;l.h=parseInt(l.h*60);if(l.h<0)l.h+=360}else l.h=0;l.s=l.s*100|0;l.v=l.v*100|0;return l},hsvToRgb:function(c){var h={r:0,g:0,b:0,a:100},k=c.h,l=c.s;c=c.v;if(l==0)h.r=c==0?h.g=h.b=0:h.g=h.b=c*255/100|0;else{if(k==360)k=0;k/=60;l/=100;c/=100;var o=k|0,n=k-o;k=c*(1-l);var m=c*(1-l*n);l=c*(1-l*(1-n));switch(o){case 0:h.r=c;h.g=l;h.b=k;break;case 1:h.r=
m;h.g=c;h.b=k;break;case 2:h.r=k;h.g=c;h.b=l;break;case 3:h.r=k;h.g=m;h.b=c;break;case 4:h.r=l;h.g=k;h.b=c;break;case 5:h.r=c;h.g=k;h.b=m}h.r=h.r*255|0;h.g=h.g*255|0;h.b=h.b*255|0}return h}}};var b=a.jPicker.Color,g=a.jPicker.List,d=a.jPicker.ColorMethods;a.fn.jPicker=function(c){var h=arguments;return this.each(function(){var k=this,l=a.extend(true,{},a.fn.jPicker.defaults,c);if(a(k).get(0).nodeName.toLowerCase()=="input"){a.extend(true,l,{window:{bindToInput:true,expandable:true,input:a(k)}});if(a(k).val()==
""){l.color.active=new b({hex:null});l.color.current=new b({hex:null})}else if(d.validateHex(a(k).val())){l.color.active=new b({hex:a(k).val(),a:l.color.active.val("a")});l.color.current=new b({hex:a(k).val(),a:l.color.active.val("a")})}}if(l.window.expandable)a(k).after('<span class="jPicker"><span class="Icon"><span class="Color">&nbsp;</span><span class="Alpha">&nbsp;</span><span class="Image" title="Click To Open Color Picker">&nbsp;</span><span class="Container">&nbsp;</span></span></span>');
else l.window.liveUpdate=false;var o=parseFloat(navigator.appVersion.split("MSIE")[1])<7&&document.body.filters,n=null,m=null,C=null,I=null,H=null,G=null,P=null,Q=null,N=null,ba=null,ja=null,V=null,T=null,aa=null,sa=null,ka=null,ea=null,U=null,Y=null,oa=null,pa=null,na=null,ia=null,ta=null,wa=null,ra=null,Ha=null,Da=null,Ka=function(O){var S=ma.active,fa=S.val("hex"),Ga,Oa;l.color.mode=O;switch(O){case "h":setTimeout(function(){Ta.call(k,m,"transparent");Ia.call(k,I,0);ya.call(k,I,100);Ia.call(k,
H,260);ya.call(k,H,100);Ta.call(k,C,"transparent");Ia.call(k,P,0);ya.call(k,P,100);Ia.call(k,Q,260);ya.call(k,Q,100);Ia.call(k,N,260);ya.call(k,N,100);Ia.call(k,ba,260);ya.call(k,ba,100);Ia.call(k,V,260);ya.call(k,V,100)},0);T.range("all",{minX:0,maxX:100,minY:0,maxY:100});aa.range("rangeY",{minY:0,maxY:360});if(S.val("ahex")==null)break;T.val("xy",{x:S.val("s"),y:100-S.val("v")},T);aa.val("y",360-S.val("h"),aa);break;case "s":setTimeout(function(){Ta.call(k,m,"transparent");Ia.call(k,I,-260);Ia.call(k,
H,-520);Ia.call(k,P,-260);Ia.call(k,Q,-520);Ia.call(k,V,260);ya.call(k,V,100)},0);T.range("all",{minX:0,maxX:360,minY:0,maxY:100});aa.range("rangeY",{minY:0,maxY:100});if(S.val("ahex")==null)break;T.val("xy",{x:S.val("h"),y:100-S.val("v")},T);aa.val("y",100-S.val("s"),aa);break;case "v":setTimeout(function(){Ta.call(k,m,"000000");Ia.call(k,I,-780);Ia.call(k,H,260);Ta.call(k,C,fa);Ia.call(k,P,-520);Ia.call(k,Q,260);ya.call(k,Q,100);Ia.call(k,V,260);ya.call(k,V,100)},0);T.range("all",{minX:0,maxX:360,
minY:0,maxY:100});aa.range("rangeY",{minY:0,maxY:100});if(S.val("ahex")==null)break;T.val("xy",{x:S.val("h"),y:100-S.val("s")},T);aa.val("y",100-S.val("v"),aa);break;case "r":Ga=-1040;Oa=-780;T.range("all",{minX:0,maxX:255,minY:0,maxY:255});aa.range("rangeY",{minY:0,maxY:255});if(S.val("ahex")==null)break;T.val("xy",{x:S.val("b"),y:255-S.val("g")},T);aa.val("y",255-S.val("r"),aa);break;case "g":Ga=-1560;Oa=-1820;T.range("all",{minX:0,maxX:255,minY:0,maxY:255});aa.range("rangeY",{minY:0,maxY:255});
if(S.val("ahex")==null)break;T.val("xy",{x:S.val("b"),y:255-S.val("r")},T);aa.val("y",255-S.val("g"),aa);break;case "b":Ga=-2080;Oa=-2860;T.range("all",{minX:0,maxX:255,minY:0,maxY:255});aa.range("rangeY",{minY:0,maxY:255});if(S.val("ahex")==null)break;T.val("xy",{x:S.val("r"),y:255-S.val("g")},T);aa.val("y",255-S.val("b"),aa);break;case "a":setTimeout(function(){Ta.call(k,m,"transparent");Ia.call(k,I,-260);Ia.call(k,H,-520);Ia.call(k,P,260);Ia.call(k,Q,260);ya.call(k,Q,100);Ia.call(k,V,0);ya.call(k,
V,100)},0);T.range("all",{minX:0,maxX:360,minY:0,maxY:100});aa.range("rangeY",{minY:0,maxY:255});if(S.val("ahex")==null)break;T.val("xy",{x:S.val("h"),y:100-S.val("v")},T);aa.val("y",255-S.val("a"),aa);break;default:throw"Invalid Mode";}switch(O){case "s":case "v":case "a":setTimeout(function(){ya.call(k,I,100);ya.call(k,P,100);Ia.call(k,N,260);ya.call(k,N,100);Ia.call(k,ba,260);ya.call(k,ba,100)},0);break;case "r":case "g":case "b":setTimeout(function(){Ta.call(k,m,"transparent");Ta.call(k,C,"transparent");
ya.call(k,P,100);ya.call(k,I,100);Ia.call(k,I,Ga);Ia.call(k,H,Ga-260);Ia.call(k,P,Oa-780);Ia.call(k,Q,Oa-520);Ia.call(k,N,Oa);Ia.call(k,ba,Oa-260);Ia.call(k,V,260);ya.call(k,V,100)},0)}S.val("ahex")!=null&&Aa.call(k,S)},Aa=function(O,S){if(S==null||S!=aa&&S!=T)Ba.call(k,O,S);setTimeout(function(){kb.call(k,O);vb.call(k,O);cb.call(k,O)},0)},xa=function(O,S){var fa=ma.active;if(!(S!=T&&fa.val()==null)){var Ga=O.val("all");switch(l.color.mode){case "h":fa.val("sv",{s:Ga.x,v:100-Ga.y},S);break;case "s":case "a":fa.val("hv",
{h:Ga.x,v:100-Ga.y},S);break;case "v":fa.val("hs",{h:Ga.x,s:100-Ga.y},S);break;case "r":fa.val("gb",{g:255-Ga.y,b:Ga.x},S);break;case "g":fa.val("rb",{r:255-Ga.y,b:Ga.x},S);break;case "b":fa.val("rg",{r:Ga.x,g:255-Ga.y},S)}}},ua=function(O,S){var fa=ma.active;if(!(S!=aa&&fa.val()==null))switch(l.color.mode){case "h":fa.val("h",{h:360-O.val("y")},S);break;case "s":fa.val("s",{s:100-O.val("y")},S);break;case "v":fa.val("v",{v:100-O.val("y")},S);break;case "r":fa.val("r",{r:255-O.val("y")},S);break;
case "g":fa.val("g",{g:255-O.val("y")},S);break;case "b":fa.val("b",{b:255-O.val("y")},S);break;case "a":fa.val("a",255-O.val("y"),S)}},Ba=function(O,S){if(S!=T)switch(l.color.mode){case "h":var fa=O.val("sv");T.val("xy",{x:fa!=null?fa.s:100,y:100-(fa!=null?fa.v:100)},S);break;case "s":case "a":fa=O.val("hv");T.val("xy",{x:fa&&fa.h||0,y:100-(fa!=null?fa.v:100)},S);break;case "v":fa=O.val("hs");T.val("xy",{x:fa&&fa.h||0,y:100-(fa!=null?fa.s:100)},S);break;case "r":fa=O.val("bg");T.val("xy",{x:fa&&
fa.b||0,y:255-(fa&&fa.g||0)},S);break;case "g":fa=O.val("br");T.val("xy",{x:fa&&fa.b||0,y:255-(fa&&fa.r||0)},S);break;case "b":fa=O.val("rg");T.val("xy",{x:fa&&fa.r||0,y:255-(fa&&fa.g||0)},S)}if(S!=aa)switch(l.color.mode){case "h":aa.val("y",360-(O.val("h")||0),S);break;case "s":fa=O.val("s");aa.val("y",100-(fa!=null?fa:100),S);break;case "v":fa=O.val("v");aa.val("y",100-(fa!=null?fa:100),S);break;case "r":aa.val("y",255-(O.val("r")||0),S);break;case "g":aa.val("y",255-(O.val("g")||0),S);break;case "b":aa.val("y",
255-(O.val("b")||0),S);break;case "a":fa=O.val("a");aa.val("y",255-(fa!=null?fa:255),S)}},kb=function(O){try{var S=O.val("all");oa.css({backgroundColor:S&&"#"+S.hex||"transparent"});ya.call(k,oa,S&&Math.precision(S.a*100/255,4)||0)}catch(fa){}},vb=function(O){switch(l.color.mode){case "h":Ta.call(k,m,(new b({h:O.val("h")||0,s:100,v:100})).val("hex"));break;case "s":case "a":var S=O.val("s");ya.call(k,H,100-(S!=null?S:100));break;case "v":S=O.val("v");ya.call(k,I,S!=null?S:100);break;case "r":ya.call(k,
H,Math.precision((O.val("r")||0)/255*100,4));break;case "g":ya.call(k,H,Math.precision((O.val("g")||0)/255*100,4));break;case "b":ya.call(k,H,Math.precision((O.val("b")||0)/255*100))}O=O.val("a");ya.call(k,G,Math.precision((255-(O||0))*100/255,4))},cb=function(O){switch(l.color.mode){case "h":var S=O.val("a");ya.call(k,ja,Math.precision((255-(S||0))*100/255,4));break;case "s":S=O.val("hva");var fa=new b({h:S&&S.h||0,s:100,v:S!=null?S.v:100});Ta.call(k,C,fa.val("hex"));ya.call(k,Q,100-(S!=null?S.v:
100));ya.call(k,ja,Math.precision((255-(S&&S.a||0))*100/255,4));break;case "v":S=O.val("hsa");fa=new b({h:S&&S.h||0,s:S!=null?S.s:100,v:100});Ta.call(k,C,fa.val("hex"));ya.call(k,ja,Math.precision((255-(S&&S.a||0))*100/255,4));break;case "r":case "g":case "b":fa=S=0;O=O.val("rgba");if(l.color.mode=="r"){S=O&&O.b||0;fa=O&&O.g||0}else if(l.color.mode=="g"){S=O&&O.b||0;fa=O&&O.r||0}else if(l.color.mode=="b"){S=O&&O.r||0;fa=O&&O.g||0}var Ga=fa>S?S:fa;ya.call(k,Q,S>fa?Math.precision((S-fa)/(255-fa)*100,
4):0);ya.call(k,N,fa>S?Math.precision((fa-S)/(255-S)*100,4):0);ya.call(k,ba,Math.precision(Ga/255*100,4));ya.call(k,ja,Math.precision((255-(O&&O.a||0))*100/255,4));break;case "a":S=O.val("a");Ta.call(k,C,O.val("hex")||"000000");ya.call(k,ja,S!=null?0:100);ya.call(k,V,S!=null?100:0)}},Ta=function(O,S){O.css({backgroundColor:S&&S.length==6&&"#"+S||"transparent"})},Va=function(O,S){if(o&&(S.indexOf("AlphaBar.png")!=-1||S.indexOf("Bars.png")!=-1||S.indexOf("Maps.png")!=-1)){O.attr("pngSrc",S);O.css({backgroundImage:"none",
filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+S+"', sizingMethod='scale')"})}else O.css({backgroundImage:"url('"+S+"')"})},Ia=function(O,S){O.css({top:S+"px"})},ya=function(O,S){O.css({visibility:S>0?"visible":"hidden"});if(S>0&&S<100)if(o){var fa=O.attr("pngSrc");fa!=null&&(fa.indexOf("AlphaBar.png")!=-1||fa.indexOf("Bars.png")!=-1||fa.indexOf("Maps.png")!=-1)?O.css({filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+fa+"', sizingMethod='scale') progid:DXImageTransform.Microsoft.Alpha(opacity="+
S+")"}):O.css({opacity:Math.precision(S/100,4)})}else O.css({opacity:Math.precision(S/100,4)});else if(S==0||S==100)if(o){fa=O.attr("pngSrc");fa!=null&&(fa.indexOf("AlphaBar.png")!=-1||fa.indexOf("Bars.png")!=-1||fa.indexOf("Maps.png")!=-1)?O.css({filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+fa+"', sizingMethod='scale')"}):O.css({opacity:""})}else O.css({opacity:""})},$a=function(){ma.active.val("ahex",ma.current.val("ahex"))},La=function(){ma.current.val("ahex",ma.active.val("ahex"))},
Sa=function(O){a(this).parents("tbody:first").find('input:radio[value!="'+O.target.value+'"]').removeAttr("checked");Ka.call(k,O.target.value)},Ja=function(){$a.call(k)},db=function(){$a.call(k);l.window.expandable&&fb.call(k);a.isFunction(ob)&&ob.call(k,ma.active,ia)},lb=function(){La.call(k);l.window.expandable&&fb.call(k);a.isFunction(ib)&&ib.call(k,ma.active,na)},Ua=function(){pb.call(k)},Xa=function(O){var S=O.val("hex");pa.css({backgroundColor:S&&"#"+S||"transparent"});ya.call(k,pa,Math.precision((O.val("a")||
0)*100/255,4))},wb=function(O){var S=O.val("hex");O=O.val("va");wa.css({backgroundColor:S&&"#"+S||"transparent"});ya.call(k,ra,Math.precision((255-(O&&O.a||0))*100/255,4));if(l.window.bindToInput&&l.window.updateInputColor)l.window.input.css({backgroundColor:S&&"#"+S||"transparent",color:O==null||O.v>75?"#000000":"#ffffff"})},va=function(O){ka=parseInt(n.css("left"));ea=parseInt(n.css("top"));U=O.pageX;Y=O.pageY;a(document).bind("mousemove",hb).bind("mouseup",eb);O.preventDefault()},hb=function(O){n.css({left:ka-
(U-O.pageX)+"px",top:ea-(Y-O.pageY)+"px"});l.window.expandable&&!a.support.boxModel&&n.prev().css({left:n.css("left"),top:n.css("top")});O.stopPropagation();O.preventDefault();return false},eb=function(O){a(document).unbind("mousemove",hb).unbind("mouseup",eb);O.stopPropagation();O.preventDefault();return false},sb=function(O){O.preventDefault();O.stopPropagation();ma.active.val("ahex",a(this).attr("title")||null,O.target);return false},ib=a.isFunction(h[1])&&h[1]||null,ab=a.isFunction(h[2])&&h[2]||
null,ob=a.isFunction(h[3])&&h[3]||null,pb=function(){ma.current.val("ahex",ma.active.val("ahex"));var O=function(){if(!(!l.window.expandable||a.support.boxModel)){var S=n.find("table:first");n.before("<iframe/>");n.prev().css({width:S.width(),height:n.height(),opacity:0,position:"absolute",left:n.css("left"),top:n.css("top")})}};if(l.window.expandable){a(document.body).children("div.jPicker.Container").css({zIndex:10});n.css({zIndex:20})}switch(l.window.effects.type){case "fade":n.fadeIn(l.window.effects.speed.show,
O);break;case "slide":n.slideDown(l.window.effects.speed.show,O);break;default:n.show(l.window.effects.speed.show,O)}},fb=function(){var O=function(){l.window.expandable&&n.css({zIndex:10});!l.window.expandable||a.support.boxModel||n.prev().remove()};switch(l.window.effects.type){case "fade":n.fadeOut(l.window.effects.speed.hide,O);break;case "slide":n.slideUp(l.window.effects.speed.hide,O);break;default:n.hide(l.window.effects.speed.hide,O)}},tb=function(){var O=l.window,S=O.expandable?a(k).next().find(".Container:first"):
null;n=O.expandable?a("<div/>"):a(k);n.addClass("jPicker Container");O.expandable&&n.hide();n.get(0).onselectstart=function(Ca){if(Ca.target.nodeName.toLowerCase()!=="input")return false};var fa=ma.active.val("all");if(O.alphaPrecision<0)O.alphaPrecision=0;else if(O.alphaPrecision>2)O.alphaPrecision=2;var Ga='<table class="jPicker" cellpadding="0" cellspacing="0"><tbody>'+(O.expandable?'<tr><td class="Move" colspan="5">&nbsp;</td></tr>':"")+'<tr><td rowspan="9"><h2 class="Title">'+(O.title||ca.text.title)+
'</h2><div class="Map"><span class="Map1">&nbsp;</span><span class="Map2">&nbsp;</span><span class="Map3">&nbsp;</span><img src="'+la.clientPath+la.colorMap.arrow.file+'" class="Arrow"/></div></td><td rowspan="9"><div class="Bar"><span class="Map1">&nbsp;</span><span class="Map2">&nbsp;</span><span class="Map3">&nbsp;</span><span class="Map4">&nbsp;</span><span class="Map5">&nbsp;</span><span class="Map6">&nbsp;</span><img src="'+la.clientPath+la.colorBar.arrow.file+'" class="Arrow"/></div></td><td colspan="2" class="Preview"><div class="prev_div">'+
ca.text.newColor+'<div class="color_preview"><span class="Active" title="'+ca.tooltips.colors.newColor+'">&nbsp;</span><span class="Current" title="'+ca.tooltips.colors.currentColor+'">&nbsp;</span></div></div>'+ca.text.currentColor+'</td><td rowspan="9" class="Button"><input type="button" class="Ok" value="'+ca.text.ok+'" title="'+ca.tooltips.buttons.ok+'"/><input type="button" class="Cancel" value="'+ca.text.cancel+'" title="'+ca.tooltips.buttons.cancel+'"/><div class="Grid">&nbsp;</div></td></tr><tr class="Hue"><td class="Radio"><label title="'+
ca.tooltips.hue.radio+'"><input type="radio" value="h"'+(l.color.mode=="h"?' checked="checked"':"")+'/>H:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(fa!=null?fa.h:"")+'" title="'+ca.tooltips.hue.textbox+'"/>&nbsp;\u00ba</td></tr><tr class="Saturation"><td class="Radio"><label title="'+ca.tooltips.saturation.radio+'"><input type="radio" value="s"'+(l.color.mode=="s"?' checked="checked"':"")+'/>S:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(fa!=
null?fa.s:"")+'" title="'+ca.tooltips.saturation.textbox+'"/>&nbsp;%</td></tr><tr class="Value"><td class="Radio"><label title="'+ca.tooltips.value.radio+'"><input type="radio" value="v"'+(l.color.mode=="v"?' checked="checked"':"")+'/>V:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(fa!=null?fa.v:"")+'" title="'+ca.tooltips.value.textbox+'"/>&nbsp;%<br/><br/></td></tr><tr class="Red"><td class="Radio"><label title="'+ca.tooltips.red.radio+'"><input type="radio" value="r"'+
(l.color.mode=="r"?' checked="checked"':"")+'/>R:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(fa!=null?fa.r:"")+'" title="'+ca.tooltips.red.textbox+'"/></td></tr><tr class="Green"><td class="Radio"><label title="'+ca.tooltips.green.radio+'"><input type="radio" value="g"'+(l.color.mode=="g"?' checked="checked"':"")+'/>G:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(fa!=null?fa.g:"")+'" title="'+ca.tooltips.green.textbox+'"/></td></tr><tr class="Blue"><td class="Radio"><label title="'+
ca.tooltips.blue.radio+'"><input type="radio" value="b"'+(l.color.mode=="b"?' checked="checked"':"")+'/>B:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(fa!=null?fa.b:"")+'" title="'+ca.tooltips.blue.textbox+'"/></td></tr><tr class="Alpha"><td class="Radio">'+(O.alphaSupport?'<label title="'+ca.tooltips.alpha.radio+'"><input type="radio" value="a"'+(l.color.mode=="a"?' checked="checked"':"")+"/>A:</label>":"&nbsp;")+'</td><td class="Text">'+(O.alphaSupport?'<input type="text" maxlength="'+
(3+O.alphaPrecision)+'" value="'+(fa!=null?Math.precision(fa.a*100/255,O.alphaPrecision):"")+'" title="'+ca.tooltips.alpha.textbox+'"/>&nbsp;%':"&nbsp;")+'</td></tr><tr class="Hex"><td colspan="2" class="Text"><label title="'+ca.tooltips.hex.textbox+'">#:<input type="text" maxlength="6" class="Hex" value="'+(fa!=null?fa.hex:"")+'"/></label>'+(O.alphaSupport?'<input type="text" maxlength="2" class="AHex" value="'+(fa!=null?fa.ahex.substring(6):"")+'" title="'+ca.tooltips.hex.alpha+'"/></td>':"&nbsp;")+
"</tr></tbody></table>";if(O.expandable){n.html(Ga);a(document.body).children("div.jPicker.Container").length==0?a(document.body).prepend(n):a(document.body).children("div.jPicker.Container:last").after(n);n.mousedown(function(){a(document.body).children("div.jPicker.Container").css({zIndex:10});n.css({zIndex:20})});n.css({left:O.position.x=="left"?S.offset().left-530-(O.position.y=="center"?25:0)+"px":O.position.x=="center"?S.offset().left-260+"px":O.position.x=="right"?S.offset().left-10+(O.position.y==
"center"?25:0)+"px":O.position.x=="screenCenter"?(a(document).width()>>1)-260+"px":S.offset().left+parseInt(O.position.x)+"px",position:"absolute",top:O.position.y=="top"?S.offset().top-312+"px":O.position.y=="center"?S.offset().top-156+"px":O.position.y=="bottom"?S.offset().top+25+"px":S.offset().top+parseInt(O.position.y)+"px"})}else{n=a(k);n.html(Ga)}Ga=n.find("tbody:first");m=Ga.find("div.Map:first");C=Ga.find("div.Bar:first");var Oa=m.find("span"),Wa=C.find("span");I=Oa.filter(".Map1:first");
H=Oa.filter(".Map2:first");G=Oa.filter(".Map3:first");P=Wa.filter(".Map1:first");Q=Wa.filter(".Map2:first");N=Wa.filter(".Map3:first");ba=Wa.filter(".Map4:first");ja=Wa.filter(".Map5:first");V=Wa.filter(".Map6:first");T=new f(m,{map:{width:la.colorMap.width,height:la.colorMap.height},arrow:{image:la.clientPath+la.colorMap.arrow.file,width:la.colorMap.arrow.width,height:la.colorMap.arrow.height}});T.bind(xa);aa=new f(C,{map:{width:la.colorBar.width,height:la.colorBar.height},arrow:{image:la.clientPath+
la.colorBar.arrow.file,width:la.colorBar.arrow.width,height:la.colorBar.arrow.height}});aa.bind(ua);sa=new e(Ga,ma.active,O.expandable&&O.bindToInput?O.input:null,O.alphaPrecision);Oa=fa!=null?fa.hex:null;var Za=Ga.find(".Preview");Wa=Ga.find(".Button");oa=Za.find(".Active:first").css({backgroundColor:Oa&&"#"+Oa||"transparent"});pa=Za.find(".Current:first").css({backgroundColor:Oa&&"#"+Oa||"transparent"}).bind("click",Ja);ya.call(k,pa,Math.precision(ma.current.val("a")*100)/255,4);na=Wa.find(".Ok:first").bind("click touchstart",
lb);ia=Wa.find(".Cancel:first").bind("click touchstart",db);ta=Wa.find(".Grid:first");setTimeout(function(){Va.call(k,I,la.clientPath+"Maps.png");Va.call(k,H,la.clientPath+"Maps.png");Va.call(k,G,la.clientPath+"map-opacity.png");Va.call(k,P,la.clientPath+"Bars.png");Va.call(k,Q,la.clientPath+"Bars.png");Va.call(k,N,la.clientPath+"Bars.png");Va.call(k,ba,la.clientPath+"Bars.png");Va.call(k,ja,la.clientPath+"bar-opacity.png");Va.call(k,V,la.clientPath+"AlphaBar.png");Va.call(k,Za.find("div:last"),la.clientPath+
"preview-opacity.png")},0);Ga.find("td.Radio input").bind("click  touchstart",Sa);if(ma.quickList&&ma.quickList.length>0){Wa="";for(i=0;i<ma.quickList.length;i++){if((typeof ma.quickList[i]).toString().toLowerCase()=="string")ma.quickList[i]=new b({hex:ma.quickList[i]});var nb=ma.quickList[i].val("a"),Ra=ma.quickList[i].val("ahex");if(!O.alphaSupport&&Ra)Ra=Ra.substring(0,6)+"ff";var mb=ma.quickList[i].val("hex");Wa+='<span class="QuickColor"'+(Ra&&' title="#'+Ra+'"'||"")+' style="background-color:'+
(mb&&"#"+mb||"")+";"+(mb?"":"background-image:url("+la.clientPath+"NoColor.png)")+(O.alphaSupport&&nb&&nb<255?";opacity:"+Math.precision(nb/255,4)+";filter:Alpha(opacity="+Math.precision(nb/2.55,4)+")":"")+'">&nbsp;</span>'}Va.call(k,ta,la.clientPath+"bar-opacity.png");ta.html(Wa);ta.find(".QuickColor").click(sb)}Ka.call(k,l.color.mode);ma.active.bind(Aa);a.isFunction(ab)&&ma.active.bind(ab);ma.current.bind(Xa);if(O.expandable){k.icon=S.parents(".Icon:first");wa=k.icon.find(".Color:first").css({backgroundColor:Oa&&
"#"+Oa||"transparent"});ra=k.icon.find(".Alpha:first");Va.call(k,ra,la.clientPath+"bar-opacity.png");ya.call(k,ra,Math.precision((255-(fa!=null?fa.a:0))*100/255,4));Ha=k.icon.find(".Image:first").css({backgroundImage:"url('"+la.clientPath+la.picker.file+"')"}).bind("click",Ua);if(O.bindToInput&&O.updateInputColor)O.input.css({backgroundColor:Oa&&"#"+Oa||"transparent",color:fa==null||fa.v>75?"#000000":"#ffffff"});Da=Ga.find(".Move:first").bind("mousedown",va);ma.active.bind(wb)}else pb.call(k)},la=
l.images,ca=l.localization,ma={active:(typeof l.color.active).toString().toLowerCase()=="string"?new b({ahex:!l.window.alphaSupport&&l.color.active?l.color.active.substring(0,6)+"ff":l.color.active}):new b({ahex:!l.window.alphaSupport&&l.color.active.val("ahex")?l.color.active.val("ahex").substring(0,6)+"ff":l.color.active.val("ahex")}),current:(typeof l.color.active).toString().toLowerCase()=="string"?new b({ahex:!l.window.alphaSupport&&l.color.active?l.color.active.substring(0,6)+"ff":l.color.active}):
new b({ahex:!l.window.alphaSupport&&l.color.active.val("ahex")?l.color.active.val("ahex").substring(0,6)+"ff":l.color.active.val("ahex")}),quickList:l.color.quickList};a.extend(true,k,{commitCallback:ib,liveCallback:ab,cancelCallback:ob,color:ma,show:pb,hide:fb,destroy:function(){n.find("td.Radio input  touchstart").unbind("click",Sa);pa.unbind("click  touchstart",Ja);ia.unbind("click  touchstart",db);na.unbind("click  touchstart",lb);if(l.window.expandable){Ha.unbind("click",Ua);Da.unbind("mousedown",
va);k.icon=null}n.find(".QuickColor").unbind("click",sb);V=ja=ba=N=Q=P=G=H=I=C=m=null;T.destroy();T=null;aa.destroy();aa=null;sa.destroy();ab=ob=ib=ta=ia=na=pa=oa=sa=null;n.html("");for(i=0;i<g.length;i++)g[i]==k&&g.splice(i,1)}});g.push(k);setTimeout(function(){tb.call(k)},0)})};a.fn.jPicker.defaults={window:{title:null,effects:{type:"slide",speed:{show:"slow",hide:"fast"}},position:{x:"screenCenter",y:"top"},expandable:false,liveUpdate:true,alphaSupport:false,alphaPrecision:0,updateInputColor:true},
color:{mode:"h",active:new b({ahex:"#ffcc00ff"}),quickList:[new b({h:360,s:33,v:100}),new b({h:360,s:66,v:100}),new b({h:360,s:100,v:100}),new b({h:360,s:100,v:75}),new b({h:360,s:100,v:50}),new b({h:180,s:0,v:100}),new b({h:30,s:33,v:100}),new b({h:30,s:66,v:100}),new b({h:30,s:100,v:100}),new b({h:30,s:100,v:75}),new b({h:30,s:100,v:50}),new b({h:180,s:0,v:90}),new b({h:60,s:33,v:100}),new b({h:60,s:66,v:100}),new b({h:60,s:100,v:100}),new b({h:60,s:100,v:75}),new b({h:60,s:100,v:50}),new b({h:180,
s:0,v:80}),new b({h:90,s:33,v:100}),new b({h:90,s:66,v:100}),new b({h:90,s:100,v:100}),new b({h:90,s:100,v:75}),new b({h:90,s:100,v:50}),new b({h:180,s:0,v:70}),new b({h:120,s:33,v:100}),new b({h:120,s:66,v:100}),new b({h:120,s:100,v:100}),new b({h:120,s:100,v:75}),new b({h:120,s:100,v:50}),new b({h:180,s:0,v:60}),new b({h:150,s:33,v:100}),new b({h:150,s:66,v:100}),new b({h:150,s:100,v:100}),new b({h:150,s:100,v:75}),new b({h:150,s:100,v:50}),new b({h:180,s:0,v:50}),new b({h:180,s:33,v:100}),new b({h:180,
s:66,v:100}),new b({h:180,s:100,v:100}),new b({h:180,s:100,v:75}),new b({h:180,s:100,v:50}),new b({h:180,s:0,v:40}),new b({h:210,s:33,v:100}),new b({h:210,s:66,v:100}),new b({h:210,s:100,v:100}),new b({h:210,s:100,v:75}),new b({h:210,s:100,v:50}),new b({h:180,s:0,v:30}),new b({h:240,s:33,v:100}),new b({h:240,s:66,v:100}),new b({h:240,s:100,v:100}),new b({h:240,s:100,v:75}),new b({h:240,s:100,v:50}),new b({h:180,s:0,v:20}),new b({h:270,s:33,v:100}),new b({h:270,s:66,v:100}),new b({h:270,s:100,v:100}),
new b({h:270,s:100,v:75}),new b({h:270,s:100,v:50}),new b({h:180,s:0,v:10}),new b({h:300,s:33,v:100}),new b({h:300,s:66,v:100}),new b({h:300,s:100,v:100}),new b({h:300,s:100,v:75}),new b({h:300,s:100,v:50}),new b({h:180,s:0,v:0}),new b({h:330,s:33,v:100}),new b({h:330,s:66,v:100}),new b({h:330,s:100,v:100}),new b({h:330,s:100,v:75}),new b({h:330,s:100,v:50}),new b]},images:{clientPath:"/jPicker/images/",colorMap:{width:256,height:256,arrow:{file:"mappoint.gif",width:15,height:15}},colorBar:{width:20,
height:256,arrow:{file:"rangearrows.gif",width:20,height:7}},picker:{file:"picker.gif",width:25,height:24}},localization:{text:{title:"Drag Markers To Pick A Color",newColor:"new",currentColor:"current",ok:"OK",cancel:"Cancel"},tooltips:{colors:{newColor:"New Color - Press &ldquo;OK&rdquo; To Commit",currentColor:"Click To Revert To Original Color"},buttons:{ok:"Commit To This Color Selection",cancel:"Cancel And Revert To Original Color"},hue:{radio:"Set To &ldquo;Hue&rdquo; Color Mode",textbox:"Enter A &ldquo;Hue&rdquo; Value (0-360&deg;)"},
saturation:{radio:"Set To &ldquo;Saturation&rdquo; Color Mode",textbox:"Enter A &ldquo;Saturation&rdquo; Value (0-100%)"},value:{radio:"Set To &ldquo;Value&rdquo; Color Mode",textbox:"Enter A &ldquo;Value&rdquo; Value (0-100%)"},red:{radio:"Set To &ldquo;Red&rdquo; Color Mode",textbox:"Enter A &ldquo;Red&rdquo; Value (0-255)"},green:{radio:"Set To &ldquo;Green&rdquo; Color Mode",textbox:"Enter A &ldquo;Green&rdquo; Value (0-255)"},blue:{radio:"Set To &ldquo;Blue&rdquo; Color Mode",textbox:"Enter A &ldquo;Blue&rdquo; Value (0-255)"},
alpha:{radio:"Set To &ldquo;Alpha&rdquo; Color Mode",textbox:"Enter A &ldquo;Alpha&rdquo; Value (0-100)"},hex:{textbox:"Enter A &ldquo;Hex&rdquo; Color Value (#000000-#ffffff)",alpha:"Enter A &ldquo;Alpha&rdquo; Value (#00-#ff)"}}}}})(jQuery,"1.1.6");(function(a){function f(g){var d=g||window.event,c=[].slice.call(arguments,1),h=0,k=0,l=0;g=a.event.fix(d);g.type="mousewheel";if(d.wheelDelta)h=d.wheelDelta/120;if(d.detail)h=-d.detail/3;l=h;if(d.axis!==undefined&&d.axis===d.HORIZONTAL_AXIS){l=0;k=-1*h}if(d.wheelDeltaY!==undefined)l=d.wheelDeltaY/120;if(d.wheelDeltaX!==undefined)k=-1*d.wheelDeltaX/120;c.unshift(g,h,k,l);return(a.event.dispatch||a.event.handle).apply(this,c)}var e=["DOMMouseScroll","mousewheel"];if(a.event.fixHooks)for(var b=e.length;b;)a.event.fixHooks[e[--b]]=
a.event.mouseHooks;a.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var g=e.length;g;)this.addEventListener(e[--g],f,false);else this.onmousewheel=f},teardown:function(){if(this.removeEventListener)for(var g=e.length;g;)this.removeEventListener(e[--g],f,false);else this.onmousewheel=null}};a.fn.extend({mousewheel:function(g){return g?this.bind("mousewheel",g):this.trigger("mousewheel")},unmousewheel:function(g){return this.unbind("mousewheel",g)}})})(jQuery);methodDraw.addExtension("eyedropper",function(a){var f=methodDraw.canvas,e=svgedit.history.ChangeElementCommand,b={fillPaint:"red",fillOpacity:1,strokePaint:"black",strokeOpacity:1,strokeWidth:5,strokeDashArray:null,opacity:1,strokeLinecap:"butt",strokeLinejoin:"miter"},g=function(d,c,h){var k=null;if(d.indexOf("url(#")===0){d=(d=f.getRefElem(d))?d.cloneNode(true):$("#"+h+"_color defs *")[0];k={alpha:c};k[d.tagName]=d}else k=d.indexOf("#")===0?{alpha:c,solidColor:d.substr(1)}:{alpha:c,solidColor:"none"};
return new $.jGraduate.Paint(k)};return{name:"eyedropper",svgicons:"extensions/eyedropper-icon.xml",buttons:[{id:"tool_eyedropper",type:"mode",title:"Eye Dropper Tool",position:8,key:"I",icon:"extensions/eyedropper.png",events:{click:function(){f.setMode("eyedropper")}}}],mouseDown:function(d){var c=f.getMode(),h=d.event;h=h.target.id==="svgroot"?document.getElementById("canvas_background"):h.target;if(c=="eyedropper"&&h){b.fillPaint=h.getAttribute("fill")||"white";b.fillOpacity=h.getAttribute("fill-opacity")||
1;b.strokePaint=h.getAttribute("stroke")||"none";b.strokeOpacity=h.getAttribute("stroke-opacity")||1;b.strokeWidth=h.getAttribute("stroke-width");b.strokeDashArray=h.getAttribute("stroke-dasharray");b.strokeLinecap=h.getAttribute("stroke-linecap");b.strokeLinejoin=h.getAttribute("stroke-linejoin");b.opacity=h.getAttribute("opacity")||1;d.selectedElements=d.selectedElements.filter(Boolean);if(d.selectedElements.length){if($.inArray(d.selectedElements.nodeName,["g","use"])==-1){var k={},l=function(n,
m,C){k[m]=n.getAttribute(m);n.setAttribute(m,C)},o=new a.BatchCommand;d.selectedElements.forEach(function(n){b.fillPaint&&l(n,"fill",b.fillPaint);b.fillOpacity&&l(n,"fill-opacity",b.fillOpacity);b.strokePaint&&l(n,"stroke",b.strokePaint);b.strokeOpacity&&l(n,"stroke-opacity",b.strokeOpacity);b.strokeWidth&&l(n,"stroke-width",b.strokeWidth);b.strokeDashArray&&l(n,"stroke-dasharray",b.strokeDashArray);b.opacity&&l(n,"opacity",b.opacity);b.strokeLinecap&&l(n,"stroke-linecap",b.strokeLinecap);b.strokeLinejoin&&
l(n,"stroke-linejoin",b.strokeLinejoin);o.addSubCommand(new e(n,k));k={}});d=g(b.fillPaint,b.fillOpacity*100,"fill");c=g(b.strokePaint,b.strokeOpacity*100,"stroke");methodDraw.paintBox.fill.update(true);methodDraw.paintBox.stroke.update(true);f.undoMgr.addCommandToHistory(o)}}else{d=g(b.fillPaint,b.fillOpacity*100,"fill");c=g(b.strokePaint,b.strokeOpacity*100,"stroke");methodDraw.paintBox.fill.setPaint(d);methodDraw.paintBox.stroke.setPaint(c)}}}}});methodDraw.addExtension("view_grid",function(a){function f(l){h.attr("width");h.attr("height");var o=svgedit.units.getTypeMap()[methodDraw.curConfig.baseUnit],n=[0.01,0.1,1,10,100,1E3];b.getContentElem().getAttribute("x");var m=d;o=o*l;var C=100/o,I=1;for(l=0;l<n.length;l++){var H=n[l];I=H;if(C<=H)break}n=I*o;m.width=n;m.height=n;o=m.getContext("2d");C=n/10;o.globalAlpha=0.2;o.strokeStyle="#000";for(l=1;l<10;l++){I=Math.round(C*l)+0.5;o.moveTo(I,n);o.lineTo(I,0);o.moveTo(n,I);o.lineTo(0,I)}o.stroke();
o.beginPath();o.globalAlpha=0.5;o.moveTo(0.5,n);o.lineTo(0.5,0);o.moveTo(n,0.5);o.lineTo(0,0.5);o.stroke();m=m.toDataURL("image/png");k.setAttribute("width",n);k.setAttribute("height",n);k.parentNode.setAttribute("width",n);k.parentNode.setAttribute("height",n);b.setHref(k,m)}if(!document.getElementById("canvasGrid")){var e=document.getElementById("svgcanvas").ownerDocument,b=methodDraw.canvas,g=false;a=a.assignAttributes;var d=document.createElement("canvas");$(d).hide().appendTo("body");var c=e.createElementNS("http://www.w3.org/2000/svg",
"g");a(c,{id:"canvasGrid",width:"100%",height:"100%",x:0,y:0,overflow:"visible",display:"none"});var h=$("#canvas_background");h.after(c);c=e.createElementNS("http://www.w3.org/2000/svg","pattern");a(c,{id:"gridpattern",patternUnits:"userSpaceOnUse",x:0,y:0,width:100,height:100});var k=e.createElementNS("http://www.w3.org/2000/svg","image");a(k,{x:0,y:0,width:100,height:100});c.appendChild(k);$("#svgroot defs").append(c);e=e.createElementNS("http://www.w3.org/2000/svg","rect");a(e,{width:"100%",height:"100%",
x:0,y:0,"stroke-width":0,stroke:"none",fill:"url(#gridpattern)",style:"pointer-events: none; display:visible;"});$("#canvasGrid").append(e)}return{name:"view_grid",zoomChanged:function(l){g&&f(l)},buttons:[{id:"view_grid",type:"menu",after:"tool_wireframe",panel:"view_menu",title:"View Grid",events:{click:function(){if($("#view_grid").hasClass("push_button_pressed")){methodDraw.curConfig.showGrid=g=false;$("#view_grid").removeClass("push_button_pressed");$("#canvasGrid").attr("display","none")}else{methodDraw.curConfig.showGrid=
g=true;$("#view_grid").addClass("push_button_pressed");$("#canvasGrid").attr("display","inline");f(b.getZoom())}}}}]}});methodDraw.addExtension("shapes",function(){function a(){$("#shape_buttons").empty();$("#shape_buttons").append(C.buttons)}function f(H){var G=m[H];if(G){C=G;G.buttons.length||e(H,G);a()}else{$("#shape_buttons").html("Loading...");$.getJSON("extensions/shapelib/"+H+".json",function(P){C=m[H]={data:P.data,size:P.size,fill:P.fill};e(H,P);a()})}}function e(H,G){var P=C.size||300,Q=C.fill||false,N=P*0.05;N=[-N,-N,P+N*2,P+N*2].join(" ");P=Q?0:P/30;P=(new DOMParser).parseFromString('<svg xmlns="http://www.w3.org/2000/svg"><svg viewBox="'+
N+'"><path fill="#333" stroke="transparent" stroke-width="'+P+'" /></svg></svg>',"text/xml");P.documentElement.setAttribute("width",40);P.documentElement.setAttribute("height",40);P=$(document.importNode(P.documentElement,true));Q=G.data;C.buttons=[];for(var ba in Q){N=Q[ba];var ja=P.clone();ja.find("path").attr("d",N);N=ja.wrap('<div class="tool_button">').parent().attr({id:I+"_"+ba,title:ba});C.buttons.push(N[0])}}var b,g,d=methodDraw.canvas,c,h,k,l=d.getRootElem(),o={},n={basic:"Basic",object:"Objects",
symbol:"Symbols",arrow:"Arrows",flowchart:"Flowchart",nature:"Nature",game:"Cards & Chess",dialog_balloon:"Dialog balloons",music:"Music",weather:"Weather &amp; Time",ui:"User Interface",social:"Social Web"},m={basic:{data:{star_points_5:"m1,116.58409l113.82668,0l35.17332,-108.13487l35.17334,108.13487l113.82666,0l-92.08755,66.83026l35.17514,108.13487l-92.08759,-66.83208l-92.08757,66.83208l35.17515,-108.13487l-92.08758,-66.83026z",donut:"m1,150l0,0c0,-82.29042 66.70958,-149 149,-149l0,0c39.51724,0 77.41599,15.69816 105.35889,43.64108c27.94293,27.94293 43.64111,65.84165 43.64111,105.35892l0,0c0,82.29041 -66.70958,149 -149,149l0,0c-82.29041,0 -149,-66.70959 -149,-149zm74.5,0l0,0c0,41.1452 33.35481,74.5 74.5,74.5c41.14522,0 74.5,-33.3548 74.5,-74.5c0,-41.1452 -33.3548,-74.5 -74.5,-74.5l0,0c-41.14519,0 -74.5,33.35481 -74.5,74.5z",
triangle:"m1,280.375l149,-260.75l149,260.75z",right_triangle:"m1,299l0,-298l298,298z",diamond:"m1,150l149,-149l149,149l-149,149l-149,-149z",pentagon:"m1.00035,116.97758l148.99963,-108.4053l148.99998,108.4053l-56.91267,175.4042l-184.1741,0l-56.91284,-175.4042z",hexagon:"m1,149.99944l63.85715,-127.71428l170.28572,0l63.85713,127.71428l-63.85713,127.71428l-170.28572,0l-63.85715,-127.71428z",septagon1:"m0.99917,191.06511l29.51249,-127.7108l119.48833,-56.83673l119.48836,56.83673l29.51303,127.7108l-82.69087,102.41679l-132.62103,0l-82.69031,-102.41679z",
heptagon:"m1,88.28171l87.28172,-87.28171l123.43653,0l87.28172,87.28171l0,123.43654l-87.28172,87.28172l-123.43653,0l-87.28172,-87.28172l0,-123.43654z",decagon:"m1,150.00093l28.45646,-88.40318l74.49956,-54.63682l92.08794,0l74.50002,54.63682l28.45599,88.40318l-28.45599,88.40318l-74.50002,54.63681l-92.08794,0l-74.49956,-54.63681l-28.45646,-88.40318z",dodecagon:"m1,110.07421l39.92579,-69.14842l69.14842,-39.92579l79.85159,0l69.14842,39.92579l39.92578,69.14842l0,79.85159l-39.92578,69.14842l-69.14842,39.92578l-79.85159,0l-69.14842,-39.92578l-39.92579,-69.14842l0,-79.85159z",
trapezoid:"m1,299l55.875,-298l186.25001,0l55.87498,298z",dialog_balloon_1:"m0.99786,35.96579l0,0c0,-19.31077 15.28761,-34.96524 34.14583,-34.96524l15.52084,0l0,0l74.50001,0l139.68748,0c9.05606,0 17.74118,3.68382 24.14478,10.24108c6.40356,6.55726 10.00107,15.45081 10.00107,24.72416l0,87.41311l0,0l0,52.44785l0,0c0,19.31078 -15.2876,34.96524 -34.14584,34.96524l-139.68748,0l-97.32507,88.90848l22.82506,-88.90848l-15.52084,0c-18.85822,0 -34.14583,-15.65446 -34.14583,-34.96524l0,0l0,-52.44785l0,0z",heart:"m150,73c61,-175 300,0 0,225c-300,-225 -61,-400 0,-225z",
cylinder:"m299.0007,83.77844c0,18.28676 -66.70958,33.11111 -149.00002,33.11111m149.00002,-33.11111l0,0c0,18.28676 -66.70958,33.11111 -149.00002,33.11111c-82.29041,0 -148.99997,-14.82432 -148.99997,-33.11111m0,0l0,0c0,-18.28674 66.70956,-33.1111 148.99997,-33.1111c82.29044,0 149.00002,14.82436 149.00002,33.1111l0,132.44449c0,18.28674 -66.70958,33.11105 -149.00002,33.11105c-82.29041,0 -148.99997,-14.82431 -148.99997,-33.11105z",arrow_up:"m1.49805,149.64304l148.50121,-148.00241l148.50121,148.00241l-74.25061,0l0,148.71457l-148.5012,0l0,-148.71457z",
arrow_u_turn:"m1.00059,299.00055l0,-167.62497l0,0c0,-72.00411 58.37087,-130.37499 130.375,-130.37499l0,0l0,0c34.57759,0 67.73898,13.7359 92.18906,38.18595c24.45006,24.45005 38.18593,57.61144 38.18593,92.18904l0,18.625l37.24997,0l-74.49995,74.50002l-74.50002,-74.50002l37.25,0l0,-18.625c0,-30.8589 -25.0161,-55.87498 -55.87498,-55.87498l0,0l0,0c-30.85892,0 -55.875,25.01608 -55.875,55.87498l0,167.62497z",arrow_left_up:"m0.99865,224.5l74.50004,-74.5l0,37.25l111.74991,0l0,-111.75l-37.25,0l74.5,-74.5l74.5,74.5l-37.25,0l0,186.25l-186.24989,0l0,37.25l-74.50005,-74.5z",
plaque:"m-0.00197,49.94376l0,0c27.5829,0 49.94327,-22.36036 49.94327,-49.94327l199.76709,0l0,0c0,27.5829 22.36037,49.94327 49.94325,49.94327l0,199.7671l0,0c-27.58289,0 -49.94325,22.36034 -49.94325,49.94325l-199.76709,0c0,-27.58292 -22.36037,-49.94325 -49.94327,-49.94325z",page:"m249.3298,298.99744l9.9335,-39.73413l39.73413,-9.93355l-49.66763,49.66768l-248.33237,0l0,-298.00001l298.00001,0l0,248.33234",cross:"m0.99844,99.71339l98.71494,0l0,-98.71495l101.26279,0l0,98.71495l98.71495,0l0,101.2628l-98.71495,0l0,98.71494l-101.26279,0l0,-98.71494l-98.71494,0z",
divide:"m150,0.99785l0,0c25.17819,0 45.58916,20.41097 45.58916,45.58916c0,25.17821 -20.41096,45.58916 -45.58916,45.58916c-25.17822,0 -45.58916,-20.41093 -45.58916,-45.58916c0,-25.1782 20.41093,-45.58916 45.58916,-45.58916zm0,296.25203c-25.17822,0 -45.58916,-20.41095 -45.58916,-45.58917c0,-25.17819 20.41093,-45.58916 45.58916,-45.58916c25.17819,0 45.58916,20.41096 45.58916,45.58916c0,25.17822 -20.41096,45.58917 -45.58916,45.58917zm-134.06754,-193.71518l268.13507,0l0,91.17833l-268.13507,0z",minus:"m0.99887,102.39503l297.49445,0l0,95.2112l-297.49445,0z",
times:"m1.00089,73.36786l72.36697,-72.36697l76.87431,76.87368l76.87431,-76.87368l72.36765,72.36697l-76.87433,76.87431l76.87433,76.87431l-72.36765,72.36765l-76.87431,-76.87433l-76.87431,76.87433l-72.36697,-72.36765l76.87368,-76.87431l-76.87368,-76.87431z"},buttons:[]}},C=m.basic,I="shapelib";return{svgicons:"extensions/ext-shapes.xml",buttons:[{id:"tool_shapelib",type:"mode_flyout",position:6,title:"Shape library",icon:"extensions/ext-shapes.png",events:{click:function(){d.setMode(I)}}}],callback:function(){var H=
$('<div id="shape_buttons">');$("#tools_shapelib > *").wrapAll(H);var G=$("#tools_shapelib_show");f("basic");$("#shape_buttons").mouseup(function(Q){Q=$(Q.target).closest("div.tool_button");if(Q.length){var N=Q.children().clone().attr({width:24,height:24});G.children(":not(.flyout_arrow_horiz)").remove();G.append(N).attr("data-curopt","#"+Q[0].id).mouseup();d.setMode(I);g=Q[0].id.substr((I+"_").length);b=C.data[g];$(".tools_flyout").fadeOut()}});H=$('<div id="shape_cats">');var P="";$.each(n,function(Q,
N){P+="<div data-cat="+Q+">"+N+"</div>"});H.html(P).children().bind("mouseup",function(){var Q=$(this);Q.siblings().removeClass("current");Q.addClass("current");f(Q.attr("data-cat"));return false});H.children().eq(0).addClass("current");$("#tools_shapelib").prepend(H);G.mouseup(function(){d.setMode(b?I:"select")});$("#tool_shapelib").remove();H=$("#tools_shapelib").height();$("#tools_shapelib").css({"margin-top":-(H/2),"margin-left":3})},mouseDown:function(H){if(d.getMode()===I){var G=h=H.start_x;
H=k=H.start_y;var P=d.getStyle();c=d.addSvgElementFromJson({element:"path",curStyles:true,attr:{d:b,id:d.getNextId(),opacity:P.opacity/2,style:"pointer-events:none"}});c.setAttribute("d",b);if(/[a-z]/.test(b)){b=C.data[g]=d.pathActions.convertPath(c);c.setAttribute("d",b);d.pathActions.fixEnd(c)}c.setAttribute("transform","translate("+G+","+H+") scale(0.005) translate("+-G+","+-H+")");d.recalculateDimensions(c);d.getTransformList(c);o=c.getBBox();totalScale={sx:1,sy:1};return{started:true}}},mouseMove:function(H){if(d.getMode()===
I){var G=d.getZoom(),P=H.event,Q=H.mouse_x/G,N=H.mouse_y/G;H=d.getTransformList(c);var ba=c.getBBox();G=ba.x;var ja=ba.y,V=ba.width,T=ba.height,aa=Q-h,sa=N-k,ka={x:Math.min(h,Q),y:Math.min(k,N),width:Math.abs(Q-h),height:Math.abs(N-k)},ea=ba=0;T=T?(T+sa)/T:1;V=V?(V+aa)/V:1;V=ka.width/o.width;T=ka.height/o.height;V=V||1;T=T||1;if(Q<h)ba=o.width;if(N<k)ea=o.height;Q=l.createSVGTransform();N=l.createSVGTransform();ka=l.createSVGTransform();Q.setTranslate(-(G+ba),-(ja+ea));if(P.shiftKey){replaced=true;
P=Math.min(Math.abs(V),Math.abs(T));V=P*(V<0?-1:1);T=P*(T<0?-1:1);if(totalScale.sx!=totalScale.sy){P=totalScale.sx>totalScale.sy?1:totalScale.sx/totalScale.sy;V*=totalScale.sy>totalScale.sx?1:totalScale.sy/totalScale.sx;T*=P}}totalScale.sx*=V;totalScale.sy*=T;N.setScale(V,T);ka.setTranslate(G+ba,ja+ea);H.appendItem(ka);H.appendItem(N);H.appendItem(Q);d.recalculateDimensions(c);o=c.getBBox()}},mouseUp:function(H){if(d.getMode()===I){if(H.mouse_x==h&&H.mouse_y==k)return{keep:false,element:c,started:false};
d.setMode("select");return{keep:true,element:c,started:false}}}}});(function(){for(var a=0,f=["ms","moz","webkit","o"],e=0;e<f.length&&!window.requestAnimationFrame;++e){window.requestAnimationFrame=window[f[e]+"RequestAnimationFrame"];window.cancelAnimationFrame=window[f[e]+"CancelAnimationFrame"]||window[f[e]+"CancelRequestAnimationFrame"]}if(!window.requestAnimationFrame)window.requestAnimationFrame=function(b){var g=(new Date).getTime(),d=Math.max(0,16-(g-a)),c=window.setTimeout(function(){b(g+d)},d);a=g+d;return c};if(!window.cancelAnimationFrame)window.cancelAnimationFrame=
function(b){clearTimeout(b)}})();(function(a){function f(m){var C=m.originalEvent;if(!C.touches||C.targetTouches.length===1&&C.touches.length===1){c.call(this,m);m=a(this);m.bind(o,e);m.bind(l,b)}else{clearTimeout(n);d.call(this)}}function e(m){if(n!=null){var C=m.originalEvent;m=C.changedTouches?C.changedTouches[0].pageX:C.pageX;C=C.changedTouches?C.changedTouches[0].pageY:C.pageY;var I=a(this).data("taphold.point");m=m-I.x;C=C-I.y;if(Math.sqrt(m*m+C*C)>k){clearTimeout(n);d.call(this)}}}function b(){clearTimeout(n);d.call(this)}
function g(m){d.call(this);a(this).data("taphold.handler").call(this,m)}function d(){n=null;a(this).unbind(o,e);a(this).unbind(l,b)}function c(m){if(n==null){var C=this;n=setTimeout(function(){g.call(C,m)},h);var I=m.originalEvent,H={};H.x=I.changedTouches?I.changedTouches[0].pageX:I.pageX;H.y=I.changedTouches?I.changedTouches[0].pageY:I.pageY;a(this).data("taphold.point",H)}}var h=1E3,k=5,l="touchend",o="touchmove",n=null;a.event.special.taphold={setup:function(){},add:function(m){a(this).data("taphold.handler",
m.handler);m.data?a(this).bind("touchstart",m.data,f):a(this).bind("touchstart",f)},remove:function(m){clearTimeout(n);d.call(this);m.data?a(this).unbind("touchstart",m.data,f):a(this).unbind("touchstart",f)},teardown:function(){}}})(jQuery);
